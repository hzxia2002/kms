(function($){Function.prototype.juiceExtend=function(parent,overrides){if(typeof parent!="function"){return this}this.base=parent.prototype;this.base.constructor=parent;var f=function(){};f.prototype=parent.prototype;this.prototype=new f();this.prototype.constructor=this;if(overrides){$.extend(this.prototype,overrides)}};Function.prototype.juiceDefer=function(o,defer,args){var fn=this;return setTimeout(function(){fn.apply(o,args||[])},defer)};window.juice=$.jui={version:"V1.0.0",managerCount:0,managers:{},managerIdPrev:"jui",error:{managerIsExist:"管理器id已经存在"},getId:function(prev){prev=prev||this.managerIdPrev;var id=prev+(1000+this.managerCount);this.managerCount++;return id},add:function(manager){if(arguments.length==2){var m=arguments[1];m.id=m.id||m.options.id||arguments[0].id;this.addManager(m);return}if(!manager.id){manager.id=this.getId(manager.__idPrev())}if(this.managers[manager.id]){throw new Error(this.error.managerIsExist)}this.managers[manager.id]=manager},remove:function(arg){if(typeof arg=="string"||typeof arg=="number"){delete $.jui.managers[arg]}else{if(typeof arg=="object"&&arg instanceof $.jui.core.Component){delete $.jui.managers[arg.id]}}},get:function(arg,idAttrName){idAttrName=idAttrName||"juiid";if(typeof arg=="string"||typeof arg=="number"){return $.jui.managers[arg]}else{if(typeof arg=="object"&&arg.length){if(!arg[0][idAttrName]&&!$(arg[0]).attr(idAttrName)){return null}return $.jui.managers[arg[0][idAttrName]||$(arg[0]).attr(idAttrName)]}}return null},find:function(type){var arr=[];for(var id in this.managers){var manager=this.managers[id];if(type instanceof Function){if(manager instanceof type){arr.push(manager)}}else{if(type instanceof Array){if($.inArray(manager.__getType(),type)!=-1){arr.push(manager)}}else{if(manager.__getType()==type){arr.push(manager)}}}}return arr},run:function(plugin,args,ext){if(!plugin){return}ext=$.extend({defaultsNamespace:"juiceDefaults",methodsNamespace:"juiceMethods",controlNamespace:"controls",idAttrName:"juiid",isStatic:false,hasElement:true,propertyToElemnt:null},ext||{});plugin=plugin.replace(/^juiceGet/,"");plugin=plugin.replace(/^juice/,"");if(this==null||this==window||ext.isStatic){if(!$.jui.plugins[plugin]){$.jui.plugins[plugin]={fn:$["juice"+plugin],isStatic:true}}return new $.jui[ext.controlNamespace][plugin]($.extend({},$[ext.defaultsNamespace][plugin]||{},$[ext.defaultsNamespace][plugin+"String"]||{},args.length>0?args[0]:{}))}if(!$.jui.plugins[plugin]){$.jui.plugins[plugin]={fn:$.fn["juice"+plugin],isStatic:false}}if(/Manager$/.test(plugin)){return $.jui.get(this,ext.idAttrName)}this.each(function(){if(this[ext.idAttrName]||$(this).attr(ext.idAttrName)){var manager=$.jui.get(this[ext.idAttrName]||$(this).attr(ext.idAttrName));if(manager&&args.length>0){manager.set(args[0])}return}if(args.length>=1&&typeof args[0]=="string"){return}var options=args.length>0?args[0]:null;var p=$.extend({},$[ext.defaultsNamespace][plugin]||{},$[ext.defaultsNamespace][plugin+"String"]||{},options||{});if(ext.propertyToElemnt){p[ext.propertyToElemnt]=this}if(ext.hasElement){new $.jui[ext.controlNamespace][plugin](this,p)}else{new $.jui[ext.controlNamespace][plugin](p)}});if(this.length==0){return null}if(args.length==0){return $.jui.get(this,ext.idAttrName)}if(typeof args[0]=="object"){return $.jui.get(this,ext.idAttrName)}if(typeof args[0]=="string"){var manager=$.jui.get(this,ext.idAttrName);if(manager==null){return}if(args[0]=="option"){if(args.length==2){return manager.get(args[1])}else{if(args.length>=3){return manager.set(args[1],args[2])}}}else{var method=args[0];if(!manager[method]){return}var parms=Array.apply(null,args);parms.shift();return manager[method].apply(manager,parms)}}return null},defaults:{},methods:{},core:{},controls:{},plugins:{}};$.juiceDefaults={};$.juiceMethos={};$.jui.defaults=$.juiceDefaults;$.jui.methods=$.juiceMethos;$.fn.juice=function(plugin){if(plugin){return $.jui.run.call(this,plugin,arguments)}else{return $.jui.get(this)}};$.jui.core.Component=function(options){this.events=this.events||{};this.options=options||{};this.children={}};$.extend($.jui.core.Component.prototype,{__getType:function(){return"$.jui.core.Component"},__idPrev:function(){return"jui"},set:function(arg,value){if(!arg){return}if(typeof arg=="object"){var tmp;if(this.options!=arg){$.extend(this.options,arg);tmp=arg}else{tmp=$.extend({},arg)}if(value==undefined||value==true){for(var p in tmp){if(p.indexOf("on")==0){this.set(p,tmp[p])}}}if(value==undefined||value==false){for(var p in tmp){if(p.indexOf("on")!=0){this.set(p,tmp[p])}}}return}var name=arg;if(name.indexOf("on")==0){if(typeof value=="function"){this.bind(name.substr(2),value)}return}this.trigger("propertychange",arg,value);if(!this.options){this.options={}}this.options[name]=value;var pn="_set"+name.substr(0,1).toUpperCase()+name.substr(1);if(this[pn]){this[pn].call(this,value)}this.trigger("propertychanged",arg,value)},get:function(name){var pn="_get"+name.substr(0,1).toUpperCase()+name.substr(1);if(this[pn]){return this[pn].call(this,name)}return this.options[name]},hasBind:function(arg){var name=arg.toLowerCase();var event=this.events[name];if(event&&event.length){return true}return false},trigger:function(arg,data){var name=arg.toLowerCase();var event=this.events[name];if(!event){return}data=data||[];if((data instanceof Array)==false){data=[data]}for(var i=0;i<event.length;i++){var ev=event[i];if(ev.handler.apply(ev.context,data)==false){return false}}},bind:function(arg,handler,context){if(typeof arg=="object"){for(var p in arg){this.bind(p,arg[p])}return}if(typeof handler!="function"){return false}var name=arg.toLowerCase();var event=this.events[name]||[];context=context||this;event.push({handler:handler,context:context});this.events[name]=event},unbind:function(arg,handler){if(!arg){this.events={};return}var name=arg.toLowerCase();var event=this.events[name];if(!event||!event.length){return}if(!handler){delete this.events[name]}else{for(var i=0,l=event.length;i<l;i++){if(event[i].handler==handler){event.splice(i,1);break}}}},destroy:function(){$.jui.remove(this)}});$.jui.core.UIComponent=function(element,options){$.jui.core.UIComponent.base.constructor.call(this,options);var extendMethods=this._extendMethods();if(extendMethods){$.extend(this,extendMethods)}this.element=element;this._init();this._preRender();this.trigger("render");this._render();this.trigger("rendered");this._rendered()};$.jui.core.UIComponent.juiceExtend($.jui.core.Component,{__getType:function(){return"$.jui.core.UIComponent"},_extendMethods:function(){},_init:function(){this.type=this.__getType();if(!this.element){this.id=this.options.id||$.jui.getId(this.__idPrev())}else{this.id=this.options.id||this.element.id||$.jui.getId(this.__idPrev())}$.jui.add(this);if(!this.element){return}var attributes=this.attr();if(attributes&&attributes instanceof Array){for(var i=0;i<attributes.length;i++){var name=attributes[i];this.options[name]=$(this.element).attr(name)}}var p=this.options;if($(this.element).attr("jui")){try{var attroptions=$(this.element).attr("jui");if(attroptions.indexOf("{")!=0){attroptions="{"+attroptions+"}"}eval("attroptions = "+attroptions+";");if(attroptions){$.extend(p,attroptions)}}catch(e){}}},_preRender:function(){},_copyProperty:function(p,element){for(var key in p){if(element.attr(key)){if(key.indexOf("on")==0){p[key]=eval(element.attr(key))}else{if(typeof p[key]=="boolean"){p[key]=eval(element.attr(key))}else{p[key]=parseFloat(element.attr(key))?parseFloat(element.attr(key)):element.attr(key)}}}}},_render:function(){},_rendered:function(){if(this.element){$(this.element).attr("juiid",this.id)}},dataTransform:function(data,ui){return data},attr:function(){return[]},destroy:function(){if(this.element){$(this.element).remove()}this.options=null;$.jui.remove(this)}});$.jui.copyProperty=function(outRet,p,child){for(var key in p){if(child.attr(key)){if(key.indexOf("on")==0){outRet[key]=eval(child.attr(key))}else{if(typeof p[key]=="string"){if(key.toLowerCase().indexOf("width")>=0||key.toLowerCase().indexOf("height")>=0){outRet[key]=child.attr(key).indexOf("%")>=0?child.attr(key):Number(child.attr(key))}else{outRet[key]=parseFloat(child.attr(key))?parseFloat(child.attr(key)):child.attr(key)}}else{if(typeof p[key]=="boolean"||typeof p[key]=="number"){outRet[key]=eval(child.attr(key))}else{if(typeof p[key]=="function"||typeof p[key]=="object"){outRet[key]=eval("("+child.attr(key)+")")}}}}}}};$.jui.controls.Input=function(element,options){$.jui.controls.Input.base.constructor.call(this,element,options)};$.jui.controls.Input.juiceExtend($.jui.core.UIComponent,{__getType:function(){return"$.jui.controls.Input"},attr:function(){return["nullText"]},setValue:function(value){return this.set("value",value)},getValue:function(){return this.get("value")},setEnabled:function(){return this.set("disabled",false)},setDisabled:function(){return this.set("disabled",true)},updateStyle:function(){}});$.jui.win={top:false,mask:function(win){function setHeight(){if(!$.jui.win.windowMask){return}var h=$(window).height()+$(window).scrollTop();$.jui.win.windowMask.height(h)}if(!this.windowMask){this.windowMask=$("<div class='l-window-mask' style='display: block;'></div>").appendTo("body");$(window).bind("resize.juiwin",setHeight);$(window).bind("scroll",setHeight)}this.windowMask.show();setHeight();this.masking=true},unmask:function(win){var jwins=$("body > .l-dialog:visible,body > .l-window:visible");for(var i=0,l=jwins.length;i<l;i++){var winid=jwins.eq(i).attr("juiid");if(win&&win.id==winid){continue}var winmanager=$.jui.get(winid);if(!winmanager){continue}var modal=winmanager.get("modal");if(modal){return}}if(this.windowMask){this.windowMask.hide()}this.masking=false},createTaskbar:function(){if(!this.taskbar){this.taskbar=$('<div class="l-taskbar"><div class="l-taskbar-tasks"></div><div class="l-clear"></div></div>').appendTo("body");if(this.top){this.taskbar.addClass("l-taskbar-top")}this.taskbar.tasks=$(".l-taskbar-tasks:first",this.taskbar);this.tasks={}}this.taskbar.show();this.taskbar.animate({bottom:0});return this.taskbar},removeTaskbar:function(){var self=this;self.taskbar.animate({bottom:-32},function(){self.taskbar.remove();self.taskbar=null})},activeTask:function(win){for(var winid in this.tasks){var t=this.tasks[winid];if(winid==win.id){t.addClass("l-taskbar-task-active")}else{t.removeClass("l-taskbar-task-active")}}},getTask:function(win){var self=this;if(!self.taskbar){return}if(self.tasks[win.id]){return self.tasks[win.id]}return null},addTask:function(win){var self=this;if(!self.taskbar){self.createTaskbar()}if(self.tasks[win.id]){return self.tasks[win.id]}var title=win.get("title");var task=self.tasks[win.id]=$('<div class="l-taskbar-task"><div class="l-taskbar-task-icon"></div><div class="l-taskbar-task-content">'+title+"</div></div>");self.taskbar.tasks.append(task);self.activeTask(win);task.bind("click",function(){self.activeTask(win);if(win.actived){win.min()}else{win.active()}}).hover(function(){$(this).addClass("l-taskbar-task-over")},function(){$(this).removeClass("l-taskbar-task-over")});return task},hasTask:function(){for(var p in this.tasks){if(this.tasks[p]){return true}}return false},removeTask:function(win){var self=this;if(!self.taskbar){return}if(self.tasks[win.id]){self.tasks[win.id].unbind();self.tasks[win.id].remove();delete self.tasks[win.id]}if(!self.hasTask()){self.removeTaskbar()}},setFront:function(win){var wins=$.jui.find($.jui.core.Win);for(var i in wins){var w=wins[i];if(w==win){$(w.element).css("z-index","9200");this.activeTask(w)}else{$(w.element).css("z-index","9100")}}}};$.jui.core.Win=function(element,options){$.jui.core.Win.base.constructor.call(this,element,options)};$.jui.core.Win.juiceExtend($.jui.core.UIComponent,{__getType:function(){return"$.jui.controls.Win"},mask:function(){if(this.options.modal){$.jui.win.mask(this)}},unmask:function(){if(this.options.modal){$.jui.win.unmask(this)}},min:function(){},max:function(){},active:function(){}});$.jui.draggable={dragging:false};$.jui.resizable={reszing:false};$.jui.overrideMethod=function(parent,overrides){$.extend(parent.prototype,overrides)};$.jui.toJSON=typeof JSON==="object"&&JSON.stringify?JSON.stringify:function(o){var f=function(n){return n<10?"0"+n:n},escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,quote=function(value){escapable.lastIndex=0;return escapable.test(value)?'"'+value.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+value+'"'};if(o===null){return"null"}var type=typeof o;if(type==="undefined"){return undefined}if(type==="string"){return quote(o)}if(type==="number"||type==="boolean"){return""+o}if(type==="object"){if(typeof o.toJSON==="function"){return $.jui.toJSON(o.toJSON())}if(o.constructor===Date){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null}var pairs=[];if(o.constructor===Array){for(var i=0,l=o.length;i<l;i++){pairs.push($.jui.toJSON(o[i])||"null")}return"["+pairs.join(",")+"]"}var name,val;for(var k in o){type=typeof k;if(type==="number"){name='"'+k+'"'}else{if(type==="string"){name=quote(k)}else{continue}}type=typeof o[k];if(type==="function"||type==="undefined"){continue}val=$.jui.toJSON(o[k]);pairs.push(name+":"+val)}return"{"+pairs.join(",")+"}"}};$.jui.loadData=function(ui,params){var p=ui.options;ui.trigger("beforeLoad",p);$.ajax({type:"post",url:p.url,cache:false,dataType:p.dataType||"json",data:p.param||[],success:function(data){if(ui.dataTransform){data=ui.dataTransform(data)}ui.onLoad(params,data);ui.trigger("afterLoad",data)},error:function(XMLHttpRequest,textStatus){ui.trigger("onError",[XMLHttpRequest,textStatus])}})};var classNames={grid:"grid",tree:"tree",form:"form",tab:"tab",button:"button",accordion:"accordion",checkbox:"checkbox",comboBox:"comboBox",dateEditor:"dateEditor",dialog:"Dialog",fieldSet:"fieldSet",layout:"layout",menu:"menu",menubar:"menubar",messageBox:"messageBox",numberBox:"numberBox",panel:"panel"};$.jui.parse=function(){var header=".jui-";$(header+classNames.layout).length>0&&$(header+classNames.layout).juiceLayout();$(header+classNames.tab).length>0&&$(header+classNames.tab).juiceTab();$(header+classNames.panel).length>0&&$(header+classNames.panel).juicePanel();$(header+classNames.menu).length>0&&$(header+classNames.menu).juiceMenu();$(header+classNames.menubar).length>0&&$(header+classNames.menubar).juiceMenuBar();$(header+classNames.grid).length>0&&$(header+classNames.grid).juiceGrid();$(header+classNames.tree).length>0&&$(header+classNames.tree).juiceTree();$(header+classNames.fieldSet).length>0&&$(header+classNames.fieldSet).juiceFieldSet();$(header+classNames.form).length>0&&$(header+classNames.form).juiceForm();$(header+classNames.button).length>0&&$(header+classNames.button).juiceButton();if($(header+classNames.form).length==0){$(header+classNames.dateEditor).length>0&&$(header+classNames.dateEditor).juiceDateEditor();$(header+classNames.comboBox).length>0&&$(header+classNames.comboBox).juiceComboBox();$(header+classNames.numberBox).length>0&&$(header+classNames.numberBox).juiceNumberBox()}};$.jui.uitl={FormatString:{thousandSeparator:",",decimalSeparator:".",formatCleanRe:/[^\d\.]/g},numberFormat:function(data,formatString,params){if(!formatString){return data}if(isNaN(data)){return""}if(!params){params={}}var separator=formatString.match(/([\d][^\d^\.][\d])/g);if(separator!=null){separator=separator[0].substr(1,1)}var comma=separator||params.comma||this.FormatString.thousandSeparator,dec=this.FormatString.decimalSeparator,neg=data<0,hasComma,psplit;data=Math.abs(data);hasComma=formatString.indexOf(comma)!=-1;psplit=formatString.replace(this.FormatString.formatCleanRe,"").split(".");if(1<psplit.length){data=data.toFixed(psplit[1].length)}else{if(2<psplit.length){}else{data=data.toFixed(0)}}var fnum=data.toString();psplit=fnum.split(".");if(hasComma){var cnum=psplit[0],parr=[],j=cnum.length,m=Math.floor(j/3),n=cnum.length%3||3,i;for(i=0;i<j;i+=n){if(i!==0){n=3}parr[parr.length]=cnum.substr(i,n);m-=1}fnum=parr.join(comma);if(psplit[1]){fnum+=dec+psplit[1]}}else{if(psplit[1]){fnum=psplit[0]+dec+psplit[1]}}if(neg){neg=fnum.replace(/[^1-9]/g,"")!==""}return(neg?"-":"")+fnum}};$.jui.ajaxQueue={requests:new Array(),offer:function(options){var _self=this,xhrOptions=$.extend({},options,{complete:function(jqXHR,textStatus){if(options.complete){options.complete.call(this,jqXHR,textStatus)}_self.poll()},beforeSend:function(jqXHR,settings){if(options.beforeSend){var ret=options.beforeSend.call(this,jqXHR,settings)}if(ret===false){_self.poll();return ret}}});this.requests.push(xhrOptions);if(this.requests.length==1){$.ajax(xhrOptions)}},poll:function(){if(this.isEmpty()){return null}var processedRequest=this.requests.shift();var nextRequest=this.peek();if(nextRequest!=null){$.ajax(nextRequest)}return processedRequest},peek:function(){if(this.isEmpty()){return null}var nextRequest=this.requests[0];return nextRequest},isEmpty:function(){return this.requests.length==0}}})(jQuery);(function(b){var a=b.jui;b.fn.juiceDrag=function(c){return a.run.call(this,"juiceDrag",arguments,{idAttrName:"juidragid",hasElement:false,propertyToElemnt:"target"})};b.fn.juiceGetDragManager=function(){return a.run.call(this,"juiceGetDragManager",arguments,{idAttrName:"juidragid",hasElement:false,propertyToElemnt:"target"})};b.juiceDefaults.Drag={onStartDrag:false,onDrag:false,onStopDrag:false,handler:null,proxy:true,revert:false,animate:true,onRevert:null,onEndRevert:null,receive:null,onDragEnter:null,onDragOver:null,onDragLeave:null,onDrop:null,disabled:false,proxyX:null,proxyY:null};a.controls.Drag=function(c){a.controls.Drag.base.constructor.call(this,null,c)};a.controls.Drag.juiceExtend(a.core.UIComponent,{__getType:function(){return"Drag"},__idPrev:function(){return"Drag"},_render:function(){var c=this,d=this.options;this.set(d);c.cursor="move";c.handler.css("cursor",c.cursor);c.handler.bind("mousedown.drag",function(f){if(d.disabled){return}if(f.button==2){return}c._start.call(c,f)}).bind("mousemove.drag",function(){if(d.disabled){return}c.handler.css("cursor",c.cursor)})},_rendered:function(){this.options.target.juidragid=this.id},_start:function(f){var c=this,d=this.options;if(c.reverting){return}if(d.disabled){return}c.current={target:c.target,left:c.target.offset().left,top:c.target.offset().top,startX:f.pageX||f.screenX,startY:f.pageY||f.clientY};if(c.trigger("startDrag",[c.current,f])==false){return false}c.cursor="move";c._createProxy(d.proxy,f);if(d.proxy&&!c.proxy){return false}(c.proxy||c.handler).css("cursor",c.cursor);b(document).bind("selectstart.drag",function(){return false});b(document).bind("mousemove.drag",function(){c._drag.apply(c,arguments)});a.draggable.dragging=true;b(document).bind("mouseup.drag",function(){a.draggable.dragging=false;c._stop.apply(c,arguments)})},_drag:function(j){var f=this,h=this.options;if(!f.current){return}var d=j.pageX||j.screenX;var c=j.pageY||j.screenY;f.current.diffX=d-f.current.startX;f.current.diffY=c-f.current.startY;(f.proxy||f.handler).css("cursor",f.cursor);if(f.receive){f.receive.each(function(e,m){var l=b(m);var k=l.offset();if(d>k.left&&d<k.left+l.width()&&c>k.top&&c<k.top+l.height()){if(!f.receiveEntered[e]){f.receiveEntered[e]=true;f.trigger("dragEnter",[m,f.proxy||f.target,j])}else{f.trigger("dragOver",[m,f.proxy||f.target,j])}}else{if(f.receiveEntered[e]){f.receiveEntered[e]=false;f.trigger("dragLeave",[m,f.proxy||f.target,j])}}})}if(f.hasBind("drag")){if(f.trigger("drag",[f.current,j])!=false){f._applyDrag()}else{f._removeProxy()}}else{f._applyDrag()}},_stop:function(f){var c=this,d=this.options;b(document).unbind("mousemove.drag");b(document).unbind("mouseup.drag");b(document).unbind("selectstart.drag");if(c.receive){c.receive.each(function(e,h){if(c.receiveEntered[e]){c.trigger("drop",[h,c.proxy||c.target,f])}})}if(c.proxy){if(d.revert){if(c.hasBind("revert")){if(c.trigger("revert",[c.current,f])!=false){c._revert(f)}else{c._removeProxy()}}else{c._revert(f)}}else{c._applyDrag(c.target);c._removeProxy()}}c.cursor="move";c.trigger("stopDrag",[c.current,f]);c.current=null;c.handler.css("cursor",c.cursor)},_revert:function(d){var c=this;c.reverting=true;c.proxy.animate({left:c.current.left,top:c.current.top},function(){c.reverting=false;c._removeProxy();c.trigger("endRevert",[c.current,d]);c.current=null})},_applyDrag:function(c){var d=this,f=this.options;c=c||d.proxy||d.target;var j={},h=false;var e=c==d.target;if(d.current.diffX){if(e||f.proxyX==null){j.left=d.current.left+d.current.diffX}else{j.left=d.current.startX+f.proxyX+d.current.diffX}h=true}if(d.current.diffY){if(e||f.proxyY==null){j.top=d.current.top+d.current.diffY}else{j.top=d.current.startY+f.proxyY+d.current.diffY}h=true}if(c==d.target&&d.proxy&&f.animate){d.reverting=true;c.animate(j,function(){d.reverting=false})}else{c.css(j)}},_setReceive:function(c){this.receiveEntered={};if(!c){return}if(typeof c=="string"){this.receive=b(c)}else{this.receive=c}},_setHandler:function(c){var d=this,e=this.options;if(!c){d.handler=b(e.target)}else{d.handler=(typeof c=="string"?b(c,e.target):c)}},_setTarget:function(c){this.target=b(c)},_setCursor:function(c){this.cursor=c;(this.proxy||this.handler).css("cursor",c)},_createProxy:function(c,h){if(!c){return}var d=this,f=this.options;if(typeof c=="function"){d.proxy=c.call(this.options.target,d,h)}else{if(c=="clone"){d.proxy=d.target.clone().css("position","absolute");d.proxy.appendTo("body")}else{d.proxy=b("<div class='l-draggable'></div>");d.proxy.width(d.target.width()).height(d.target.height());d.proxy.attr("dragid",d.id).appendTo("body")}}d.proxy.css({left:f.proxyX==null?d.current.left:d.current.startX+f.proxyX,top:f.proxyY==null?d.current.top:d.current.startY+f.proxyY}).show()},_removeProxy:function(){var c=this;if(c.proxy){c.proxy.remove();c.proxy=null}}})})(jQuery);(function(a){a.fn.juiceResizable=function(b){return a.jui.run.call(this,"juiceResizable",arguments,{idAttrName:"juiresizableid",hasElement:false,propertyToElemnt:"target"})};a.fn.juiceGetResizableManager=function(){return a.jui.run.call(this,"juiceGetResizableManager",arguments,{idAttrName:"juiresizableid",hasElement:false,propertyToElemnt:"target"})};a.juiceDefaults.Resizable={handles:"n, e, s, w, ne, se, sw, nw",maxWidth:2000,maxHeight:2000,minWidth:20,minHeight:20,scope:3,animate:false,onStartResize:function(b){},onResize:function(b){},onStopResize:function(b){},onEndResize:null};a.jui.controls.Resizable=function(b){a.jui.controls.Resizable.base.constructor.call(this,null,b)};a.jui.controls.Resizable.juiceExtend(a.jui.core.UIComponent,{__getType:function(){return"Resizable"},__idPrev:function(){return"Resizable"},_render:function(){var b=this,c=this.options;b.target=a(c.target);b.set(c);b.target.mousemove(function(f){if(c.disabled){return}b.dir=b._getDir(f);if(b.dir){b.target.css("cursor",b.dir+"-resize")}else{if(b.target.css("cursor").indexOf("-resize")>0){b.target.css("cursor","default")}}if(c.target.juidragid){var d=a.jui.get(c.target.juidragid);if(d&&b.dir){d.set("disabled",true)}else{if(d){d.set("disabled",false)}}}}).mousedown(function(d){if(c.disabled){return}if(b.dir){b._start(d)}})},_rendered:function(){this.options.target.juiresizableid=this.id},_getDir:function(k){var j=this,b=this.options;var d="";var n=j.target.offset();var c=j.target.width();var l=j.target.height();var m=b.scope;var h=k.pageX||k.screenX;var f=k.pageY||k.screenY;if(f>=n.top&&f<n.top+m){d+="n"}else{if(f<=n.top+l&&f>n.top+l-m){d+="s"}}if(h>=n.left&&h<n.left+m){d+="w"}else{if(h<=n.left+c&&h>n.left+c-m){d+="e"}}if(b.handles=="all"||d==""){return d}if(a.inArray(d,j.handles)!=-1){return d}return""},_setHandles:function(b){if(!b){return}this.handles=b.replace(/(\s*)/g,"").split(",")},_createProxy:function(){var b=this;b.proxy=a('<div class="l-resizable"></div>');b.proxy.width(b.target.width()).height(b.target.height());b.proxy.attr("resizableid",b.id).appendTo("body")},_removeProxy:function(){var b=this;if(b.proxy){b.proxy.remove();b.proxy=null}},_start:function(d){var b=this,c=this.options;b._createProxy();b.proxy.css({left:b.target.offset().left,top:b.target.offset().top,position:"absolute"});b.current={dir:b.dir,left:b.target.offset().left,top:b.target.offset().top,startX:d.pageX||d.screenX,startY:d.pageY||d.clientY,width:b.target.width(),height:b.target.height()};a(document).bind("selectstart.resizable",function(){return false});a(document).bind("mouseup.resizable",function(){b._stop.apply(b,arguments)});a(document).bind("mousemove.resizable",function(){b._drag.apply(b,arguments)});b.proxy.show();b.trigger("startResize",[b.current,d])},changeBy:{t:["n","ne","nw"],l:["w","sw","nw"],w:["w","sw","nw","e","ne","se"],h:["n","ne","nw","s","se","sw"]},_drag:function(h){var d=this,f=this.options;if(!d.current){return}if(!d.proxy){return}d.proxy.css("cursor",d.current.dir==""?"default":d.current.dir+"-resize");var c=h.pageX||h.screenX;var b=h.pageY||h.screenY;d.current.diffX=c-d.current.startX;d.current.diffY=b-d.current.startY;d._applyResize(d.proxy);d.trigger("resize",[d.current,h])},_stop:function(d){var b=this,c=this.options;if(b.hasBind("stopResize")){if(b.trigger("stopResize",[b.current,d])!=false){b._applyResize()}}else{b._applyResize()}b._removeProxy();b.trigger("endResize",[b.current,d]);a(document).unbind("selectstart.resizable");a(document).unbind("mousemove.resizable");a(document).unbind("mouseup.resizable")},_applyResize:function(b){var c=this,d=this.options;var e={left:c.current.left,top:c.current.top,width:c.current.width,height:c.current.height};var f=false;if(!b){b=c.target;f=true;if(!isNaN(parseInt(c.target.css("top")))){e.top=parseInt(c.target.css("top"))}else{e.top=0}if(!isNaN(parseInt(c.target.css("left")))){e.left=parseInt(c.target.css("left"))}else{e.left=0}}if(a.inArray(c.current.dir,c.changeBy.l)>-1){e.left+=c.current.diffX;c.current.diffLeft=c.current.diffX}else{if(f){delete e.left}}if(a.inArray(c.current.dir,c.changeBy.t)>-1){e.top+=c.current.diffY;c.current.diffTop=c.current.diffY}else{if(f){delete e.top}}if(a.inArray(c.current.dir,c.changeBy.w)>-1){e.width+=(c.current.dir.indexOf("w")==-1?1:-1)*c.current.diffX;c.current.newWidth=e.width}else{if(f){delete e.width}}if(a.inArray(c.current.dir,c.changeBy.h)>-1){e.height+=(c.current.dir.indexOf("n")==-1?1:-1)*c.current.diffY;c.current.newHeight=e.height}else{if(f){delete e.height}}if(f&&d.animate){b.animate(e)}else{b.css(e)}}})})(jQuery);(function(a){a.fn.juiceLayout=function(b){return a.jui.run.call(this,"juiceLayout",arguments)};a.fn.juiceGetLayoutManager=function(){return a.jui.run.call(this,"juiceGetLayoutManager",arguments)};a.juiceDefaults.Layout={topHeight:50,bottomHeight:50,leftWidth:110,centerWidth:300,rightWidth:170,InWindow:true,heightDiff:0,height:"100%",onHeightChanged:null,isLeftCollapse:false,isRightCollapse:false,allowLeftCollapse:true,allowRightCollapse:true,allowLeftResize:true,allowRightResize:true,allowTopResize:true,allowBottomResize:true,space:3,onEndResize:null,minLeftWidth:80,onAfterResize:null,minRightWidth:80};a.juiceMethos.Layout={};a.jui.controls.Layout=function(c,b){a.jui.controls.Layout.base.constructor.call(this,c,b)};a.jui.controls.Layout.juiceExtend(a.jui.core.UIComponent,{__getType:function(){return"Layout"},__idPrev:function(){return"Layout"},_extendMethods:function(){return a.juiceMethos.Layout},_render:function(){var e=this,h=this.options;e.layout=a(this.element);e.layout.addClass("l-layout");e.width=e.layout.width();if(a("> div[position=top]",e.layout).length>0){e.top=a("> div[position=top]",e.layout).wrap('<div class="l-layout-top" style="top:0px;"></div>').parent();e.top.content=a("> div[position=top]",e.top);if(!e.top.content.hasClass("l-layout-content")){e.top.content.addClass("l-layout-content")}e.topHeight=h.topHeight;if(e.topHeight){e.top.height(e.topHeight)}}if(a("> div[position=bottom]",e.layout).length>0){e.bottom=a("> div[position=bottom]",e.layout).wrap('<div class="l-layout-bottom"></div>').parent();e.bottom.content=a("> div[position=bottom]",e.bottom);if(!e.bottom.content.hasClass("l-layout-content")){e.bottom.content.addClass("l-layout-content")}e.bottomHeight=h.bottomHeight;if(e.bottomHeight){e.bottom.height(e.bottomHeight)}var c=e.bottom.content.attr("title");if(c){e.bottom.header=a('<div class="l-layout-header"></div>');e.bottom.prepend(e.bottom.header);e.bottom.header.html(c);e.bottom.content.attr("title","")}}if(a("> div[position=left]",e.layout).length>0){e.left=a("> div[position=left]",e.layout).wrap('<div class="l-layout-left" style="left:0px;"></div>').parent();e.left.header=a('<div class="l-layout-header"><div class="l-layout-header-toggle"></div><div class="l-layout-header-inner"></div></div>');e.left.prepend(e.left.header);e.left.header.toggle=a(".l-layout-header-toggle",e.left.header);e.left.content=a("> div[position=left]",e.left);if(!e.left.content.hasClass("l-layout-content")){e.left.content.addClass("l-layout-content")}if(!h.allowLeftCollapse){a(".l-layout-header-toggle",e.left.header).remove()}var d=e.left.content.attr("title");if(d){e.left.content.attr("title","");a(".l-layout-header-inner",e.left.header).html(d)}e.leftWidth=h.leftWidth;if(e.leftWidth){e.left.width(e.leftWidth)}}if(a("> div[position=center]",e.layout).length>0){e.center=a("> div[position=center]",e.layout).wrap('<div class="l-layout-center" ></div>').parent();e.center.content=a("> div[position=center]",e.center);e.center.content.addClass("l-layout-content");var b=e.center.content.attr("title");if(b){e.center.content.attr("title","");e.center.header=a('<div class="l-layout-header"></div>');e.center.prepend(e.center.header);e.center.header.html(b)}e.centerWidth=h.centerWidth;if(e.centerWidth){e.center.width(e.centerWidth)}}if(a("> div[position=right]",e.layout).length>0){e.right=a("> div[position=right]",e.layout).wrap('<div class="l-layout-right"></div>').parent();e.right.header=a('<div class="l-layout-header"><div class="l-layout-header-toggle"></div><div class="l-layout-header-inner"></div></div>');e.right.prepend(e.right.header);e.right.header.toggle=a(".l-layout-header-toggle",e.right.header);if(!h.allowRightCollapse){a(".l-layout-header-toggle",e.right.header).remove()}e.right.content=a("> div[position=right]",e.right);if(!e.right.content.hasClass("l-layout-content")){e.right.content.addClass("l-layout-content")}var f=e.right.content.attr("title");if(f){e.right.content.attr("title","");a(".l-layout-header-inner",e.right.header).html(f)}e.rightWidth=h.rightWidth;if(e.rightWidth){e.right.width(e.rightWidth)}}e.layout.lock=a("<div class='l-layout-lock'></div>");e.layout.append(e.layout.lock);e._addDropHandle();e.isLeftCollapse=h.isLeftCollapse;e.isRightCollapse=h.isRightCollapse;e.leftCollapse=a('<div class="l-layout-collapse-left" style="display: none; "><div class="l-layout-collapse-left-toggle"></div></div>');e.rightCollapse=a('<div class="l-layout-collapse-right" style="display: none; "><div class="l-layout-collapse-right-toggle"></div></div>');e.layout.append(e.leftCollapse).append(e.rightCollapse);e.leftCollapse.toggle=a("> .l-layout-collapse-left-toggle",e.leftCollapse);e.rightCollapse.toggle=a("> .l-layout-collapse-right-toggle",e.rightCollapse);e._setCollapse();e._bulid();a(window).resize(function(){e._onResize()});e.set(h)},setLeftCollapse:function(c){var b=this,d=this.options;if(!b.left){return false}b.isLeftCollapse=c;if(b.isLeftCollapse){b.leftCollapse.show();b.leftDropHandle&&b.leftDropHandle.hide();b.left.hide()}else{b.leftCollapse.hide();b.leftDropHandle&&b.leftDropHandle.show();b.left.show()}b._onResize();b.trigger("afterResize",b.centerWidth,b.rightWidth)},setRightCollapse:function(c){var b=this,d=this.options;if(!b.right){return false}b.isRightCollapse=c;b._onResize();if(b.isRightCollapse){b.rightCollapse.show();b.rightDropHandle&&b.rightDropHandle.hide();b.right.hide()}else{b.rightCollapse.hide();b.rightDropHandle&&b.rightDropHandle.show();b.right.show()}b._onResize();b.trigger("afterResize",b.centerWidth,b.rightWidth)},_bulid:function(){var b=this,c=this.options;a("> .l-layout-left .l-layout-header,> .l-layout-right .l-layout-header",b.layout).hover(function(){a(this).addClass("l-layout-header-over")},function(){a(this).removeClass("l-layout-header-over")});a(".l-layout-header-toggle",b.layout).hover(function(){a(this).addClass("l-layout-header-toggle-over")},function(){a(this).removeClass("l-layout-header-toggle-over")});a(".l-layout-header-toggle",b.left).click(function(){b.setLeftCollapse(true)});a(".l-layout-header-toggle",b.right).click(function(){b.setRightCollapse(true)});b.middleTop=0;if(b.top){b.middleTop+=b.top.height();b.middleTop+=parseInt(b.top.css("borderTopWidth"));b.middleTop+=parseInt(b.top.css("borderBottomWidth"));b.middleTop+=c.space}if(b.left){b.left.css({top:b.middleTop});b.leftCollapse.css({top:b.middleTop})}if(b.center){b.center.css({top:b.middleTop})}if(b.right){b.right.css({top:b.middleTop});b.rightCollapse.css({top:b.middleTop})}if(b.left){b.left.css({left:0})}b._onResize();b._onResize()},_setCollapse:function(){var b=this,c=this.options;b.leftCollapse.hover(function(){a(this).addClass("l-layout-collapse-left-over")},function(){a(this).removeClass("l-layout-collapse-left-over")});b.leftCollapse.toggle.hover(function(){a(this).addClass("l-layout-collapse-left-toggle-over")},function(){a(this).removeClass("l-layout-collapse-left-toggle-over")});b.rightCollapse.hover(function(){a(this).addClass("l-layout-collapse-right-over")},function(){a(this).removeClass("l-layout-collapse-right-over")});b.rightCollapse.toggle.hover(function(){a(this).addClass("l-layout-collapse-right-toggle-over")},function(){a(this).removeClass("l-layout-collapse-right-toggle-over")});b.leftCollapse.toggle.click(function(){b.setLeftCollapse(false)});b.rightCollapse.toggle.click(function(){b.setRightCollapse(false)});if(b.left&&b.isLeftCollapse){b.leftCollapse.show();b.leftDropHandle&&b.leftDropHandle.hide();b.left.hide()}if(b.right&&b.isRightCollapse){b.rightCollapse.show();b.rightDropHandle&&b.rightDropHandle.hide();b.right.hide()}},_addDropHandle:function(){var b=this,c=this.options;if(b.left&&c.allowLeftResize){b.leftDropHandle=a("<div class='l-layout-drophandle-left'></div>");b.layout.append(b.leftDropHandle);b.leftDropHandle&&b.leftDropHandle.show();b.leftDropHandle.mousedown(function(d){b._start("leftresize",d)})}if(b.right&&c.allowRightResize){b.rightDropHandle=a("<div class='l-layout-drophandle-right'></div>");b.layout.append(b.rightDropHandle);b.rightDropHandle&&b.rightDropHandle.show();b.rightDropHandle.mousedown(function(d){b._start("rightresize",d)})}if(b.top&&c.allowTopResize){b.topDropHandle=a("<div class='l-layout-drophandle-top'></div>");b.layout.append(b.topDropHandle);b.topDropHandle.show();b.topDropHandle.mousedown(function(d){b._start("topresize",d)})}if(b.bottom&&c.allowBottomResize){b.bottomDropHandle=a("<div class='l-layout-drophandle-bottom'></div>");b.layout.append(b.bottomDropHandle);b.bottomDropHandle.show();b.bottomDropHandle.mousedown(function(d){b._start("bottomresize",d)})}b.draggingxline=a("<div class='l-layout-dragging-xline'></div>");b.draggingyline=a("<div class='l-layout-dragging-yline'></div>");b.layout.append(b.draggingxline).append(b.draggingyline)},_setDropHandlePosition:function(){var b=this,c=this.options;if(b.leftDropHandle){b.leftDropHandle.css({left:b.left.width()+parseInt(b.left.css("left")),height:b.middleHeight,top:b.middleTop})}if(b.rightDropHandle){b.rightDropHandle.css({left:parseInt(b.right.css("left"))-c.space,height:b.middleHeight,top:b.middleTop})}if(b.topDropHandle){b.topDropHandle.css({top:b.top.height()+parseInt(b.top.css("top")),width:b.top.width()})}if(b.bottomDropHandle){b.bottomDropHandle.css({top:parseInt(b.bottom.css("top"))-c.space,width:b.bottom.width()})}},_onResize:function(){var j=this,k=this.options;var b=j.layout.height();var e=0;var l=a(window).height();var d=null;if(typeof(k.height)=="string"&&k.height.indexOf("%")>0){var c=j.layout.parent();if(k.InWindow||c[0].tagName.toLowerCase()=="body"){d=l;d-=parseInt(a("body").css("paddingTop"));d-=parseInt(a("body").css("paddingBottom"))}else{d=c.height()}e=d*parseFloat(k.height)*0.01;if(k.InWindow||c[0].tagName.toLowerCase()=="body"){e-=(j.layout.offset().top-parseInt(a("body").css("paddingTop")))}}else{e=parseInt(k.height)}e+=k.heightDiff;j.layout.height(e);j.layoutHeight=j.layout.height();j.middleWidth=j.layout.width();j.middleHeight=j.layout.height();if(j.top){j.middleHeight-=j.top.height();j.middleHeight-=parseInt(j.top.css("borderTopWidth"));j.middleHeight-=parseInt(j.top.css("borderBottomWidth"));j.middleHeight-=k.space}if(j.bottom){j.middleHeight-=j.bottom.height();j.middleHeight-=parseInt(j.bottom.css("borderTopWidth"));j.middleHeight-=parseInt(j.bottom.css("borderBottomWidth"));j.middleHeight-=k.space}j.middleHeight-=2;if(j.hasBind("heightChanged")&&j.layoutHeight!=b){j.trigger("heightChanged",[{layoutHeight:j.layoutHeight,diff:j.layoutHeight-b,middleHeight:j.middleHeight}])}if(j.center){j.centerWidth=j.middleWidth;if(j.left){if(j.isLeftCollapse){j.centerWidth-=j.leftCollapse.width();j.centerWidth-=parseInt(j.leftCollapse.css("borderLeftWidth"));j.centerWidth-=parseInt(j.leftCollapse.css("borderRightWidth"));j.centerWidth-=parseInt(j.leftCollapse.css("left"));j.centerWidth-=k.space}else{j.centerWidth-=j.leftWidth;j.centerWidth-=parseInt(j.left.css("borderLeftWidth"));j.centerWidth-=parseInt(j.left.css("borderRightWidth"));j.centerWidth-=parseInt(j.left.css("left"));j.centerWidth-=k.space}}if(j.right){if(j.isRightCollapse){j.centerWidth-=j.rightCollapse.width();j.centerWidth-=parseInt(j.rightCollapse.css("borderLeftWidth"));j.centerWidth-=parseInt(j.rightCollapse.css("borderRightWidth"));j.centerWidth-=parseInt(j.rightCollapse.css("right"));j.centerWidth-=k.space}else{j.centerWidth-=j.rightWidth;j.centerWidth-=parseInt(j.right.css("borderLeftWidth"));j.centerWidth-=parseInt(j.right.css("borderRightWidth"));j.centerWidth-=k.space}}j.centerLeft=0;if(j.left){if(j.isLeftCollapse){j.centerLeft+=j.leftCollapse.width();j.centerLeft+=parseInt(j.leftCollapse.css("borderLeftWidth"));j.centerLeft+=parseInt(j.leftCollapse.css("borderRightWidth"));j.centerLeft+=parseInt(j.leftCollapse.css("left"));j.centerLeft+=k.space}else{j.centerLeft+=j.left.width();j.centerLeft+=parseInt(j.left.css("borderLeftWidth"));j.centerLeft+=parseInt(j.left.css("borderRightWidth"));j.centerLeft+=k.space}}j.center.css({left:j.centerLeft});j.center.width(j.centerWidth);j.center.height(j.middleHeight);var f=j.middleHeight;if(j.center.header){f-=j.center.header.height()}j.center.content.height(f)}if(j.left){j.leftCollapse.height(j.middleHeight);j.left.height(j.middleHeight)}if(j.right){j.rightCollapse.height(j.middleHeight);j.right.height(j.middleHeight);j.rightLeft=0;if(j.left){if(j.isLeftCollapse){j.rightLeft+=j.leftCollapse.width();j.rightLeft+=parseInt(j.leftCollapse.css("borderLeftWidth"));j.rightLeft+=parseInt(j.leftCollapse.css("borderRightWidth"));j.rightLeft+=k.space}else{j.rightLeft+=j.left.width();j.rightLeft+=parseInt(j.left.css("borderLeftWidth"));j.rightLeft+=parseInt(j.left.css("borderRightWidth"));j.rightLeft+=parseInt(j.left.css("left"));j.rightLeft+=k.space}}if(j.center){j.rightLeft+=j.center.width();j.rightLeft+=parseInt(j.center.css("borderLeftWidth"));j.rightLeft+=parseInt(j.center.css("borderRightWidth"));j.rightLeft+=k.space}j.right.css({left:j.rightLeft})}if(j.bottom){j.bottomTop=j.layoutHeight-j.bottom.height()-2;j.bottom.css({top:j.bottomTop})}j._setDropHandlePosition()},_start:function(f,d){var b=this,c=this.options;b.dragtype=f;if(f=="leftresize"||f=="rightresize"){b.xresize={startX:d.pageX};b.draggingyline.css({left:d.pageX-b.layout.offset().left,height:b.middleHeight,top:b.middleTop}).show();a("body").css("cursor","col-resize")}else{if(f=="topresize"||f=="bottomresize"){b.yresize={startY:d.pageY};b.draggingxline.css({top:d.pageY-b.layout.offset().top,width:b.layout.width()}).show();a("body").css("cursor","row-resize")}else{return}}b.layout.lock.width(b.layout.width());b.layout.lock.height(b.layout.height());b.layout.lock.show();if(a.browser.msie||a.browser.safari){a("body").bind("selectstart",function(){return false})}a(document).bind("mouseup",function(){b._stop.apply(b,arguments)});a(document).bind("mousemove",function(){b._drag.apply(b,arguments)})},_drag:function(d){var b=this,c=this.options;if(b.xresize){b.xresize.diff=d.pageX-b.xresize.startX;b.draggingyline.css({left:d.pageX-b.layout.offset().left});a("body").css("cursor","col-resize")}else{if(b.yresize){b.yresize.diff=d.pageY-b.yresize.startY;b.draggingxline.css({top:d.pageY-b.layout.offset().top});a("body").css("cursor","row-resize")}}},_stop:function(f){var b=this,d=this.options;var c;if(b.xresize&&b.xresize.diff!=undefined){c=b.xresize.diff;if(b.dragtype=="leftresize"){if(d.minLeftWidth){if(b.leftWidth+b.xresize.diff<d.minLeftWidth){return}}b.leftWidth+=b.xresize.diff;b.left.width(b.leftWidth);if(b.center){b.center.width(b.center.width()-b.xresize.diff).css({left:parseInt(b.center.css("left"))+b.xresize.diff})}else{if(b.right){b.right.width(b.left.width()-b.xresize.diff).css({left:parseInt(b.right.css("left"))+b.xresize.diff})}}}else{if(b.dragtype=="rightresize"){if(d.minRightWidth){if(b.rightWidth-b.xresize.diff<d.minRightWidth){return}}b.rightWidth-=b.xresize.diff;b.right.width(b.rightWidth).css({left:parseInt(b.right.css("left"))+b.xresize.diff});if(b.center){b.center.width(b.center.width()+b.xresize.diff)}else{if(b.left){b.left.width(b.left.width()+b.xresize.diff)}}}}}else{if(b.yresize&&b.yresize.diff!=undefined){c=b.yresize.diff;if(b.dragtype=="topresize"){b.top.height(b.top.height()+b.yresize.diff);b.middleTop+=b.yresize.diff;b.middleHeight-=b.yresize.diff;if(b.left){b.left.css({top:b.middleTop}).height(b.middleHeight);b.leftCollapse.css({top:b.middleTop}).height(b.middleHeight)}if(b.center){b.center.css({top:b.middleTop}).height(b.middleHeight)}if(b.right){b.right.css({top:b.middleTop}).height(b.middleHeight);b.rightCollapse.css({top:b.middleTop}).height(b.middleHeight)}}else{if(b.dragtype=="bottomresize"){b.bottom.height(b.bottom.height()-b.yresize.diff);b.middleHeight+=b.yresize.diff;b.bottomTop+=b.yresize.diff;b.bottom.css({top:b.bottomTop});if(b.left){b.left.height(b.middleHeight);b.leftCollapse.height(b.middleHeight)}if(b.center){b.center.height(b.middleHeight)}if(b.right){b.right.height(b.middleHeight);b.rightCollapse.height(b.middleHeight)}}}}}b.trigger("endResize",[{direction:b.dragtype?b.dragtype.replace(/resize/,""):"",diff:c},f]);b.trigger("afterResize",b.centerWidth,b.rightWidth);b._setDropHandlePosition();b.draggingxline.hide();b.draggingyline.hide();b.xresize=b.yresize=b.dragtype=false;b.layout.lock.hide();if(a.browser.msie||a.browser.safari){a("body").unbind("selectstart")}a(document).unbind("mousemove",b._drag);a(document).unbind("mouseup",b._stop);a("body").css("cursor","")}})})(jQuery);(function(a){a.fn.juiceAccordion=function(b){return a.jui.run.call(this,"juiceAccordion",arguments)};a.fn.juiceGetAccordionManager=function(){return a.jui.get(this)};a.juiceDefaults.Accordion={height:0,speed:"normal",changeHeightOnResize:false,heightDiff:0};a.juiceMethos.Accordion={};a.jui.controls.Accordion=function(c,b){a.jui.controls.Accordion.base.constructor.call(this,c,b)};a.jui.controls.Accordion.juiceExtend(a.jui.core.UIComponent,{__getType:function(){return"Accordion"},__idPrev:function(){return"Accordion"},_extendMethods:function(){return a.juiceMethos.Accordion},_render:function(){var c=this,d=this.options;c.accordion=a(c.element);if(!c.accordion.hasClass("l-accordion-panel")){c.accordion.addClass("l-accordion-panel")}var b=0;if(a("> div[lselected=true]",c.accordion).length>0){b=a("> div",c.accordion).index(a("> div[lselected=true]",c.accordion))}a("> div",c.accordion).each(function(e,f){var h=a('<div class="l-accordion-header"><div class="l-accordion-toggle"></div><div class="l-accordion-header-inner"></div></div>');if(e==b){a(".l-accordion-toggle",h).addClass("l-accordion-toggle-open")}if(a(f).attr("title")){a(".l-accordion-header-inner",h).html(a(f).attr("title"));a(f).attr("title","")}a(f).before(h);if(!a(f).hasClass("l-accordion-content")){a(f).addClass("l-accordion-content")}});a(".l-accordion-toggle",c.accordion).each(function(){if(!a(this).hasClass("l-accordion-toggle-open")&&!a(this).hasClass("l-accordion-toggle-close")){a(this).addClass("l-accordion-toggle-close")}if(a(this).hasClass("l-accordion-toggle-close")){a(this).parent().next(".l-accordion-content:visible").hide()}});a(".l-accordion-header",c.accordion).hover(function(){a(this).addClass("l-accordion-header-over")},function(){a(this).removeClass("l-accordion-header-over")});a(".l-accordion-toggle",c.accordion).hover(function(){if(a(this).hasClass("l-accordion-toggle-open")){a(this).addClass("l-accordion-toggle-open-over")}else{if(a(this).hasClass("l-accordion-toggle-close")){a(this).addClass("l-accordion-toggle-close-over")}}},function(){if(a(this).hasClass("l-accordion-toggle-open")){a(this).removeClass("l-accordion-toggle-open-over")}else{if(a(this).hasClass("l-accordion-toggle-close")){a(this).removeClass("l-accordion-toggle-close-over")}}});a(">.l-accordion-header",c.accordion).click(function(){var e=a(".l-accordion-toggle:first",this);if(e.hasClass("l-accordion-toggle-close")){e.removeClass("l-accordion-toggle-close").removeClass("l-accordion-toggle-close-over l-accordion-toggle-open-over");e.addClass("l-accordion-toggle-open");a(this).next(".l-accordion-content").show(d.speed).siblings(".l-accordion-content:visible").hide(d.speed);a(this).siblings(".l-accordion-header").find(".l-accordion-toggle").removeClass("l-accordion-toggle-open").addClass("l-accordion-toggle-close")}else{e.removeClass("l-accordion-toggle-open").removeClass("l-accordion-toggle-close-over l-accordion-toggle-open-over").addClass("l-accordion-toggle-close");a(this).next(".l-accordion-content").hide(d.speed)}});c.headerHoldHeight=0;a("> .l-accordion-header",c.accordion).each(function(){c.headerHoldHeight+=a(this).height()});if(d.height&&typeof(d.height)=="string"&&d.height.indexOf("%")>0){c.onResize();if(d.changeHeightOnResize){a(window).resize(function(){c.onResize()})}}else{if(d.height){c.height=d.heightDiff+d.height;c.accordion.height(c.height);c.setHeight(d.height)}else{c.header=c.accordion.height()}}c.set(d)},onResize:function(){var b=this,c=this.options;if(!c.height||typeof(c.height)!="string"||c.height.indexOf("%")==-1){return false}if(b.accordion.parent()[0].tagName.toLowerCase()=="body"){var d=a(window).height();d-=parseInt(b.layout.parent().css("paddingTop"));d-=parseInt(b.layout.parent().css("paddingBottom"));b.height=c.heightDiff+d*parseFloat(b.height)*0.01}else{b.height=c.heightDiff+(b.accordion.parent().height()*parseFloat(c.height)*0.01)}b.accordion.height(b.height);b.setContentHeight(b.height-b.headerHoldHeight)},setHeight:function(b){var c=this,d=this.options;c.accordion.height(b);b-=c.headerHoldHeight;a("> .l-accordion-content",c.accordion).height(b)}})})(jQuery);(function(a){a.fn.juiceTree=function(b){return a.jui.run.call(this,"juiceTree",arguments)};a.fn.juiceGetTreeManager=function(){return a.jui.run.call(this,"juiceGetTreeManager",arguments)};a.juiceDefaults.Tree={url:"",data:null,checkbox:false,autoCheckboxEven:true,parentIcon:"folder",childIcon:"leaf",textFieldName:"text",attribute:["id","url","uid","type"],treeLine:true,nodeWidth:90,statusName:"__status",isLeaf:null,single:false,onBeforeExpand:function(){},onContextmenu:function(){},onExpand:function(){},onBeforeCollapse:function(){},onCollapse:function(){},onBeforeSelect:function(){},onSelect:function(){},onBeforeCancelSelect:function(){},onCancelselect:function(){},onCheck:function(){},onSuccess:function(){},onError:function(){},onClick:function(){},idFieldName:"id",parentIDFieldName:null,topParentIDValue:0,onBeforeAppend:function(){},onAppend:function(){},onAfterAppend:function(){},slide:true,iconFieldName:"icon",nodeDraggable:false,nodeDraggingRender:null,btnClickToToggleOnly:true};a.juiceMethos.Tree=a.juiceMethos.Tree||{};a.jui.controls.Tree=function(c,b){a.jui.controls.Tree.base.constructor.call(this,c,b)};a.jui.controls.Tree.juiceExtend(a.jui.core.UIComponent,{_extendMethods:function(){return a.juiceMethos.Tree},_init:function(){a.jui.controls.Tree.base._init.call(this);var b=this,c=this.options;this._copyProperty(c,a(this.element));if(c.single){c.autoCheckboxEven=false}},_render:function(){var b=this,c=this.options;b.set(c,true);b.tree=a(b.element);b.tree.addClass("l-tree");b.sysAttribute=["isexpand","ischecked","href","style"];b.loading=a("<div class='l-tree-loading'></div>");b.tree.after(b.loading);b.data=[];b.maxOutlineLevel=1;b.treedataindex=0;b._applyTree();b._setTreeEven();b.set(c,false)},_setTreeLine:function(b){if(b){this.tree.removeClass("l-tree-noline")}else{this.tree.addClass("l-tree-noline")}},_setUrl:function(b){if(b){this.loadData(null,b)}},_setData:function(b){if(b){this.append(null,b)}},setData:function(b){this.set("data",b)},getData:function(){return this.data},getRoot:function(){var c=this;var b={};b.data=c._getDataNodeByTreeDataIndex(c.data,"0");return b},hasChildren:function(b){if(this.options.isLeaf){return this.options.isLeaf(b)}if("isLeaf" in b){return(b.isLeaf!="true"&&b.isLeaf!=true)}return b.children?true:false},getParent:function(f,e){var d=this;f=d.getNodeDom(f);var c=d.getParentTreeItem(f,e);if(!c){return null}var b=a(c).attr("treedataindex");return d._getDataNodeByTreeDataIndex(null,b)},getParentTreeItem:function(j,h){var d=this;j=d.getNodeDom(j);var f=a(j);if(f.parent().hasClass("l-tree")){return null}if(h==undefined){if(f.parent().parent("li").length==0){return null}return f.parent().parent("li")[0]}var e=parseInt(f.attr("outlinelevel"));var c=f;for(var b=e-1;b>=h;b--){c=c.parent().parent("li")}return c[0]},getChecked:function(){var c=this,d=this.options;if(!this.options.checkbox){return null}var b=[];a(".l-checkbox-checked",c.tree).parent().parent("li").each(function(){var e=parseInt(a(this).attr("treedataindex"));b.push({target:this,data:c._getDataNodeByTreeDataIndex(c.data,e)})});a(".l-checkbox-incomplete",c.tree).parent().parent("li").each(function(){var e=parseInt(a(this).attr("treedataindex"));b.push({target:this,data:c._getDataNodeByTreeDataIndex(c.data,e)})});return b},getSelected:function(){var c=this,e=this.options;var b={};b.target=a(".l-selected",c.tree).parent().parent("li")[0];if(b.target){var d=parseInt(a(b.target).attr("treedataindex"));b.data=c._getDataNodeByTreeDataIndex(c.data,d);return b}return null},upgrade:function(c){var b=this,d=this.options;a(".lineBtn",c).each(function(){a(this).removeAttr("class").addClass("switch").addClass("btnbox").addClass("root_open")});a("."+b._getChildNodeClassName(),c).each(function(){a(this).removeClass(b._getChildNodeClassName()).removeClass("l-box").addClass("ico_open").addClass("btnbox").addClass(b._getParentNodeClassName(true))})},demotion:function(c){var b=this,d=this.options;if(!c&&c[0].tagName.toLowerCase()!="li"){return}var e=a(c).hasClass("l-last");a(".roots_open",c).each(function(){a(this).removeClass("roots_open").addClass(e?"bottom_docu":"center_docu")});a(".l-expandable-close",c).each(function(){a(this).removeClass("roots_close").addClass(e?"bottom_docu":"center_docu")});a("."+b._getParentNodeClassName(true),c).each(function(){a(this).removeClass(b._getParentNodeClassName(true)).addClass(b._getChildNodeClassName())})},collapseAll:function(){var b=this,c=this.options;a(".roots_open",b.tree).click()},expandAll:function(){var b=this,c=this.options;a(".roots_close",b.tree).click()},onLoad:function(b,c){if(!c){return}this.loading.hide();this.append(b,c);if(b){b.isLoaded=true}this.trigger("success",[c])},onError:function(d,c){try{g.loading.hide();g.trigger("error",[XMLHttpRequest,d,c])}catch(b){}},loadData:function(e,c,h){var d=this,f=this.options;f.url=c;d.loading.show();var b=h?"post":"get";h=h||[];if(d.initParams){d.initParams(f,e)}f.param=f.param||{};a.extend(f.param,e);a.jui.loadData(d,e)},clear:function(){var b=this,c=this.options;a("> li",b.tree).each(function(){b.remove(this)})},getNodeDom:function(c){var b=this,d=this.options;if(c==null){return c}if(typeof(c)=="string"||typeof(c)=="number"){return a("li[treedataindex="+c+"]",b.tree).get(0)}else{if(typeof(c)=="object"&&"treedataindex" in c){return b.getNodeDom(c.treedataindex)}}return c},remove:function(f){var c=this,h=this.options;f=c.getNodeDom(f);var e=parseInt(a(f).attr("treedataindex"));var d=c._getDataNodeByTreeDataIndex(c.data,e);if(d){c._setTreeDataStatus([d],"delete")}var b=c.getParentTreeItem(f);if(h.checkbox){c._setParentCheckboxStatus(a(f))}a(f).remove();c._updateStyle(b?a("ul:first",b):c.tree)},_updateStyle:function(b){var c=this,e=this.options;var f=a(" > li",b);var d=f.length;if(!d){return}f.each(function(h,j){if(h==0&&!a(this).hasClass("l-first")){a(this).addClass("l-first")}if(h==d-1&&!a(this).hasClass("l-last")){a(this).addClass("l-last")}if(h==0&&h==d-1){a(this).addClass("l-onlychild")}a("> div .center_docu,> div .bottom_docu",this).removeClass("center_docu bottom_docu").addClass(h==d-1?"bottom_docu":"center_docu");c._setTreeItem(this,{isLast:h==d-1})})},update:function(j,c){var e=this,h=this.options;j=e.getNodeDom(j);var f=parseInt(a(j).attr("treedataindex"));nodedata=e._getDataNodeByTreeDataIndex(e.data,f);var d=a(".l-selected span",j).children();for(var b in c){nodedata[b]=c[b];if(b==h.textFieldName){a(".l-selected span",j).html("").append(d).append(c[b])}}},append:function(j,n,l,q){var k=this,c=this.options;j=k.getNodeDom(j);if(k.trigger("beforeAppend",[j,n])==false){return false}if(!n||!n.length){return false}if(c.idFieldName&&c.parentIDFieldName){n=k.arrayToTree(n,c.idFieldName,c.parentIDFieldName)}k._addTreeDataIndexToData(n);k._setTreeDataStatus(n,"add");if(l!=null){l=k.getNodeDom(l)}k.trigger("append",[j,n]);k._appendData(j,n);if(j==null){var d=k._getTreeHTMLByData(n,1,[],false);d[d.length-1]=d[0]="";if(l!=null){a(l)[q?"after":"before"](d.join(""));k._updateStyle(j?a("ul:first",j):k.tree)}else{if(a("> li:last",k.tree).length>0){k._setTreeItem(a("> li:last",k.tree)[0],{isLast:false})}k.tree.append(d.join(""))}a(".l-body",k.tree).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")});k._upadteTreeWidth();k.trigger("afterAppend",[j,n]);return}var b=a(j);var o=parseInt(b.attr("outlinelevel"));var h=a("> ul",b).length>0;if(!h){if(b.hasClass("l-last")){b.append("<ul class='l-children'></ul>")}else{b.append("<ul class='l-children l-line'></ul>")}k.upgrade(j)}var f=[];for(var e=1;e<=o-1;e++){var m=a(k.getParentTreeItem(j,e));f.push(m.hasClass("l-last"))}f.push(b.hasClass("l-last"));var d=k._getTreeHTMLByData(n,o+1,f,true);d[d.length-1]=d[0]="";if(l!=null){a(l)[q?"after":"before"](d.join(""));k._updateStyle(j?a("ul:first",j):k.tree)}else{if(a("> .l-children > li:last",b).length>0){k._setTreeItem(a("> .l-children > li:last",b)[0],{isLast:false})}a(">.l-children",j).append(d.join(""))}k._upadteTreeWidth();a(">.l-children .l-body",j).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")});k.trigger("afterAppend",[j,n])},_getDataLength:function(e,b,h,c){var f=this,j=this.options;var d=f.maxOutlineLevel;h=h||0;a(b).each(function(k,m){if(m.text){var l=m.text.replace(/[^\x00-\xff]/g,"__").length;if(h<l){h=l}}if(e){m.level=e.level+1}else{m.level=1}if(m.children){h=f._getDataLength(m,m.children,h)}});return h},cancelSelect:function(d){var c=this,j=this.options;var b=c.getNodeDom(d);var k=a(b);var f=parseInt(k.attr("treedataindex"));var e=c._getDataNodeByTreeDataIndex(c.data,f);var h=a(">div:first",k);if(j.checkbox){a(".l-checkbox",h).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked")}else{h.find("a:first").removeClass("l-selected")}c.trigger("cancelSelect",[{data:e,target:k[0]}])},selectNode:function(c){var b=this,j=this.options;var h=null;if(typeof(c)=="function"){h=c}else{if(typeof(c)=="object"){var k=a(c);var e=parseInt(k.attr("treedataindex"));var d=b._getDataNodeByTreeDataIndex(b.data,e);var f=a(">div:first",k);if(j.checkbox){a(".l-checkbox",f).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked")}else{f.find("a:first").addClass("l-selected")}b.trigger("select",[{data:d,target:k[0]}]);return}else{h=function(l){if(!l[j.idFieldName]){return false}return l[j.idFieldName].toString()==c.toString()}}}a("li",b.tree).each(function(){var n=a(this);var m=parseInt(n.attr("treedataindex"));var l=b._getDataNodeByTreeDataIndex(b.data,m);if(h(l,m)){b.selectNode(this)}else{b.cancelSelect(this)}})},getTextByID:function(e){var b=this,d=this.options;var c=b.getDataByID(e);if(!c){return null}return c[d.textFieldName]},getDataByID:function(e){var b=this,d=this.options;var c=null;a("li",b.tree).each(function(){if(c){return}var j=a(this);var h=parseInt(j.attr("treedataindex"));var f=b._getDataNodeByTreeDataIndex(b.data,h);if(f[d.idFieldName].toString()==e.toString()){c=f}});return c},arrayToTree:function(f,b,j){if(!f||!f.length){return[]}var m=[];var d={};var k=f.length;for(var h=0;h<k;h++){var c=f[h];d[c[b]]=c}for(var h=0;h<k;h++){var e=f[h];var l=d[e[j]];if(!l){m.push(e);continue}l.children=l.children||[];l.children.push(e);if(l.ischecked&&!e.ischecked){l.halfchecked=true}}return m},_getDataNodeByTreeDataIndex:function(e,d){var c=this,f=this.options;e=e||c.data;for(var b=0;b<e.length;b++){if(e[b].treedataindex==d){return e[b]}if(e[b].children){var h=c._getDataNodeByTreeDataIndex(e[b].children,d);if(h){return h}}}return null},_setTreeDataStatus:function(d,b){var c=this,e=this.options;a(d).each(function(){this[e.statusName]=b;if(this.children){c._setTreeDataStatus(this.children,b)}})},_addTreeDataIndexToData:function(c){var b=this,d=this.options;a(c).each(function(){if(this.treedataindex!=undefined){return}this.treedataindex=b.treedataindex++;if(this.children){b._addTreeDataIndexToData(this.children)}})},_addToNodes:function(c){var b=this,d=this.options;b.nodes=b.nodes||[];if(a.inArray(c,b.nodes)==-1){b.nodes.push(c)}if(c.children){a(c.children).each(function(e,f){b._addToNodes(f)})}},_appendData:function(f,e){var b=this,h=this.options;var d=parseInt(a(f).attr("treedataindex"));var c=b._getDataNodeByTreeDataIndex(b.data,d);if(b.treedataindex==undefined){b.treedataindex=0}if(c&&c.children==undefined){c.children=[]}a(e).each(function(j,k){if(c){c.children[c.children.length]=k}else{b.data[b.data.length]=k}b._addToNodes(k)})},_setTreeItem:function(f,c){var d=this,h=this.options;if(!c){return}f=d.getNodeDom(f);var e=a(f);var b=parseInt(e.attr("outlinelevel"));if(c.isLast!=undefined){if(c.isLast==true){e.removeClass("l-last").addClass("l-last");a("> div .center_docu",e).removeClass("center_docu").addClass("bottom_docu");a(">.l-children",e).removeClass("l-line")}else{if(c.isLast==false){e.removeClass("l-last");a("> div .bottom_docu",e).removeClass("bottom_docu").addClass("center_docu");a(">.l-children",e).removeClass("l-line").addClass("l-line")}}}},_upadteTreeWidth:function(){var b=this,c=this.options;var d=b.maxOutlineLevel*22;if(c.checkbox){d+=22}if(c.parentIcon||c.childIcon){d+=22}c.nodeWidth=b._getDataLength(null,b.data);d+=c.nodeWidth},_getChildNodeClassName:function(){var b=this,c=this.options;return"l-tree-icon-"+c.childIcon},_getParentNodeClassName:function(c){var d=this,e=this.options;var b="l-tree-icon-"+e.parentIcon;if(c){b+="-open"}return b},_getTreeHTMLByData:function(A,h,m,q,n){var x=this,s=this.options;if(x.maxOutlineLevel<h){x.maxOutlineLevel=h}m=m||[];h=h||1;var e=[];var f="<ul class='l-children";if(!n){f+=" l-line"}if(!q){f+="' style='display:none"}f+=" '>";e.push(f);for(var w=0;w<A.length;w++){var l=w==0;var z=w==A.length-1;var y=true;var t=A[w];var r=t.text.replace(/[^\x00-\xff]/g,"__").length;if(!t.isexpand||t.isexpand==false||t.isexpand=="false"){y=false}e.push("<li ");if(t.treedataindex!=undefined){e.push('treedataindex="'+t.treedataindex+'" ')}if(y){e.push("isexpand="+t.isexpand+" ")}e.push("outlinelevel="+h+" ");for(var v=0;v<x.sysAttribute.length;v++){if(a(this).attr(x.sysAttribute[v])){A[dataindex][x.sysAttribute[v]]=a(this).attr(x.sysAttribute[v])}}for(var v=0;v<s.attribute.length;v++){if(t[s.attribute[v]]){e.push(s.attribute[v]+'="'+t[s.attribute[v]]+'" ')}}e.push('class="');l&&e.push("l-first ");z&&e.push("l-last ");l&&z&&e.push("l-onlychild ");e.push('"');e.push(">");e.push("<div class='l-body'>");if(x.hasChildren(t)){var c=z?"root_open":"roots_open";var b=z?"root_close":"roots_close";if(y){e.push("<button type='button'  title='' class='switch btnbox "+c+"'></button>")}else{e.push("<button type='button'  title='' class='switch btnbox "+b+"'></button>")}}else{if(z){e.push('<button  class="lineBtn btnbox bottom_docu"  type="button" />')}else{e.push('<button type="button"  class="lineBtn btnbox center_docu"  type="button" />')}}if(s.checkbox){if(t.halfchecked){e.push('<button type="button"  class="l-box l-checkbox l-checkbox-incomplete"></button>')}else{if(t.ischecked){e.push('<button type="button"  class="l-box l-checkbox l-checkbox-checked"></button>')}else{e.push('<button type="button"  class="l-box l-checkbox l-checkbox-unchecked"></button>')}}}e.push('<a class="node-text" title="'+t[s.textFieldName]+'">');e.push("<span>");if(x.hasChildren(t)){if(s.parentIcon){if(y){e.push('<button type="button"  class="ico_open btnbox ');e.push(x._getParentNodeClassName(s.parentIcon?true:false)+" ");if(s.iconFieldName&&t[s.iconFieldName]){e.push("l-tree-icon-none")}e.push('">');if(s.iconFieldName&&t[s.iconFieldName]){e.push('<img src="'+t[s.iconFieldName]+'" />')}e.push("</button>")}else{e.push('<button type="button"  class="ico_close btnbox ');e.push(x._getParentNodeClassName(s.parentIcon?true:false)+" ");if(s.iconFieldName&&t[s.iconFieldName]){e.push("l-tree-icon-none")}e.push('">');if(s.iconFieldName&&t[s.iconFieldName]){e.push('<img src="'+t[s.iconFieldName]+'" />')}e.push("</button>")}}}else{if(s.childIcon){e.push('<button class="l-box  ');e.push(x._getChildNodeClassName()+" ");if(s.iconFieldName&&t[s.iconFieldName]){e.push("l-tree-icon-none")}e.push('">');if(s.iconFieldName&&t[s.iconFieldName]){e.push('<img src="'+t[s.iconFieldName]+'" />')}e.push("</button>")}}e.push(t[s.textFieldName]+"</span></a>");e.push("</div>");if(x.hasChildren(t)){var d=[];for(var u=0;u<m.length;u++){d.push(m[u])}d.push(z);if(t.children){e.push(x._getTreeHTMLByData(t.children,h+1,d,y,z).join(""))}}e.push("</li>")}e.push("</ul>");return e},_getDataByTreeHTML:function(d){var b=this,e=this.options;var c=[];a("> li",d).each(function(h,k){var l=c.length;c[l]={treedataindex:b.treedataindex++};c[l][e.textFieldName]=a("> span,> a",this).html();for(var f=0;f<b.sysAttribute.length;f++){if(a(this).attr(b.sysAttribute[f])){c[l][b.sysAttribute[f]]=a(this).attr(b.sysAttribute[f])}}for(var f=0;f<e.attribute.length;f++){if(a(this).attr(e.attribute[f])){c[l][e.attribute[f]]=a(this).attr(e.attribute[f])}}if(a("> ul",this).length>0){c[l].children=b._getDataByTreeHTML(a("> ul",this))}});return c},_getNodeStyle:function(b){},_applyTree:function(){var c=this,d=this.options;c.data=c._getDataByTreeHTML(c.tree);var b=c._getTreeHTMLByData(c.data,1,[],true);b[b.length-1]=b[0]="";c.tree.html(b.join(""));c._upadteTreeWidth();a(".l-body",c.tree).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")})},_applyTreeEven:function(c){var b=this,d=this.options;a("> .l-body",c).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")})},_getSrcElementByEvent:function(l){var f=this;var k=(l.target||l.srcElement);var b=k.tagName.toLowerCase();var j=a(k).parents().add(k);var c=function(m){for(var e=j.length-1;e>=0;e--){if(a(j[e]).hasClass(m)){return j[e]}}return null};if(j.index(this.element)==-1){return{out:true}}var d={tree:c("l-tree"),node:c("l-body"),checkbox:c("l-checkbox"),icon:c("l-tree-icon"),text:b=="span"};if(d.node){var h=parseInt(a(d.node).parent().attr("treedataindex"));d.data=f._getDataNodeByTreeDataIndex(f.data,h)}return d},_setTreeEven:function(){var b=this,c=this.options;if(b.hasBind("contextmenu")){b.tree.bind("contextmenu",function(j){var h=(j.target||j.srcElement);var k=null;if(h.tagName.toLowerCase()=="span"){k=a(h).parent().parent().parent()}else{if(a(h).hasClass("switch")||a(h).hasClass("l-checkbox")){k=a(h).parent().parent()}else{if(a(h).has("l-body")){k=a(h).parent()}else{if(h.tagName.toLowerCase()=="li"){k=a(h)}}}}if(!k){return}var f=parseInt(k.attr("treedataindex"));var d=b._getDataNodeByTreeDataIndex(b.data,f);return b.trigger("contextmenu",[{data:d,target:k[0]},j])})}b.tree.click(function(l){var k=(l.target||l.srcElement);a(k).blur();var n=null;if(k.tagName.toLowerCase()=="span"){n=a(k).parent().parent().parent()}else{if(a(k).hasClass("switch")||a(k).hasClass("l-checkbox")){n=a(k).parent().parent()}}if(!n){return}var j=parseInt(n.attr("treedataindex"));var h=b._getDataNodeByTreeDataIndex(b.data,j);var f=a("button.switch:first",n);var d=a(k).hasClass("roots_open")||a(k).hasClass("roots_close")||a(k).hasClass("root_open")||a(k).hasClass("root_close");if(!a(k).hasClass("l-checkbox")&&!d){if(a("a:first",n).hasClass("l-selected")){if(b.trigger("beforeCancelSelect",[{data:h,target:n[0]}])==false){return false}a("a:first",n).removeClass("l-selected");b.trigger("cancelSelect",[{data:h,target:n[0]}])}else{if(b.trigger("beforeSelect",[{data:h,target:n[0]}])==false){return false}a("a",b.tree).removeClass("l-selected");a("a:first",n).addClass("l-selected");b.trigger("select",[{data:h,target:n[0]}])}}if(a(k).hasClass("l-checkbox")){if(c.autoCheckboxEven){if(a(k).hasClass("l-checkbox-unchecked")){a(k).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked");a(".l-children .l-checkbox",n).removeClass("l-checkbox-incomplete l-checkbox-unchecked").addClass("l-checkbox-checked");b.trigger("check",[{data:h,target:n[0]},true])}else{if(a(k).hasClass("l-checkbox-checked")){a(k).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked");a(".l-children .l-checkbox",n).removeClass("l-checkbox-incomplete l-checkbox-checked").addClass("l-checkbox-unchecked");b.trigger("check",[{data:h,target:n[0]},false])}else{if(a(k).hasClass("l-checkbox-incomplete")){a(k).removeClass("l-checkbox-incomplete").addClass("l-checkbox-checked");a(".l-children .l-checkbox",n).removeClass("l-checkbox-incomplete l-checkbox-unchecked").addClass("l-checkbox-checked");b.trigger("check",[{data:h,target:n[0]},true])}}}b._setParentCheckboxStatus(n)}else{if(a(k).hasClass("l-checkbox-unchecked")){a(k).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked");if(c.single){a(".l-checkbox",b.tree).not(k).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked")}b.trigger("check",[{data:h,target:n[0]},true])}else{if(a(k).hasClass("l-checkbox-checked")){a(k).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked");b.trigger("check",[{data:h,target:n[0]},false])}}}}else{if((f.hasClass("roots_open")||f.hasClass("root_open"))&&(!c.btnClickToToggleOnly||d)){if(b.trigger("beforeCollapse",[{data:h,target:n[0]}])==false){return false}if(f.hasClass("roots_open")){f.removeClass("roots_open").addClass("roots_close")}if(f.hasClass("root_open")){f.removeClass("root_open").addClass("root_close")}f.parent().find(".ico_open:first").removeClass("ico_open").addClass("ico_close");if(c.slide){a("> .l-children",n).slideToggle("fast")}else{a("> .l-children",n).toggle()}a("> a ."+b._getParentNodeClassName(true),n).removeClass(b._getParentNodeClassName(true)).addClass(b._getParentNodeClassName());b.trigger("collapse",[{data:h,target:n[0]}])}else{if((f.hasClass("roots_close")||f.hasClass("root_close"))&&(!c.btnClickToToggleOnly||d)){if(b.trigger("beforeExpand",[{data:h,target:n[0]}])==false){return false}if(f.hasClass("root_close")){f.removeClass("root_close").addClass("root_open")}if(f.hasClass("roots_close")){f.removeClass("roots_close").addClass("roots_open")}f.parent().find(".ico_close:first").removeClass("ico_close").addClass("ico_open");var m=function(){b.trigger("expand",[{data:h,target:n[0]}])};if(!h.isLoaded&&c.url){a("> .l-children",n).toggle();m();b.loadData(h,c.url,h)}else{if(c.slide){a("> .l-children",n).slideToggle("fast",m)}else{a("> .l-children",n).toggle();m()}}a("> div ."+b._getParentNodeClassName(),n).removeClass(b._getParentNodeClassName()).addClass(b._getParentNodeClassName(true))}}}b.trigger("click",[{data:h,target:n[0]}])});if(a.fn.juiceDrag&&c.nodeDraggable){b.nodeDroptip=a("<div class='l-drag-nodedroptip' style='display:none'></div>").appendTo("body");b.tree.juiceDrag({revert:true,animate:false,proxyX:20,proxyY:20,proxy:function(d,m){var n=b._getSrcElementByEvent(m);if(n.node){var l="dragging";if(c.nodeDraggingRender){l=c.nodeDraggingRender(d.draggingNodes,d,b)}else{l="";var j=false;for(var h in d.draggingNodes){var k=d.draggingNodes[h];if(j){l+=","}l+=k.text;j=true}}var f=a("<div class='l-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div>"+l+"</div>").appendTo("body");return f}},onRevert:function(){return false},onRendered:function(){this.set("cursor","default");b.children[this.id]=this},onStartDrag:function(j,h){if(h.button==2){return false}this.set("cursor","default");var k=b._getSrcElementByEvent(h);if(k.checkbox){return false}if(c.checkbox){var f=b.getChecked();this.draggingNodes=[];for(var d in f){this.draggingNodes.push(f[d].data)}if(!this.draggingNodes||!this.draggingNodes.length){return false}}else{this.draggingNodes=[k.data]}this.draggingNode=k.data;this.set("cursor","move");b.nodedragging=true;this.validRange={top:b.tree.offset().top,bottom:b.tree.offset().top+b.tree.height(),left:b.tree.offset().left,right:b.tree.offset().left+b.tree.width()}},onDrag:function(s,t){var v=this.draggingNode;if(!v){return false}var f=this.draggingNodes?this.draggingNodes:[v];if(b.nodeDropIn==null){b.nodeDropIn=-1}var n=t.pageX;var j=t.pageY;var w=false;var x=this.validRange;if(n<x.left||n>x.right||j>x.bottom||j<x.top){b.nodeDropIn=-1;b.nodeDroptip.hide();this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes l-drop-add").addClass("l-drop-no");return}for(var o=0,h=b.nodes.length;o<h;o++){var m=b.nodes[o];var r=m.treedataindex;if(v.treedataindex==r){w=true}if(a.inArray(m,f)!=-1){continue}var y=w?true:false;if(b.nodeDropIn!=-1&&b.nodeDropIn!=r){continue}var d=a("li[treedataindex="+r+"]",b.tree);var k=d.offset();var q={top:k.top,bottom:k.top+d.height(),left:b.tree.offset().left,right:b.tree.offset().left+b.tree.width()};if(n>q.left&&n<q.right&&j>q.top&&j<q.bottom){var u=k.top;if(y){u+=d.height()}b.nodeDroptip.css({left:q.left,top:u,width:q.right-q.left}).show();b.nodeDropIn=r;b.nodeDropDir=y?"bottom":"top";if(j>q.top+7&&j<q.bottom-7){this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-yes").addClass("l-drop-add");b.nodeDroptip.hide();b.nodeDropInParent=true}else{this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-add").addClass("l-drop-yes");b.nodeDroptip.show();b.nodeDropInParent=false}break}else{if(b.nodeDropIn!=-1){b.nodeDropIn=-1;b.nodeDropInParent=false;b.nodeDroptip.hide();this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes  l-drop-add").addClass("l-drop-no")}}}},onStopDrag:function(l,k){var d=this.draggingNodes;b.nodedragging=false;if(b.nodeDropIn!=-1){for(var h=0;h<d.length;h++){var f=d[h].children;if(f){d=a.grep(d,function(m,e){var n=a.inArray(m,f)==-1;return n})}}for(var h in d){var j=d[h];if(b.nodeDropInParent){b.remove(j);b.append(b.nodeDropIn,[j])}else{b.remove(j);b.append(b.getParent(b.nodeDropIn),[j],b.nodeDropIn,b.nodeDropDir=="bottom")}}b.nodeDropIn=-1}b.nodeDroptip.hide();this.set("cursor","default")}})}},_setParentCheckboxStatus:function(f){var d=this,e=this.options;var b=a(".l-checkbox-unchecked",f.parent()).length==0;var c=a(".l-checkbox-checked",f.parent()).length==0;if(b){f.parent().parent().find(".l-checkbox").removeClass("l-checkbox-unchecked l-checkbox-incomplete").addClass("l-checkbox-checked")}else{if(c){f.parent().parent().find(">div .l-checkbox").removeClass("l-checkbox-checked l-checkbox-incomplete").addClass("l-checkbox-unchecked")}else{f.parent().parent().find(">div .l-checkbox").removeClass("l-checkbox-unchecked l-checkbox-checked").addClass("l-checkbox-incomplete")}}if(f.parent().parent("li").length>0){d._setParentCheckboxStatus(f.parent().parent("li"))}}})})(jQuery);(function(a){a.fn.juiceButton=function(b){return a.jui.run.call(this,"juiceButton",arguments)};a.fn.juiceGetButtonManager=function(){return a.jui.run.call(this,"juiceGetButtonManager",arguments)};a.juiceDefaults.Button={width:100,text:"Button",disabled:false};a.juiceMethos.Button={};a.jui.controls.Button=function(c,b){a.jui.controls.Button.base.constructor.call(this,c,b)};a.jui.controls.Button.juiceExtend(a.jui.controls.Input,{__getType:function(){return"Button"},__idPrev:function(){return"Button"},_extendMethods:function(){return a.juiceMethos.Button},_render:function(){var b=this,c=this.options;b.button=a(b.element);b.button.addClass("l-button");b.button.append("<span></span>");c.click&&b.button.click(function(){if(!c.disabled){c.click()}});b.set(c)},_setEnabled:function(b){if(b){this.button.removeClass("l-button-disabled")}},_setDisabled:function(b){if(b){this.button.addClass("l-button-disabled");this.options.disabled=true}},_setWidth:function(b){this.button.width(b)},_setText:function(b){a("span",this.button).html(b)},setValue:function(b){this.set("text",b)},getValue:function(){return this.options.text},setEnabled:function(){this.set("disabled",false)},setDisabled:function(){this.set("disabled",true)}})})(jQuery);(function(a){a.fn.juiceCheckBox=function(b){return a.jui.run.call(this,"juiceCheckBox",arguments)};a.fn.juiceGetCheckBoxManager=function(){return a.jui.run.call(this,"juiceGetCheckBoxManager",arguments)};a.juiceDefaults.CheckBox={disabled:false};a.juiceMethos.CheckBox={};a.jui.controls.CheckBox=function(c,b){a.jui.controls.CheckBox.base.constructor.call(this,c,b)};a.jui.controls.CheckBox.juiceExtend(a.jui.controls.Input,{__getType:function(){return"CheckBox"},__idPrev:function(){return"CheckBox"},_extendMethods:function(){return a.juiceMethos.CheckBox},_render:function(){var b=this,c=this.options;b.input=a(b.element);b.link=a('<a class="l-checkbox"></a>');b.wrapper=b.input.addClass("l-hidden").wrap('<div class="l-checkbox-wrapper"></div>').parent();b.wrapper.prepend(b.link);b.link.click(function(){if(b.input.attr("disabled")){return false}if(c.disabled){return false}if(b.trigger("beforeClick",[b.element])==false){return false}if(a(this).hasClass("l-checkbox-checked")){b._setValue(false)}else{b._setValue(true)}b.input.trigger("change")});b.wrapper.hover(function(){if(!c.disabled){a(this).addClass("l-over")}},function(){a(this).removeClass("l-over")});this.set(c);this.updateStyle()},_setCss:function(b){this.wrapper.css(b)},_setValue:function(c){var b=this,d=this.options;if(!c){b.input[0].checked=false;b.link.removeClass("l-checkbox-checked")}else{b.input[0].checked=true;b.link.addClass("l-checkbox-checked")}},_setDisabled:function(b){if(b){this.input.attr("disabled",true);this.wrapper.addClass("l-disabled")}else{this.input.attr("disabled",false);this.wrapper.removeClass("l-disabled")}},_getValue:function(){return this.element.checked},updateStyle:function(){if(this.input.attr("disabled")){this.wrapper.addClass("l-disabled");this.options.disabled=true}if(this.input[0].checked){this.link.addClass("l-checkbox-checked")}else{this.link.removeClass("l-checkbox-checked")}}})})(jQuery);(function(a){a.fn.juiceComboBox=function(b){return a.jui.run.call(this,"juiceComboBox",arguments)};a.fn.juiceGetComboBoxManager=function(){return a.jui.run.call(this,"juiceGetComboBoxManager",arguments)};a.juiceDefaults.ComboBox={resize:true,width:"",isMultiSelect:false,isShowCheckBox:false,columns:false,selectBoxWidth:0,selectBoxHeight:0,onBeforeSelect:false,onSelected:null,initValue:null,initText:"",textWidth:0,valueField:"id",textField:"text",valueFieldID:null,slide:false,split:";",data:null,tree:null,treeLeafOnly:true,grid:null,refType:null,refId:null,onStartResize:null,onEndResize:null,hideOnLoseFocus:true,forceLoad:false,url:"",onSuccess:null,onError:null,onBeforeOpen:null,render:null,valuePrefix:"",absolute:true,joinStr:""};a.juiceMethos.ComboBox=a.juiceMethos.ComboBox||{};a.jui.controls.ComboBox=function(c,b){a.jui.controls.ComboBox.base.constructor.call(this,c,b)};a.jui.controls.ComboBox.juiceExtend(a.jui.controls.Input,{__getType:function(){return"ComboBox"},_extendMethods:function(){return a.juiceMethos.ComboBox},_init:function(){a.jui.controls.ComboBox.base._init.call(this);var d=this.options;this._copyProperty(d,a(this.element));d.width=d.textWidth||d.width;if(d.refType=="tree"&&d.refId){var b={};a.extend(b,a.juiceDefaults.Tree,this.options.tree);this._copyProperty(b,a("#"+d.refId));this.options.tree=b}if(d.refType=="grid"&&d.refId){var c={};a.extend(c,a.juiceDefaults.Grid,this.options.grid);a.jui.controls.Grid.createParams(c,a("#"+d.refId));this.options.grid=c}if(d.columns){d.isShowCheckBox=true}if(d.isMultiSelect){d.isShowCheckBox=true}},_render:function(){var b=this,c=this.options;b.data=c.data;b.inputText=null;b.select=null;b.textFieldID="";b.valueFieldID="";b.valueField=null;if(this.element.tagName.toLowerCase()=="input"){this.element.readOnly=true;b.inputText=a(this.element);b.textFieldID=this.element.id}else{if(this.element.tagName.toLowerCase()=="select"){a(this.element).hide();b.select=a(this.element);c.isMultiSelect=false;c.isShowCheckBox=false;b.textFieldID=this.element.id+"_txt";b.inputText=a('<input type="text" readonly="true"/>');b.inputText.attr("id",b.textFieldID).insertAfter(a(this.element))}else{return}}if(b.inputText[0].name==undefined){b.inputText[0].name=b.textFieldID}b.valueField=null;if(c.valueFieldID){b.valueField=a("#"+c.valueFieldID+":input");if(b.valueField.length==0){b.valueField=a('<input type="hidden"/>')}b.valueField[0].id=b.valueField[0].name=c.valueFieldID}else{b.valueField=a('<input type="hidden"/>');b.valueField[0].id=b.valueField[0].name=b.textFieldID+"_val"}if(b.valueField[0].name==undefined){b.valueField[0].name=b.valueField[0].id}b.link=a('<div class="l-trigger"><div class="l-trigger-icon"></div></div>');b.selectBox=a('<div class="l-box-select"><div class="l-box-select-inner"><table cellpadding="0" cellspacing="0" border="0" class="l-box-select-table"></table></div></div>');b.selectBox.table=a("table:first",b.selectBox);b.wrapper=b.inputText.wrap('<div class="l-text l-text-combobox"></div>').parent();b.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>');b.wrapper.append(b.link);b.textwrapper=b.wrapper.wrap('<div class="l-text-wrapper"></div>').parent();if(c.absolute){b.selectBox.appendTo("body").addClass("l-box-select-absolute")}else{b.textwrapper.append(b.selectBox)}b.textwrapper.append(b.valueField);b.inputText.addClass("l-text-field");if(c.isShowCheckBox&&!b.select){a("table",b.selectBox).addClass("l-table-checkbox")}else{c.isShowCheckBox=false;a("table",b.selectBox).addClass("l-table-nocheckbox")}b.link.hover(function(){if(c.disabled){return}this.className="l-trigger-hover"},function(){if(c.disabled){return}this.className="l-trigger"}).mousedown(function(){if(c.disabled){return}this.className="l-trigger-pressed"}).mouseup(function(){if(c.disabled){return}this.className="l-trigger-hover"}).click(function(){if(c.disabled){return}if(b.trigger("beforeOpen")==false){return false}b._toggleSelectBox(b.selectBox.is(":visible"))});b.inputText.click(function(){if(c.disabled){return}if(b.trigger("beforeOpen")==false){return false}b._toggleSelectBox(b.selectBox.is(":visible"))}).blur(function(){if(c.disabled){return}b.wrapper.removeClass("l-text-focus")}).focus(function(){if(c.disabled){return}b.wrapper.addClass("l-text-focus")});b.wrapper.hover(function(){if(c.disabled){return}b.wrapper.addClass("l-text-over")},function(){if(c.disabled){return}b.wrapper.removeClass("l-text-over")});b.resizing=false;b.selectBox.hover(null,function(f){});var d=a("tr",b.selectBox.table).length;if(!c.selectBoxHeight&&d<8){c.selectBoxHeight=d*30}if(c.selectBoxHeight){b.selectBox.height(c.selectBoxHeight)}b.bulidContent();b.set(c);if(c.selectBoxWidth){b.selectBox.width(c.selectBoxWidth)}else{b.selectBox.css("width",b.wrapper.css("width"))}this._setEvent()},destroy:function(){if(this.wrapper){this.wrapper.remove()}if(this.selectBox){this.selectBox.remove()}this.options=null;a.jui.remove(this)},_setDisabled:function(b){if(b){this.wrapper.addClass("l-text-disabled")}else{this.wrapper.removeClass("l-text-disabled")}},_setLable:function(b){var c=this,d=this.options;if(b){if(c.labelwrapper){c.labelwrapper.find(".l-text-label:first").html(b+":&nbsp")}else{c.labelwrapper=c.textwrapper.wrap('<div class="l-labeltext"></div>').parent();c.labelwrapper.prepend('<div class="l-text-label" style="float:left;display:inline;">'+b+":&nbsp</div>");c.textwrapper.css("float","left")}if(!d.labelWidth){d.labelWidth=a(".l-text-label",c.labelwrapper).outerWidth()}else{a(".l-text-label",c.labelwrapper).outerWidth(d.labelWidth)}a(".l-text-label",c.labelwrapper).width(d.labelWidth);a(".l-text-label",c.labelwrapper).height(c.wrapper.height());c.labelwrapper.append('<br style="clear:both;" />');if(d.labelAlign){a(".l-text-label",c.labelwrapper).css("text-align",d.labelAlign)}c.textwrapper.css({display:"inline"});c.labelwrapper.width(c.wrapper.outerWidth()+d.labelWidth+2)}},_setWidth:function(c){var b=this;if(c>20){b.wrapper.css({width:c});b.inputText.css({width:c-20});b.textwrapper.css({width:c})}},_setHeight:function(c){var b=this;if(c>10){b.wrapper.height(c);b.inputText.height(c-2);b.link.height(c-4);b.textwrapper.css({width:c})}},_setResize:function(b){if(b&&a.fn.juiceResizable){var c=this;c.selectBox.juiceResizable({handles:"se,s,e",onStartResize:function(){c.resizing=true;c.trigger("startResize")},onEndResize:function(){c.resizing=false;if(c.trigger("endResize")==false){return false}}});c.selectBox.append("<div class='l-btn-nw-drop'></div>")}},findTextByValue:function(e){var b=this,f=this.options;if(e==undefined){return""}var d="";var c=function(k){var h=e.toString().split(f.split);for(var j=0;j<h.length;j++){if(h[j]==k){return true}}return false};a(b.data).each(function(j,k){var l=k[f.valueField];var h=k[f.textField];if(c(l)){d+=h+f.split}});if(d.length>0){d=d.substr(0,d.length-1)}return d},findValueByText:function(f){var c=this,e=this.options;if(!f&&f==""){return""}var d=function(k){var h=f.toString().split(e.split);for(var j=0;j<h.length;j++){if(h[j]==k){return true}}return false};var b="";a(c.data).each(function(j,k){var l=k[e.valueField];var h=k[e.textField];if(d(h)){b+=l+e.split}});if(b.length>0){b=b.substr(0,b.length-1)}return b},removeItem:function(){},insertItem:function(){},addItem:function(){},_setValue:function(e){var d=this,f=this.options;this.initValue=e;var h=d.findTextByValue(e);if(f.tree){d.selectValueByTree(e)}else{if(f.grid){d.selectValueByGrid(e)}else{if(!f.isMultiSelect){d._changeValue(e,h);a("tr[value="+e+"] td",d.selectBox).addClass("l-selected");a("tr[value!="+e+"] td",d.selectBox).removeClass("l-selected")}else{d._changeValue(e,h);var b=e?e.toString().split(f.split):[];a("table.l-table-checkbox :checkbox",d.selectBox).each(function(){this.checked=false});for(var c=0;c<b.length;c++){a("table.l-table-checkbox tr[value="+b[c]+"] :checkbox",d.selectBox).each(function(){this.checked=true})}}}}},selectValue:function(b){this._setValue(b)},bulidContent:function(){var b=this,c=this.options;this.clearContent();if(b.select){b.setSelect()}else{if(b.data&&!c.forceLoad){b.setData(b.data)}else{if(c.tree){b.setTree(c.tree)}else{if(c.grid){b.setGrid(c.grid)}else{if(c.url){b.setUrl(c.url)}}}}}},load:function(c,b){var d=this,e=this.options;if(b){d.setUrl(c)}else{d.setData(d.data)}},setUrl:function(b){var c=this,d=this.options;d.url=b;a.ajax({type:"post",url:d.url,cache:false,dataType:"json",success:function(e){if(c.dataTransform){e=c.dataTransform(e,d)}c.data=e;c.setData(c.data);c._setValue(c.initValue||d.initValue);c.trigger("success",[c.data])},error:function(e,f){c.trigger("error",[e,f])}})},clearContent:function(){var b=this,c=this.options;a("table",b.selectBox).html("")},setSelect:function(){var b=this,c=this.options;b.data=b.data||[];this.clearContent();a("option",b.select).each(function(e){var f={};var j=a(this).val();var d=a(this).html();var h=a("<tr><td index='"+e+"' value='"+j+"'>"+d+"</td>");a("table.l-table-nocheckbox",b.selectBox).append(h);a("td",h).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")});f[c.valueField]=j;f[c.textField]=d;b.data.push(f)});a("td:eq("+b.select[0].selectedIndex+")",b.selectBox).each(function(){if(a(this).hasClass("l-selected")){b.selectBox.hide();return}a(".l-selected",b.selectBox).removeClass("l-selected");a(this).addClass("l-selected");if(b.select[0].selectedIndex!=a(this).attr("index")&&b.select[0].onchange){b.select[0].selectedIndex=a(this).attr("index");b.select[0].onchange()}var d=parseInt(a(this).attr("index"));b.select[0].selectedIndex=d;b.select.trigger("change");b.selectBox.hide();var e=a(this).attr("value");var f=a(this).html();if(c.render){b.inputText.val(c.render(e,f))}else{b.inputText.val(f)}});b._addClickEven()},setData:function(e){var k=this,b=this.options;this.clearContent();if(!e||!e.length){return}if(k.data!=e){k.data=e}if(b.columns){k.selectBox.table.headrow=a("<tr class='l-table-headerow'><td width='18px'></td></tr>");k.selectBox.table.append(k.selectBox.table.headrow);k.selectBox.table.addClass("l-box-select-grid");for(var d=0;d<b.columns.length;d++){var m=a("<td columnindex='"+d+"' columnname='"+b.columns[d].name+"'>"+b.columns[d].header+"</td>");if(b.columns[d].width){m.width(b.columns[d].width)}k.selectBox.table.headrow.append(m)}}for(var f=0;f<e.length;f++){var c=e[f][b.valueField];var h=e[f][b.textField];if(b.joinStr&&(c!=null&&c!="")&&(h!=null&&h!="")){h=c+b.joinStr+h}if(!b.columns){a("table.l-table-checkbox",k.selectBox).append("<tr value='"+c+"'><td style='width:18px;'  index='"+f+"' value='"+c+"' text='"+h+"' ><input type='checkbox' /></td><td index='"+f+"' value='"+c+"' align='left'>"+h+"</td>");a("table.l-table-nocheckbox",k.selectBox).append("<tr value='"+c+"'><td index='"+f+"' value='"+c+"' align='left'>"+h+"</td>")}else{var l=a("<tr value='"+c+"'><td style='width:18px;'  index='"+f+"' value='"+c+"' text='"+h+"' ><input type='checkbox' /></td></tr>");a("td",k.selectBox.table.headrow).each(function(){var j=a(this).attr("columnname");if(j){var n=a("<td>"+e[f][j]+"</td>");l.append(n)}});k.selectBox.table.append(l)}}a(".l-table-checkbox input:checkbox",k.selectBox).change(function(){if(this.checked&&k.hasBind("beforeSelect")){var j=null;if(a(this).parent().get(0).tagName.toLowerCase()=="div"){j=a(this).parent().parent()}else{j=a(this).parent()}if(j!=null&&k.trigger("beforeSelect",[j.attr("value"),j.attr("text")])==false){k.selectBox.slideToggle("fast");return false}}if(!b.isMultiSelect){if(this.checked){a("input:checked",k.selectBox).not(this).each(function(){this.checked=false;a(".l-checkbox-checked",a(this).parent()).removeClass("l-checkbox-checked")});k.selectBox.slideToggle("fast")}}k._checkboxUpdateValue()});a("table.l-table-nocheckbox td",k.selectBox).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")});k._addClickEven();k._dataInit()},setTree:function(b){var c=this,d=this.options;this.clearContent();c.selectBox.table.remove();if(b.checkbox!=false){b.onCheck=function(){var e=c.treeManager.getChecked();var f=[];var h=[];a(e).each(function(j,k){if(d.treeLeafOnly&&k.data.children){return}f.push(k.data[d.valueField]);h.push(k.data[d.textField])});c._changeValue(f.join(d.split),h.join(d.split))}}else{b.onClick=function(e){if(this.getSelected()&&(e.data.id==this.getSelected().data.id)){c.selectBox.hide()}};b.onBeforeSelect=function(f){var e=this;if(d.treeLeafOnly&&e.hasChildren(f.data)){return false}};b.onSelect=function(e){var f=e.data[d.valueField];var h=e.data[d.textField];c._changeValue(f,h)};b.onCancelSelect=function(e){c._changeValue("","")}}b.onAfterAppend=function(h,e){if(!c.treeManager){return}var f=null;if(c.valueField.val()!=""){f=c.valueField.val()}else{if(d.initValue){f=d.initValue}}c.selectValueByTree(f)};c.tree=a("<ul></ul>");c.selectBox.css("overflow","auto");a("div:first",c.selectBox).append(c.tree);c.tree.juiceTree(b);c.treeManager=c.tree.juiceGetTreeManager()},selectValueByTree:function(d){var c=this,e=this.options;if(d!=null){var f="";var b=d.toString().split(e.split);a(b).each(function(h,j){c.treeManager.selectNode(e.valuePrefix+j.toString());f+=c.treeManager.getTextByID(j);if(h<b.length-1){f+=e.split}});f=(f&&f!="null")?f:e.initText;c._changeValue(d,f)}},setGrid:function(b){var c=this,d=this.options;this.clearContent();c.selectBox.table.remove();c.grid=a("div:first",c.selectBox);b.columnWidth=b.columnWidth||120;b.width="100%";b.height="100%";b.heightDiff=+2;b.InWindow=false;d.hideOnLoseFocus=false;if(b.checkbox!=false){b.onCheckAllRow=b.onCheckRow=function(){var e=c.gridManager.getCheckedRows();var f=[];var h=[];a(e).each(function(j,k){f.push(k[d.valueField]);h.push(k[d.textField])});c._changeValue(f.join(d.split),h.join(d.split))}}else{b.onSelectRow=function(k,h,e){var f=k[d.valueField];var j=k[d.textField];c._changeValue(f,j);c.selectedRow=k;c.selectBox.hide()};b.onUnSelectRow=function(h,f,e){c._changeValue("","");c.selectBox.hide()}}c.gridManager=c.grid.juiceGrid(b);c.bind("show",function(){if(c.gridManager){c.gridManager._updateFrozenWidth()}});c.bind("endResize",function(){if(c.gridManager){c.gridManager._updateFrozenWidth();c.gridManager.setHeight(c.selectBox.height())}})},selectValueByGrid:function(d){var c=this,e=this.options;if(d!=null){var f=e.initText;var b=c.gridManager.getData();a(b).each(function(j,h){if(d==h[e.valueField]){f=h[e.textField]}});c._changeValue(d,f)}},_getValue:function(){return a(this.valueField).val()},getValue:function(){return this._getValue()},_getLabel:function(){return a(this.element).val()},getLabel:function(){return this._getLabel()},updateStyle:function(){var b=this,c=this.options;b._dataInit()},_dataInit:function(){var b=this,d=this.options;var c=null;if(d.initValue!=null&&d.initText){b._changeValue(d.initValue,d.initText)}else{if(d.initValue!=null){c=d.initValue;if(d.tree){if(c){b.selectValueByTree(c)}}else{var e=b.findTextByValue(c);b._changeValue(c,e)}}else{if(d.initText!=null){c=b.findValueByText(d.initText);b._changeValue(c,d.initText)}else{if(b.valueField.val()!=""){c=b.valueField.val();if(d.tree){if(c){b.selectValueByTree(c)}}else{var e=b.findTextByValue(c);b._changeValue(c,e)}}}}}if(!d.isShowCheckBox&&c!=null){a("table tr",b.selectBox).find("td:first").each(function(){if(c==a(this).attr("value")){a(this).addClass("l-selected")}})}if(d.isShowCheckBox&&c!=null){a(":checkbox",b.selectBox).each(function(){var j=null;var h=a(this);if(h.parent().get(0).tagName.toLowerCase()=="div"){j=h.parent().parent()}else{j=h.parent()}if(j==null){return}var f=c.toString().split(d.split);a(f).each(function(k,l){if(l==j.attr("value")){a(".l-checkbox",j).addClass("l-checkbox-checked");h[0].checked=true}})})}},_onClick:function(d){var c=(d.target||d.srcElement);var b=a(c).parents().add(c);if(b.index(this.element)==-1&&b.index(this.link)==-1&&b.index(this.selectBox)==-1){if(this.selectBox.is(":visible")){this.selectBox.hide()}}},_setEvent:function(){var b=this;a(document).bind("click.combox",function(c){b._onClick.call(b,c)})},_changeValue:function(e,c){var b=this,d=this.options;b.valueField.val(e);c=c||d.initText;if(d&&d.render){b.inputText.val(d.render(e,c))}else{b.inputText.val(c)}b.selectedValue=e;b.selectedText=c;b.inputText.trigger("change").focus();b.trigger("selected",[e,c])},_checkboxUpdateValue:function(){var d=this,e=this.options;var b="";var c="";a("input:checked",d.selectBox).each(function(){var f=null;if(a(this).parent().get(0).tagName.toLowerCase()=="div"){f=a(this).parent().parent()}else{f=a(this).parent()}if(!f){return}b+=f.attr("value")+e.split;c+=f.attr("text")+e.split});if(b.length>0){b=b.substr(0,b.length-1)}if(c.length>0){c=c.substr(0,c.length-1)}d._changeValue(b,c)},_addClickEven:function(){var b=this,c=this.options;a(".l-table-nocheckbox td",b.selectBox).click(function(){var e=a(this).attr("value");var d=parseInt(a(this).attr("index"));var f=a(this).html();if(b.hasBind("beforeSelect")&&b.trigger("beforeSelect",[e,f])==false){if(c.slide){b.selectBox.slideToggle("fast")}else{b.selectBox.hide()}return false}if(a(this).hasClass("l-selected")){if(c.slide){b.selectBox.slideToggle("fast")}else{b.selectBox.hide()}return}a(".l-selected",b.selectBox).removeClass("l-selected");a(this).addClass("l-selected");if(b.select){if(b.select[0].selectedIndex!=d){b.select[0].selectedIndex=d;b.select.trigger("change")}}if(c.slide){b.boxToggling=true;b.selectBox.hide("fast",function(){b.boxToggling=false})}else{b.selectBox.hide()}b._changeValue(e,f)})},updateSelectBoxPosition:function(){var b=this,d=this.options;if(d.absolute){b.selectBox.css({left:b.wrapper.offset().left,top:b.wrapper.offset().top+1+b.wrapper.outerHeight()})}else{var e=b.wrapper.offset().top-a(window).scrollTop();var c=b.selectBox.height()+textHeight+4;if(e+c>a(window).height()&&e>c){b.selectBox.css("marginTop",-1*(b.selectBox.height()+textHeight+5))}}},_toggleSelectBox:function(c){var d=this,e=this.options;var f=d.wrapper.height();d.boxToggling=true;if(c){if(e.slide){d.selectBox.slideToggle("fast",function(){d.boxToggling=false})}else{d.selectBox.hide();d.boxToggling=false}}else{d.updateSelectBoxPosition();if(e.slide){d.selectBox.slideToggle("fast",function(){d.boxToggling=false;if(!e.isShowCheckBox&&a("td.l-selected",d.selectBox).length>0){var h=(a("td.l-selected",d.selectBox).offset().top-d.selectBox.offset().top);a(".l-box-select-inner",d.selectBox).animate({scrollTop:h})}})}else{d.selectBox.show();d.boxToggling=false;if(!d.tree&&!d.grid&&!e.isShowCheckBox&&a("td.l-selected",d.selectBox).length>0){var b=(a("td.l-selected",d.selectBox).offset().top-d.selectBox.offset().top);a(".l-box-select-inner",d.selectBox).animate({scrollTop:b})}if(d.selectBox.offset().left+d.selectBox.width()>document.body.clientWidth){d.selectBox.css("left",document.body.clientWidth-d.selectBox.width()-20)}}}d.isShowed=d.selectBox.is(":visible");d.trigger("toggle",[c]);d.trigger(c?"hide":"show")}});a.jui.controls.ComboBox.prototype.setValue=a.jui.controls.ComboBox.prototype.selectValue;a.jui.controls.ComboBox.prototype.setInputValue=a.jui.controls.ComboBox.prototype._changeValue})(jQuery);(function(a){a.fn.juiceTextBox=function(){return a.jui.run.call(this,"juiceTextBox",arguments)};a.fn.juiceGetTextBoxManager=function(){return a.jui.run.call(this,"juiceGetTextBoxManager",arguments)};a.juiceDefaults.TextBox={onChangeValue:null,width:null,disabled:false,value:null,nullText:null,digits:false,number:false};a.jui.controls.TextBox=function(c,b){a.jui.controls.TextBox.base.constructor.call(this,c,b)};a.jui.controls.TextBox.juiceExtend(a.jui.controls.Input,{__getType:function(){return"TextBox"},__idPrev:function(){return"TextBox"},_init:function(){a.jui.controls.TextBox.base._init.call(this);var b=this,c=this.options;if(!c.width){c.width=a(b.element).width()}if(a(this.element).attr("readonly")){c.disabled=true}},_render:function(){var b=this,c=this.options;b.inputText=a(this.element);b.wrapper=b.inputText.wrap('<div class="l-text"></div>').parent();b.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>');if(!b.inputText.hasClass("l-text-field")){b.inputText.addClass("l-text-field")}this._setEvent();b.set(c);b.checkValue()},_getValue:function(){return this.inputText.val()},_setNullText:function(){this.checkNotNull()},checkValue:function(){var c=this,d=this.options;var b=c.inputText.val();if(d.number&&!/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(b)||d.digits&&!/^\d+$/.test(b)){c.inputText.val(c.value||0);return}c.value=b},checkNotNull:function(){var b=this,c=this.options;if(c.nullText&&!c.disabled){if(!b.inputText.val()){b.inputText.addClass("l-text-field-null").val(c.nullText)}}},_setEvent:function(){var b=this,c=this.options;b.inputText.bind("blur.textBox",function(){b.trigger("blur");b.checkNotNull();b.checkValue();b.wrapper.removeClass("l-text-focus")}).bind("focus.textBox",function(){b.trigger("focus");if(c.nullText){if(a(this).hasClass("l-text-field-null")){a(this).removeClass("l-text-field-null").val("")}}b.wrapper.addClass("l-text-focus")}).change(function(){b.trigger("changeValue",[this.value])});b.wrapper.hover(function(){b.trigger("mouseOver");b.wrapper.addClass("l-text-over")},function(){b.trigger("mouseOut");b.wrapper.removeClass("l-text-over")})},_setDisabled:function(b){if(b){this.inputText.attr("readonly","readonly");this.wrapper.addClass("l-text-disabled")}else{this.inputText.removeAttr("readonly");this.wrapper.removeClass("l-text-disabled")}},_setWidth:function(b){if(b>20){this.wrapper.css({width:b});this.inputText.css({width:b-4})}},_setHeight:function(b){if(b>10){this.wrapper.height(b);this.inputText.height(b-2)}},_setValue:function(b){if(b!=null){this.inputText.val(b)}},_setLabel:function(d){var c=this,e=this.options;if(!c.labelwrapper){c.labelwrapper=c.wrapper.wrap('<div class="l-labeltext"></div>').parent();var b=a('<div class="l-text-label" style="float:left;">'+d+":&nbsp</div>");c.labelwrapper.prepend(b);c.wrapper.css("float","left");if(!e.labelWidth){e.labelWidth=b.width()}else{c._setLabelWidth(e.labelWidth)}b.height(c.wrapper.height());if(e.labelAlign){c._setLabelAlign(e.labelAlign)}c.labelwrapper.append('<br style="clear:both;" />');c.labelwrapper.width(e.labelWidth+e.width+2)}else{c.labelwrapper.find(".l-text-label").html(d+":&nbsp")}},_setLabelWidth:function(c){var b=this,d=this.options;if(!b.labelwrapper){return}b.labelwrapper.find(".l-text-label").width(c)},_setLabelAlign:function(c){var b=this,d=this.options;if(!b.labelwrapper){return}b.labelwrapper.find(".l-text-label").css("text-align",c)},updateStyle:function(){var b=this,c=this.options;if(b.inputText.attr("disabled")||b.inputText.attr("readonly")){b.wrapper.addClass("l-text-disabled");b.options.disabled=true}else{b.wrapper.removeClass("l-text-disabled");b.options.disabled=false}if(b.inputText.hasClass("l-text-field-null")&&b.inputText.val()!=c.nullText){b.inputText.removeClass("l-text-field-null")}b.checkValue()}})})(jQuery);(function(a){a.fn.juiceRadio=function(){return a.jui.run.call(this,"juiceRadio",arguments)};a.fn.juiceGetRadioManager=function(){return a.jui.run.call(this,"juiceGetRadioManager",arguments)};a.juiceDefaults.Radio={disabled:false};a.juiceMethos.Radio={};a.jui.controls.Radio=function(c,b){a.jui.controls.Radio.base.constructor.call(this,c,b)};a.jui.controls.Radio.juiceExtend(a.jui.controls.Input,{__getType:function(){return"Radio"},__idPrev:function(){return"Radio"},_extendMethods:function(){return a.juiceMethos.Radio},_render:function(){var b=this,c=this.options;b.input=a(this.element);b.link=a('<a href="javascript:void(0)" class="l-radio"></a>');b.wrapper=b.input.addClass("l-hidden").wrap('<div class="l-radio-wrapper"></div>').parent();b.wrapper.prepend(b.link);b.input.change(function(){if(this.checked){b.link.addClass("l-radio-checked")}else{b.link.removeClass("l-radio-checked")}return true});b.link.click(function(){b._doclick()});b.wrapper.hover(function(){if(!c.disabled){a(this).addClass("l-over")}},function(){a(this).removeClass("l-over")});this.element.checked&&b.link.addClass("l-radio-checked");if(this.element.id){a("label[for="+this.element.id+"]").click(function(){b._doclick()})}b.set(c)},setValue:function(c){var b=this,d=this.options;if(!c){b.input[0].checked=false;b.link.removeClass("l-radio-checked")}else{b.input[0].checked=true;b.link.addClass("l-radio-checked")}},getValue:function(){return this.input[0].checked},setEnabled:function(){this.input.attr("disabled",false);this.wrapper.removeClass("l-disabled");this.options.disabled=false},setDisabled:function(){this.input.attr("disabled",true);this.wrapper.addClass("l-disabled");this.options.disabled=true},updateStyle:function(){if(this.input.attr("disabled")){this.wrapper.addClass("l-disabled");this.options.disabled=true}if(this.input[0].checked){this.link.addClass("l-checkbox-checked")}else{this.link.removeClass("l-checkbox-checked")}},_doclick:function(){var c=this,d=this.options;if(c.input.attr("disabled")){return false}c.input.trigger("click").trigger("change");var b;if(c.input[0].form){b=c.input[0].form}else{b=document}a("input:radio[name="+c.input[0].name+"]",b).not(c.input).trigger("change");return false}})})(jQuery);(function(a){a.fn.juiceDateEditor=function(){return a.jui.run.call(this,"juiceDateEditor",arguments)};a.fn.juiceGetDateEditorManager=function(){return a.jui.run.call(this,"juiceGetDateEditorManager",arguments)};a.juiceDefaults.DateEditor={format:"yyyy-MM-dd hh:mm",showTime:false,onChangeDate:false,absolute:true};a.juiceDefaults.DateEditorString={dayMessage:["日","一","二","三","四","五","六"],monthMessage:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],todayMessage:"今天",clearMessage:"清空",closeMessage:"关闭"};a.juiceMethos.DateEditor={};a.jui.controls.DateEditor=function(c,b){a.jui.controls.DateEditor.base.constructor.call(this,c,b)};a.jui.controls.DateEditor.juiceExtend(a.jui.controls.Input,{__getType:function(){return"DateEditor"},__idPrev:function(){return"DateEditor"},_extendMethods:function(){return a.juiceMethos.DateEditor},_render:function(){var d=this,e=this.options;if(!e.showTime&&e.format.indexOf(" hh:mm")>-1){e.format=e.format.replace(" hh:mm","")}if(this.element.tagName.toLowerCase()!="input"||this.element.type!="text"){return}d.inputText=a(this.element);if(!d.inputText.hasClass("l-text-field")){d.inputText.addClass("l-text-field")}d.link=a('<div class="l-trigger"><div class="l-trigger-icon"></div></div>');d.text=d.inputText.wrap('<div class="l-text l-text-date"></div>').parent();d.text.append('<div class="l-text-l"></div><div class="l-text-r"></div>');d.text.append(d.link);d.textwrapper=d.text.wrap('<div class="l-text-wrapper"></div>').parent();var c="";c+="<div class='l-box-dateeditor' style='display:none'>";c+="    <div class='l-box-dateeditor-header'>";c+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-prevyear'><span></span></div>";c+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-prevmonth'><span></span></div>";c+="        <div class='l-box-dateeditor-header-text'><a class='l-box-dateeditor-header-month'></a> , <a  class='l-box-dateeditor-header-year'></a></div>";c+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-nextmonth'><span></span></div>";c+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-nextyear'><span></span></div>";c+="    </div>";c+="    <div class='l-box-dateeditor-body'>";c+="        <table cellpadding='0' cellspacing='0' border='0' class='l-box-dateeditor-calendar'>";c+="            <thead>";c+="                <tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr>";c+="            </thead>";c+="            <tbody>";c+="                <tr class='l-first'><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr>";c+="            </tbody>";c+="        </table>";c+="        <ul class='l-box-dateeditor-monthselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>";c+="        <ul class='l-box-dateeditor-yearselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>";c+="        <ul class='l-box-dateeditor-hourselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>";c+="        <ul class='l-box-dateeditor-minuteselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>";c+="    </div>";c+="    <div class='l-box-dateeditor-toolbar'>";c+="        <div class='l-box-dateeditor-time'></div>";c+="        <div class='l-button l-button-close'></div>";c+="        <div class='l-button l-button-clear'></div>";c+="        <div class='l-button l-button-today'></div>";c+="        <div class='l-clear'></div>";c+="    </div>";c+="</div>";d.dateeditor=a(c);if(e.absolute){d.dateeditor.appendTo("body").addClass("l-box-dateeditor-absolute")}else{d.textwrapper.append(d.dateeditor)}d.header=a(".l-box-dateeditor-header",d.dateeditor);d.body=a(".l-box-dateeditor-body",d.dateeditor);d.toolbar=a(".l-box-dateeditor-toolbar",d.dateeditor);d.body.thead=a("thead",d.body);d.body.tbody=a("tbody",d.body);d.body.monthselector=a(".l-box-dateeditor-monthselector",d.body);d.body.yearselector=a(".l-box-dateeditor-yearselector",d.body);d.body.hourselector=a(".l-box-dateeditor-hourselector",d.body);d.body.minuteselector=a(".l-box-dateeditor-minuteselector",d.body);d.toolbar.time=a(".l-box-dateeditor-time",d.toolbar);d.toolbar.time.hour=a("<a></a>");d.toolbar.time.minute=a("<a></a>");d.buttons={btnPrevYear:a(".l-box-dateeditor-header-prevyear",d.header),btnNextYear:a(".l-box-dateeditor-header-nextyear",d.header),btnPrevMonth:a(".l-box-dateeditor-header-prevmonth",d.header),btnNextMonth:a(".l-box-dateeditor-header-nextmonth",d.header),btnYear:a(".l-box-dateeditor-header-year",d.header),btnMonth:a(".l-box-dateeditor-header-month",d.header),btnToday:a(".l-button-today",d.toolbar),btnClear:a(".l-button-clear",d.toolbar),btnClose:a(".l-button-close",d.toolbar)};var b=new Date();d.now={year:b.getFullYear(),month:b.getMonth()+1,day:b.getDay(),date:b.getDate(),hour:b.getHours(),minute:b.getMinutes()};d.currentDate={year:b.getFullYear(),month:b.getMonth()+1,day:b.getDay(),date:b.getDate(),hour:b.getHours(),minute:b.getMinutes()};d.selectedDate=null;d.usedDate=null;a("td",d.body.thead).each(function(f,h){a(h).html(e.dayMessage[f])});a("li",d.body.monthselector).each(function(h,f){a(f).html(e.monthMessage[h])});d.buttons.btnToday.html(e.todayMessage);d.buttons.btnClear.html(e.clearMessage);d.buttons.btnClose.html(e.closeMessage);if(e.showTime){d.toolbar.time.show();d.toolbar.time.append(d.toolbar.time.hour).append(":").append(d.toolbar.time.minute);a("li",d.body.hourselector).each(function(f,h){var j=f;if(f<10){j="0"+f.toString()}a(this).html(j)});a("li",d.body.minuteselector).each(function(f,h){var j=f;if(f<10){j="0"+f.toString()}a(this).html(j)})}d.bulidContent();if(d.inputText.val()!=""){d.onTextChange()}d.dateeditor.hover(null,function(f){if(d.dateeditor.is(":visible")&&!d.editorToggling){d.toggleDateEditor(true)}});d.link.hover(function(){if(e.disabled){return}this.className="l-trigger-hover"},function(){if(e.disabled){return}this.className="l-trigger"}).mousedown(function(){if(e.disabled){return}this.className="l-trigger-pressed"}).mouseup(function(){if(e.disabled){return}this.className="l-trigger-hover"}).click(function(){if(e.disabled){return}d.bulidContent();d.toggleDateEditor(d.dateeditor.is(":visible"))});if(e.disabled){d.inputText.attr("readonly","readonly");d.text.addClass("l-text-disabled")}if(e.initValue){d.inputText.val(e.initValue)}d.buttons.btnClose.click(function(){d.toggleDateEditor(true)});d.buttons.btnClear.click(function(){d.inputText.val("");d.toggleDateEditor(true)});a(document).click(function(h){var f=a(h.target).parents().add(h.target);if(a.inArray(d.dateeditor[0],f)==-1&&a.inArray(d.link[0],f)==-1){d.toggleDateEditor(true)}});a("td",d.body.tbody).hover(function(){if(a(this).hasClass("l-box-dateeditor-today")){return}a(this).addClass("l-box-dateeditor-over")},function(){a(this).removeClass("l-box-dateeditor-over")}).click(function(){a(".l-box-dateeditor-selected",d.body.tbody).removeClass("l-box-dateeditor-selected");if(!a(this).hasClass("l-box-dateeditor-today")){a(this).addClass("l-box-dateeditor-selected")}d.currentDate.date=parseInt(a(this).html());d.currentDate.day=new Date(d.currentDate.year,d.currentDate.month-1,1).getDay();if(a(this).hasClass("l-box-dateeditor-out")){if(a("tr",d.body.tbody).index(a(this).parent())==0){if(--d.currentDate.month==0){d.currentDate.month=12;d.currentDate.year--}}else{if(++d.currentDate.month==13){d.currentDate.month=1;d.currentDate.year++}}}d.selectedDate={year:d.currentDate.year,month:d.currentDate.month,date:d.currentDate.date};d.showDate();d.editorToggling=true;d.dateeditor.slideToggle("fast",function(){d.editorToggling=false})});a(".l-box-dateeditor-header-btn",d.header).hover(function(){a(this).addClass("l-box-dateeditor-header-btn-over")},function(){a(this).removeClass("l-box-dateeditor-header-btn-over")});d.buttons.btnYear.click(function(){if(!d.body.yearselector.is(":visible")){a("li",d.body.yearselector).each(function(h,j){var f=d.currentDate.year+(h-4);if(f==d.currentDate.year){a(this).addClass("l-selected")}else{a(this).removeClass("l-selected")}a(this).html(f)})}d.body.yearselector.slideToggle()});d.body.yearselector.hover(function(){},function(){a(this).slideUp()});a("li",d.body.yearselector).click(function(){d.currentDate.year=parseInt(a(this).html());d.body.yearselector.slideToggle();d.bulidContent()});d.buttons.btnMonth.click(function(){a("li",d.body.monthselector).each(function(f,h){if(d.currentDate.month==f+1){a(this).addClass("l-selected")}else{a(this).removeClass("l-selected")}});d.body.monthselector.slideToggle()});d.body.monthselector.hover(function(){},function(){a(this).slideUp("fast")});a("li",d.body.monthselector).click(function(){var f=a("li",d.body.monthselector).index(this);d.currentDate.month=f+1;d.body.monthselector.slideToggle();d.bulidContent()});d.toolbar.time.hour.click(function(){a("li",d.body.hourselector).each(function(f,h){if(d.currentDate.hour==f){a(this).addClass("l-selected")}else{a(this).removeClass("l-selected")}});d.body.hourselector.slideToggle()});d.body.hourselector.hover(function(){},function(){a(this).slideUp("fast")});a("li",d.body.hourselector).click(function(){var f=a("li",d.body.hourselector).index(this);d.currentDate.hour=f;d.body.hourselector.slideToggle();d.bulidContent()});d.toolbar.time.minute.click(function(){a("li",d.body.minuteselector).each(function(f,h){if(d.currentDate.minute==f){a(this).addClass("l-selected")}else{a(this).removeClass("l-selected")}});d.body.minuteselector.slideToggle("fast",function(){var f=a("li",this).index(a("li.l-selected",this));if(f>29){var h=(a("li.l-selected",this).offset().top-a(this).offset().top);a(this).animate({scrollTop:h})}})});d.body.minuteselector.hover(function(){},function(){a(this).slideUp("fast")});a("li",d.body.minuteselector).click(function(){var f=a("li",d.body.minuteselector).index(this);d.currentDate.minute=f;d.body.minuteselector.slideToggle("fast");d.bulidContent()});d.buttons.btnPrevMonth.click(function(){if(--d.currentDate.month==0){d.currentDate.month=12;d.currentDate.year--}d.bulidContent()});d.buttons.btnNextMonth.click(function(){if(++d.currentDate.month==13){d.currentDate.month=1;d.currentDate.year++}d.bulidContent()});d.buttons.btnPrevYear.click(function(){d.currentDate.year--;d.bulidContent()});d.buttons.btnNextYear.click(function(){d.currentDate.year++;d.bulidContent()});d.buttons.btnToday.click(function(){d.currentDate={year:d.now.year,month:d.now.month,day:d.now.day,date:d.now.date};d.selectedDate={year:d.now.year,month:d.now.month,day:d.now.day,date:d.now.date};d.showDate();d.dateeditor.slideToggle("fast")});d.inputText.change(function(){d.onTextChange()}).blur(function(){d.text.removeClass("l-text-focus")}).focus(function(){d.text.addClass("l-text-focus")});d.text.hover(function(){d.text.addClass("l-text-over")},function(){d.text.removeClass("l-text-over")});if(e.label){d.labelwrapper=d.textwrapper.wrap('<div class="l-labeltext"></div>').parent();d.labelwrapper.prepend('<div class="l-text-label" style="float:left;display:inline;"><p style="padding-top:4px;">'+e.label+":&nbsp;</p></div>");d.textwrapper.css("float","left");if(!e.labelWidth){e.labelWidth=a(".l-text-label",d.labelwrapper).outerWidth()}else{a(".l-text-label",d.labelwrapper).outerWidth(e.labelWidth)}a(".l-text-label",d.labelwrapper).width(e.labelWidth);a(".l-text-label",d.labelwrapper).height(d.text.height());d.labelwrapper.append('<br style="clear:both;" />');if(e.labelAlign){a(".l-text-label",d.labelwrapper).css("text-align",e.labelAlign)}d.textwrapper.css({display:"inline"});d.labelwrapper.width(d.text.outerWidth()+e.labelWidth+2)}d.set(e)},destroy:function(){if(this.textwrapper){this.textwrapper.remove()}if(this.dateeditor){this.dateeditor.remove()}this.options=null;a.jui.remove(this)},bulidContent:function(){var e=this,f=this.options;var c=new Date(e.currentDate.year,e.currentDate.month-1,1).getDay();var b=e.currentDate.month;var j=e.currentDate.year;if(++b==13){b=1;j++}var h=new Date(j,b-1,0).getDate();var d=new Date(e.currentDate.year,e.currentDate.month-1,0).getDate();e.buttons.btnMonth.html(f.monthMessage[e.currentDate.month-1]);e.buttons.btnYear.html(e.currentDate.year);e.toolbar.time.hour.html(e.currentDate.hour);e.toolbar.time.minute.html(e.currentDate.minute);if(e.toolbar.time.hour.html().length==1){e.toolbar.time.hour.html("0"+e.toolbar.time.hour.html())}if(e.toolbar.time.minute.html().length==1){e.toolbar.time.minute.html("0"+e.toolbar.time.minute.html())}a("td",this.body.tbody).each(function(){this.className=""});a("tr",this.body.tbody).each(function(k,l){a("td",l).each(function(n,q){var o=k*7+(n-c);var m=o+1;if(e.selectedDate&&e.currentDate.year==e.selectedDate.year&&e.currentDate.month==e.selectedDate.month&&o+1==e.selectedDate.date){if(n==0||n==6){a(q).addClass("l-box-dateeditor-holiday")}a(q).addClass("l-box-dateeditor-selected");a(q).siblings().removeClass("l-box-dateeditor-selected")}else{if(e.currentDate.year==e.now.year&&e.currentDate.month==e.now.month&&o+1==e.now.date){if(n==0||n==6){a(q).addClass("l-box-dateeditor-holiday")}a(q).addClass("l-box-dateeditor-today")}else{if(o<0){m=d+m;a(q).addClass("l-box-dateeditor-out").removeClass("l-box-dateeditor-selected")}else{if(o>h-1){m=m-h;a(q).addClass("l-box-dateeditor-out").removeClass("l-box-dateeditor-selected")}else{if(n==0||n==6){a(q).addClass("l-box-dateeditor-holiday").removeClass("l-box-dateeditor-selected")}else{q.className=""}}}}}a(q).html(m)})})},updateSelectBoxPosition:function(){var b=this,c=this.options;if(c.absolute){b.dateeditor.css({left:b.text.offset().left,top:b.text.offset().top+1+b.text.outerHeight()})}else{if(b.text.offset().top+4>b.dateeditor.height()&&b.text.offset().top+b.dateeditor.height()+textHeight+4-a(window).scrollTop()>a(window).height()){b.dateeditor.css("marginTop",-1*(b.dateeditor.height()+textHeight+5));b.showOnTop=true}else{b.showOnTop=false}}},toggleDateEditor:function(b){var c=this,d=this.options;var e=c.text.height();c.editorToggling=true;if(b){c.dateeditor.hide("fast",function(){c.editorToggling=false})}else{c.updateSelectBoxPosition();c.dateeditor.slideDown("fast",function(){c.editorToggling=false})}},showDate:function(){var c=this,d=this.options;if(!this.selectedDate){return}var b=c.selectedDate.year+"/"+c.selectedDate.month+"/"+c.selectedDate.date;this.currentDate.hour=parseInt(c.toolbar.time.hour.html(),10);this.currentDate.minute=parseInt(c.toolbar.time.minute.html(),10);if(d.showTime){b+=" "+this.currentDate.hour+":"+this.currentDate.minute}this.inputText.val(b);this.inputText.trigger("change").focus()},isDateTime:function(b){var e=this,f=this.options;var c=b.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/);if(c==null){return false}var h=new Date(c[1],c[3]-1,c[4]);if(h=="NaN"){return false}return(h.getFullYear()==c[1]&&(h.getMonth()+1)==c[3]&&h.getDate()==c[4])},isLongDateTime:function(b){var f=this,h=this.options;var c=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2})$/;var e=b.match(c);if(e==null){return false}var j=new Date(e[1],e[3]-1,e[4],e[5],e[6]);if(j=="NaN"){return false}return(j.getFullYear()==e[1]&&(j.getMonth()+1)==e[3]&&j.getDate()==e[4]&&j.getHours()==e[5]&&j.getMinutes()==e[6])},getFormatDate:function(c){var d=this,f=this.options;if(c=="NaN"){return null}var e=f.format;var h={"M+":c.getMonth()+1,"d+":c.getDate(),"h+":c.getHours(),"m+":c.getMinutes(),"s+":c.getSeconds(),"q+":Math.floor((c.getMonth()+3)/3),S:c.getMilliseconds()};if(/(y+)/.test(e)){e=e.replace(RegExp.$1,(c.getFullYear()+"").substr(4-RegExp.$1.length))}for(var b in h){if(new RegExp("("+b+")").test(e)){e=e.replace(RegExp.$1,RegExp.$1.length==1?h[b]:("00"+h[b]).substr((""+h[b]).length))}}return e},onTextChange:function(){var c=this,d=this.options;var e=c.inputText.val();if(e==""){c.selectedDate=null;return true}if(!d.showTime&&!c.isDateTime(e)){if(!c.usedDate){c.inputText.val("")}else{c.inputText.val(c.getFormatDate(c.usedDate))}}else{if(d.showTime&&!c.isLongDateTime(e)){if(!c.usedDate){c.inputText.val("")}else{c.inputText.val(c.getFormatDate(c.usedDate))}}else{e=e.replace(/-/g,"/");var b=c.getFormatDate(new Date(e));if(b==null){if(!c.usedDate){c.inputText.val("")}else{c.inputText.val(c.getFormatDate(c.usedDate))}}c.usedDate=new Date(e);c.selectedDate={year:c.usedDate.getFullYear(),month:c.usedDate.getMonth()+1,day:c.usedDate.getDay(),date:c.usedDate.getDate(),hour:c.usedDate.getHours(),minute:c.usedDate.getMinutes()};c.currentDate={year:c.usedDate.getFullYear(),month:c.usedDate.getMonth()+1,day:c.usedDate.getDay(),date:c.usedDate.getDate(),hour:c.usedDate.getHours(),minute:c.usedDate.getMinutes()};c.inputText.val(b);c.trigger("changeDate",[b]);if(a(c.dateeditor).is(":visible")){c.bulidContent()}}}},_setHeight:function(c){var b=this;if(c>4){b.text.css({height:c});b.inputText.css({height:c});b.textwrapper.css({height:c})}},_setWidth:function(c){var b=this;if(c>20){b.text.css({width:c});b.inputText.css({width:c-20});b.textwrapper.css({width:c})}},_setValue:function(c){var b=this;if(!c){b.inputText.val("")}if(typeof c=="string"){b.inputText.val(c)}else{if(typeof c=="object"){if(c instanceof Date){b.inputText.val(b.getFormatDate(c));b.onTextChange()}}}},_getValue:function(){return this.usedDate},setEnabled:function(){var b=this,c=this.options;this.inputText.removeAttr("readonly");this.text.removeClass("l-text-disabled");c.disabled=false},setDisabled:function(){var b=this,c=this.options;this.inputText.attr("readonly","readonly");this.text.addClass("l-text-disabled");c.disabled=true}})})(jQuery);(function(b){var a=b.jui;b(".l-dialog-btn").live("mouseover",function(){b(this).addClass("l-dialog-btn-over")}).live("mouseout",function(){b(this).removeClass("l-dialog-btn-over")});b(".l-dialog-tc .l-dialog-close").live("mouseover",function(){b(this).addClass("l-dialog-close-over")}).live("mouseout",function(){b(this).removeClass("l-dialog-close-over")});b.juiceDialog=function(){return a.run.call(null,"juiceDialog",arguments,{isStatic:true})};b.jui.DialogImagePath="../../js/jui/skins/Aqua/images/win/";function c(e){for(var d in e){b("<img />").attr("src",a.DialogImagePath+e[d])}}b.juiceDefaults.Dialog={cls:null,id:null,buttons:null,buttonAlign:"right",isDrag:true,width:360,height:80,content:"",target:null,url:null,load:false,onLoaded:null,type:"none",left:0,top:0,modal:true,name:null,isResize:false,allowClose:true,opener:null,timeParmName:null,closeWhenEnter:false,isHidden:true,show:true,title:"提示",showMax:false,showToggle:false,showMin:false,slide:b.browser.msie?false:true,fixedType:null,showType:null,valign:"middle"};b.juiceDefaults.DialogString={titleMessage:"提示",ok:"确定",yes:"是",no:"否",cancel:"取消",waittingMessage:"正在等待中,请稍候..."};b.juiceMethos.Dialog=b.juiceMethos.Dialog||{};a.controls.Dialog=function(d){a.controls.Dialog.base.constructor.call(this,null,d)};a.controls.Dialog.juiceExtend(a.core.Win,{__getType:function(){return"Dialog"},__idPrev:function(){return"Dialog"},_extendMethods:function(){return b.juiceMethos.Dialog},_render:function(){var j=this,m=this.options;j.set(m,true);var e=b('<div class="l-dialog"><table class="l-dialog-table" cellpadding="0" cellspacing="0" border="0"><tbody><tr><td class="l-dialog-tl"></td><td class="l-dialog-tc"><div class="l-dialog-tc-inner"><div class="l-dialog-icon"></div><div class="l-dialog-title"></div><div class="l-dialog-winbtns"><div class="l-dialog-winbtn l-dialog-close"></div></div></div></td><td class="l-dialog-tr"></td></tr><tr><td class="l-dialog-cl"></td><td class="l-dialog-cc"><div class="l-dialog-body"><div class="l-dialog-image"></div> <div class="l-dialog-content"></div><div class="l-dialog-buttons"><div class="l-dialog-buttons-inner"></div></td><td class="l-dialog-cr"></td></tr><tr><td class="l-dialog-bl"></td><td class="l-dialog-bc"></td><td class="l-dialog-br"></td></tr></tbody></table></div>');b("body").append(e);j.dialog=e;j.element=e[0];j.dialog.body=b(".l-dialog-body:first",j.dialog);j.dialog.header=b(".l-dialog-tc-inner:first",j.dialog);j.dialog.winbtns=b(".l-dialog-winbtns:first",j.dialog.header);j.dialog.buttons=b(".l-dialog-buttons:first",j.dialog);j.dialog.content=b(".l-dialog-content:first",j.dialog);j.set(m,false);if(m.allowClose==false){b(".l-dialog-close",j.dialog).remove()}if(m.target||m.url||m.type=="none"){m.type=null;j.dialog.addClass("l-dialog-win")}if(m.cls){j.dialog.addClass(m.cls)}if(m.id){j.dialog.attr("id",m.id)}j.mask();if(m.isDrag){j._applyDrag()}if(m.isResize){j._applyResize()}if(m.type){j._setImage()}else{b(".l-dialog-image",j.dialog).remove();j.dialog.content.addClass("l-dialog-content-noimage")}if(!m.show){j.unmask();j.dialog.hide()}if(m.target){j.dialog.content.prepend(m.target);b(m.target).show()}else{if(m.url){if(m.timeParmName){m.url+=m.url.indexOf("?")==-1?"?":"&";m.url+=m.timeParmName+"="+new Date().getTime()}if(m.load){j.dialog.body.load(m.url,function(){j._saveStatus();j.trigger("loaded")})}else{j.jiframe=b("<iframe frameborder='0' style='overflow: hidden;height: 99.8%'></iframe>");var d=m.name?m.name:"juicewindow"+new Date().getTime();j.dialog.content.css("overflow","hidden");j.jiframe.attr("name",d);j.jiframe.attr("id",d);j.dialog.content.prepend(j.jiframe);j.dialog.content.addClass("l-dialog-content-nopadding");setTimeout(function(){j.jiframe.attr("src",m.url);j.frame=window.frames[j.jiframe.attr("name")]},0)}}}if(m.opener){j.dialog.opener=m.opener}if(m.buttons){var h=0;b(m.buttons).each(function(o,q){var n=b('<div class="l-dialog-btn"><div class="l-dialog-btn-l"></div><div class="l-dialog-btn-r"></div><div class="l-dialog-btn-inner"></div></div>');b(".l-dialog-btn-inner",n).html(q.text);b(".l-dialog-buttons-inner",j.dialog.buttons).prepend(n);q.width&&n.width(q.width);h+=n.width();if(m.buttonAlign=="center"){if(o==(m.buttons.length-1)){h+=(m.buttons.length-1)*5;n.css({"margin-right":(j.dialog.body.width()-h)/2})}}q.onclick&&n.click(function(){q.onclick(q,j,o)})})}else{j.dialog.buttons.remove()}b(".l-dialog-buttons-inner",j.dialog.buttons).append("<div class='l-clear'></div>");b(".l-dialog-title",j.dialog).bind("selectstart",function(){return false});j.dialog.click(function(){a.win.setFront(j)});b(".l-dialog-tc .l-dialog-close",j.dialog).click(function(){if(m.isHidden){j.hide()}else{j.close()}});if(!m.fixedType){var l=0;var k=0;var f=m.width||j.dialog.width();if(m.slide==true){m.slide="fast"}if(m.left){l=m.left}else{m.left=l=0.5*(b(window).width()-f)}if(m.top!=null){k=m.top}else{m.top=k=0.5*(b(window).height()-j.dialog.height())+b(window).scrollTop()-10}if(l<0){m.left=l=0}if(k<0){m.top=k=0}j.dialog.css({left:l,top:k})}if(m.valign){var k=0;if(m.valign=="top"){k=0}else{if(m.valign=="bottom"){k=(b(window).height()-j.dialog.height())}else{k=(b(window).height()-j.dialog.height())/2}}j.dialog.css({top:k})}j.show();b("body").bind("keydown.dialog",function(o){var n=o.which;if(n==13){j.enter()}else{if(n==27){j.esc()}}});j._updateBtnsWidth();j._saveStatus();j._onReisze()},_borderX:12,_borderY:32,doMax:function(e){var h=this,l=this.options;var f=b(window).width(),d=b(window).height(),k=0,j=0;if(a.win.taskbar){d-=a.win.taskbar.outerHeight();if(a.win.top){j+=a.win.taskbar.outerHeight()}}if(e){h.dialog.body.animate({width:f-h._borderX},l.slide);h.dialog.animate({left:k,top:j},l.slide);h.dialog.content.animate({height:d-h._borderY-h.dialog.buttons.outerHeight()},l.slide,function(){h._onReisze()})}else{h.set({width:f,height:d,left:k,top:j});h._onReisze()}},max:function(){var d=this,e=this.options;if(d.winmax){d.winmax.addClass("l-dialog-recover");d.doMax(e.slide);if(d.wintoggle){if(d.wintoggle.hasClass("l-dialog-extend")){d.wintoggle.addClass("l-dialog-toggle-disabled l-dialog-extend-disabled")}else{d.wintoggle.addClass("l-dialog-toggle-disabled l-dialog-collapse-disabled")}}if(d.resizable){d.resizable.set({disabled:true})}if(d.draggable){d.draggable.set({disabled:true})}d.maximum=true;b(window).bind("resize.dialogmax",function(){d.doMax(false)})}},recover:function(){var d=this,e=this.options;if(d.winmax){d.winmax.removeClass("l-dialog-recover");if(e.slide){d.dialog.body.animate({width:d._width-d._borderX},e.slide);d.dialog.animate({left:d._left,top:d._top},e.slide);d.dialog.content.animate({height:d._height-d._borderY-d.dialog.buttons.outerHeight()},e.slide,function(){d._onReisze()})}else{d.set({width:d._width,height:d._height,left:d._left,top:d._top});d._onReisze()}if(d.wintoggle){d.wintoggle.removeClass("l-dialog-toggle-disabled l-dialog-extend-disabled l-dialog-collapse-disabled")}b(window).unbind("resize.dialogmax")}if(this.resizable){this.resizable.set({disabled:false})}if(d.draggable){d.draggable.set({disabled:false})}d.maximum=false},min:function(){var e=this,f=this.options;var d=a.win.getTask(this);if(f.slide){e.dialog.body.animate({width:1},f.slide);d.y=d.offset().top+d.height();d.x=d.offset().left+d.width()/2;e.dialog.animate({left:d.x,top:d.y},f.slide,function(){e.dialog.hide()})}else{e.dialog.hide()}e.unmask();e.minimize=true;e.actived=false},active:function(){var f=this,k=this.options;if(f.minimize){var e=f._width,d=f._height,j=f._left,h=f._top;if(f.maximum){e=b(window).width();d=b(window).height();j=h=0;if(a.win.taskbar){d-=a.win.taskbar.outerHeight();if(a.win.top){h+=a.win.taskbar.outerHeight()}}}if(k.slide){f.dialog.body.animate({width:e-f._borderX},k.slide);f.dialog.animate({left:j,top:h},k.slide)}else{f.set({width:e,height:d,left:j,top:h})}}f.actived=true;f.minimize=false;a.win.setFront(f);f.show()},toggle:function(){var d=this,e=this.options;if(!d.wintoggle){return}if(d.wintoggle.hasClass("l-dialog-extend")){d.extend()}else{d.collapse()}},collapse:function(){var d=this,e=this.options;if(!d.wintoggle){return}if(e.slide){d.dialog.content.animate({height:1},e.slide)}else{d.dialog.content.height(1)}if(this.resizable){this.resizable.set({disabled:true})}},extend:function(){var e=this,f=this.options;if(!e.wintoggle){return}var d=e._height-e._borderY-e.dialog.buttons.outerHeight();if(f.slide){e.dialog.content.animate({height:d},f.slide)}else{e.dialog.content.height(d)}if(this.resizable){this.resizable.set({disabled:false})}},_updateBtnsWidth:function(){var e=this;var d=b(">div",e.dialog.winbtns).length;e.dialog.winbtns.width(22*d)},_setLeft:function(d){if(!this.dialog){return}if(d!=null){this.dialog.css({left:d})}},_setTop:function(d){if(!this.dialog){return}if(d!=null){this.dialog.css({top:d})}},_setWidth:function(d){if(!this.dialog){return}if(d>=this._borderX){this.dialog.body.width(d-this._borderX)}},_setHeight:function(f){var e=this,h=this.options;if(!this.dialog){return}if(f>=this._borderY){var d=f-this._borderY-e.dialog.buttons.outerHeight();e.dialog.content.height(d)}},_setShowMax:function(e){var d=this,f=this.options;if(e){if(!d.winmax){d.winmax=b('<div class="l-dialog-winbtn l-dialog-max"></div>').appendTo(d.dialog.winbtns).hover(function(){if(b(this).hasClass("l-dialog-recover")){b(this).addClass("l-dialog-recover-over")}else{b(this).addClass("l-dialog-max-over")}},function(){b(this).removeClass("l-dialog-max-over l-dialog-recover-over")}).click(function(){if(b(this).hasClass("l-dialog-recover")){d.recover()}else{d.max()}})}}else{if(d.winmax){d.winmax.remove();d.winmax=null}}d._updateBtnsWidth()},_setShowMin:function(e){var d=this,f=this.options;if(e){if(!d.winmin){d.winmin=b('<div class="l-dialog-winbtn l-dialog-min"></div>').appendTo(d.dialog.winbtns).hover(function(){b(this).addClass("l-dialog-min-over")},function(){b(this).removeClass("l-dialog-min-over")}).click(function(){d.min()});a.win.addTask(d)}}else{if(d.winmin){d.winmin.remove();d.winmin=null}}d._updateBtnsWidth()},_setShowToggle:function(e){var d=this,f=this.options;if(e){if(!d.wintoggle){d.wintoggle=b('<div class="l-dialog-winbtn l-dialog-collapse"></div>').appendTo(d.dialog.winbtns).hover(function(){if(b(this).hasClass("l-dialog-toggle-disabled")){return}if(b(this).hasClass("l-dialog-extend")){b(this).addClass("l-dialog-extend-over")}else{b(this).addClass("l-dialog-collapse-over")}},function(){b(this).removeClass("l-dialog-extend-over l-dialog-collapse-over")}).click(function(){if(b(this).hasClass("l-dialog-toggle-disabled")){return}if(d.wintoggle.hasClass("l-dialog-extend")){if(d.trigger("extend")==false){return}d.wintoggle.removeClass("l-dialog-extend");d.extend();d.trigger("extended")}else{if(d.trigger("collapse")==false){return}d.wintoggle.addClass("l-dialog-extend");d.collapse();d.trigger("collapseed")}})}}else{if(d.wintoggle){d.wintoggle.remove();d.wintoggle=null}}},enter:function(){var e=this,f=this.options;var d;if(f.closeWhenEnter!=undefined){d=f.closeWhenEnter}else{if(f.type=="warn"||f.type=="error"||f.type=="success"||f.type=="question"){d=true}}if(d){e.close()}},esc:function(){},_removeDialog:function(){var d=this,e=this.options;if(e.showType&&e.fixedType){d.dialog.animate({bottom:-1*e.height},function(){d.dialog.remove()})}else{d.dialog.remove()}},close:function(){var d=this,e=this.options;a.win.removeTask(this);d.unmask();d._removeDialog();b("body").unbind("keydown.dialog")},_getVisible:function(){return this.dialog.is(":visible")},_setUrl:function(d){var e=this,f=this.options;f.url=d;if(f.load){e.dialog.body.html("").load(f.url,function(){e.trigger("loaded")})}else{if(e.jiframe){e.jiframe.attr("src",f.url)}}},_setContent:function(d){this.dialog.content.html(d)},_setTitle:function(e){var d=this;var f=this.options;if(e){b(".l-dialog-title",d.dialog).html(e)}},_hideDialog:function(){var d=this,e=this.options;if(e.showType&&e.fixedType){d.dialog.animate({bottom:-1*e.height},function(){d.dialog.hide()})}else{d.dialog.hide()}},hidden:function(){var d=this;a.win.removeTask(d);d.dialog.hide();d.unmask()},show:function(){var d=this,e=this.options;d.mask();if(e.fixedType){if(e.showType){d.dialog.css({bottom:-1*e.height}).addClass("l-dialog-fixed");d.dialog.show().animate({bottom:0})}else{d.dialog.show().css({bottom:0})}}else{d.dialog.show()}b.jui.win.setFront.juiceDefer(b.jui.win,100,[d])},setUrl:function(d){this._setUrl(d)},_saveStatus:function(){var d=this;d._width=d.dialog.body.width();d._height=d.dialog.body.height();var f=0;var e=0;if(!isNaN(parseInt(d.dialog.css("top")))){f=parseInt(d.dialog.css("top"))}if(!isNaN(parseInt(d.dialog.css("left")))){e=parseInt(d.dialog.css("left"))}d._top=f;d._left=e},_applyDrag:function(){var d=this,e=this.options;if(b.fn.juiceDrag){d.draggable=d.dialog.juiceDrag({handler:".l-dialog-title",animate:false,onStartDrag:function(){a.win.setFront(d)},onStopDrag:function(){if(e.target){var h=a.find(b.jui.controls.DateEditor);var f=a.find(b.jui.controls.ComboBox);b(b.merge(h,f)).each(function(){if(this.updateSelectBoxPosition){this.updateSelectBoxPosition()}})}d._saveStatus()}})}},_onReisze:function(){var h=this,j=this.options;if(j.target){var e=b(j.target).juice();if(!e){e=b(j.target).find(":first").juice()}if(!e){return}var f=h.dialog.content.height();var d=h.dialog.content.width();e.trigger("resize",[{width:d,height:f}])}},_applyResize:function(){var d=this,e=this.options;if(b.fn.juiceResizable){d.resizable=d.dialog.juiceResizable({onStopResize:function(k,j){var h=0;var f=0;if(!isNaN(parseInt(d.dialog.css("top")))){h=parseInt(d.dialog.css("top"))}if(!isNaN(parseInt(d.dialog.css("left")))){f=parseInt(d.dialog.css("left"))}if(k.diffLeft){d.set({left:f+k.diffLeft})}if(k.diffTop){d.set({top:h+k.diffTop})}if(k.newWidth){d.set({width:k.newWidth});d.dialog.body.css({width:k.newWidth-d._borderX})}if(k.newHeight){d.set({height:k.newHeight})}d._onReisze();d._saveStatus();return false},animate:false})}},_setImage:function(){var d=this,e=this.options;if(e.type){if(e.type=="success"||e.type=="donne"||e.type=="ok"){b(".l-dialog-image",d.dialog).addClass("l-dialog-image-donne").show();d.dialog.content.css({paddingLeft:64,paddingBottom:30})}else{if(e.type=="error"){b(".l-dialog-image",d.dialog).addClass("l-dialog-image-error").show();d.dialog.content.css({paddingLeft:64,paddingBottom:30})}else{if(e.type=="warn"){b(".l-dialog-image",d.dialog).addClass("l-dialog-image-warn").show();d.dialog.content.css({paddingLeft:64,paddingBottom:30})}else{if(e.type=="question"){b(".l-dialog-image",d.dialog).addClass("l-dialog-image-question").show();d.dialog.content.css({paddingLeft:64,paddingBottom:40})}}}}}}});a.controls.Dialog.prototype.hide=a.controls.Dialog.prototype.hidden;b.juiceDialog.open=function(d){return b.juiceDialog(d)};b.juiceDialog.close=function(){var f=a.find(a.controls.Dialog.prototype.__getType());for(var e in f){var h=f[e];h.destroy.juiceDefer(h,5)}a.win.unmask()};b.juiceDialog.show=function(f){var e=a.find(a.controls.Dialog.prototype.__getType());if(e.length){for(var d in e){e[d].show();return}}return b.juiceDialog(f)};b.juiceDialog.hide=function(){var f=a.find(a.controls.Dialog.prototype.__getType());for(var e in f){var h=f[e];h.hide()}};b.juiceDialog.tip=function(d){d=b.extend({showType:"slide",width:240,modal:false,height:150,left:window.availWidth*0.8,top:window.availHeight*0.8},d||{});b.extend(d,{fixedType:"se",type:"none",isDrag:false,isResize:false,showMax:false,showToggle:false,showMin:false});return b.juiceDialog.open(d)};b.juiceDialog.alert=function(f,h,e,j){f=f||"";if(typeof(h)=="function"){j=h;e=null}else{if(typeof(e)=="function"){j=e}}var d=function(m,k,l){k.close();if(j){j(m,k,l)}};p={content:f,top:(b(window).height()-150)/2,buttons:[{text:b.juiceDefaults.DialogString.ok,onclick:d}]};if(typeof(h)=="string"&&h!=""){p.title=h}if(typeof(e)=="string"&&e!=""){p.type=e}b.extend(p,{showMax:false,showToggle:false,showMin:false});return b.juiceDialog(p)};b.juiceDialog.confirm=function(e,f,h){if(typeof(f)=="function"){h=f;type=null}var d=function(k,j){j.close();if(h){h(k.type=="ok")}};p={type:"question",content:e,buttons:[{text:b.juiceDefaults.DialogString.yes,onclick:d,type:"ok"},{text:b.juiceDefaults.DialogString.no,onclick:d,type:"no"}]};if(typeof(f)=="string"&&f!=""){p.title=f}b.extend(p,{showMax:false,showToggle:false,showMin:false});return b.juiceDialog(p)};b.juiceDialog.warning=function(e,f,h){if(typeof(f)=="function"){h=f;type=null}var d=function(k,j){j.close();if(h){h(k.type)}};p={type:"question",content:e,buttons:[{text:b.juiceDefaults.DialogString.yes,onclick:d,type:"yes"},{text:b.juiceDefaults.DialogString.no,onclick:d,type:"no"},{text:b.juiceDefaults.DialogString.cancel,onclick:d,type:"cancel"}]};if(typeof(f)=="string"&&f!=""){p.title=f}b.extend(p,{showMax:false,showToggle:false,showMin:false});return b.juiceDialog(p)};b.juiceDialog.waitting=function(d){d=d||b.juiceDefaults.Dialog.waittingMessage;return b.juiceDialog.open({cls:"l-dialog-waittingdialog",type:"none",content:'<div style="padding:4px">'+d+"</div>",allowClose:false})};b.juiceDialog.closeWaitting=function(){var f=a.find(a.controls.Dialog);for(var e in f){var h=f[e];if(h.dialog.hasClass("l-dialog-waittingdialog")){h.close()}}};b.juiceDialog.success=function(e,f,d){return b.juiceDialog.alert(e,f,"success",d)};b.juiceDialog.error=function(e,f,d){return b.juiceDialog.alert(e,f,"error",d)};b.juiceDialog.warn=function(e,f,d){return b.juiceDialog.alert(e,f,"warn",d)};b.juiceDialog.question=function(d,e){return b.juiceDialog.alert(d,e,"question")};b.juiceDialog.prompt=function(k,f,j,l){var h=b('<input type="text" class="l-dialog-inputtext"/>');var d=60;if(typeof(j)=="function"){l=j}if(typeof(f)=="function"){l=f}else{if(typeof(f)=="boolean"){j=f}}if(typeof(j)=="boolean"&&j){h=b('<textarea class="l-dialog-textarea"></textarea>');d=120}if(typeof(f)=="string"||typeof(f)=="int"){h.val(f)}var e=function(o,m,n){m.close();if(l){l(o.type=="yes",h.val())}};p={title:k,target:h,width:320,height:d,buttons:[{text:b.juiceDefaults.DialogString.ok,onclick:e,type:"yes"},{text:b.juiceDefaults.DialogString.cancel,onclick:e,type:"cancel"}]};return b.juiceDialog(p)}})(jQuery);(function(a){a.fn.juiceEasyTab=function(){return a.jui.run.call(this,"juiceEasyTab",arguments)};a.fn.juiceGetEasyTabManager=function(){return a.jui.run.call(this,"juiceGetEasyTabManager",arguments)};a.juiceDefaults.EasyTab={};a.juiceMethos.EasyTab={};a.jui.controls.EasyTab=function(c,b){a.jui.controls.EasyTab.base.constructor.call(this,c,b)};a.jui.controls.EasyTab.juiceExtend(a.jui.core.UIComponent,{__getType:function(){return"EasyTab"},__idPrev:function(){return"EasyTab"},_extendMethods:function(){return a.juiceMethos.EasyTab},_render:function(){var c=this,d=this.options;c.tabs=a(this.element);c.tabs.addClass("l-easytab");var b=0;if(a("> div[lselected=true]",c.tabs).length>0){b=a("> div",c.tabs).index(a("> div[lselected=true]",c.tabs))}c.tabs.ul=a('<ul class="l-easytab-header"></ul>');a("> div",c.tabs).each(function(f,h){var e=a("<li><span></span></li>");if(f==b){a("span",e).addClass("l-selected")}if(a(h).attr("title")){a("span",e).html(a(h).attr("title"))}c.tabs.ul.append(e);if(!a(h).hasClass("l-easytab-panelbox")){a(h).addClass("l-easytab-panelbox")}});c.tabs.ul.prependTo(c.tabs);a(".l-easytab-panelbox:eq("+b+")",c.tabs).show().siblings(".l-easytab-panelbox").hide();a("> ul:first span",c.tabs).click(function(){if(a(this).hasClass("l-selected")){return}var e=a("> ul:first span",c.tabs).index(this);a(this).addClass("l-selected").parent().siblings().find("span.l-selected").removeClass("l-selected");a(".l-easytab-panelbox:eq("+e+")",c.tabs).show().siblings(".l-easytab-panelbox").hide()}).not("l-selected").hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")});c.set(d)}})})(jQuery);(function(a){a.fn.juiceFieldSet=function(){return a.jui.run.call(this,"juiceFieldSet",arguments)};a.juiceDefaults=a.juiceDefaults||{};a.juiceDefaults.FieldSet={width:500,height:"auto",title:""};a.jui.controls.FieldSet=function(c,b){a.jui.controls.FieldSet.base.constructor.call(this,c,b)};a.jui.controls.FieldSet.juiceExtend(a.jui.core.UIComponent,{__getType:function(){return"FieldSet"},__idPrev:function(){return"FieldSet"},_init:function(){var b=this,c=this.options;a.jui.controls.FieldSet.base._init.call(this);b._copyProperty(c,a(this.element))},_render:function(){var b=this,d=this.options;b.field=a(this.element);b.field.addClass("l-fieldset");var c=[];c.push("<legend class='l-fieldset-header l-fieldset-header-default'>");c.push("   <div class='l-tool'><img  class='l-tool-toggle l-tool-toggle-default' src='data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=='/></div>");c.push("   <div  class='l-fieldset-header-text'></div>");c.push("   <div  class='l-clear'></div>");c.push("</legend>");b.header=a(c.join(""));b.headerText=a(".l-fieldset-header-text",b.header);b.cotentWrap=a("<div class='l-fieldset-body'></div>");b.tool=a(".l-tool",b.header);b.cotentWrap.append(b.field.children());b.field.prepend(b.header);b.field.append(b.cotentWrap);b._build();delete c},_build:function(){var b=this,c=this.options;b._setTitle();b._size();b._setEvent()},_setTitle:function(d){var b=this,c=this.options;c.title=d||c.title||"标题";b.headerText.html(c.title)},_setEvent:function(){var b=this,c=this.options;b.tool.click(function(){if(b.tool.hasClass("l-tool-down-over")){b.tool.removeClass("l-tool-down-over");b.tool.removeClass("l-tool-down");b.tool.addClass("l-tool-over");b.field.removeClass("l-fieldset-collapsed")}else{b.tool.addClass("l-tool-down-over");b.tool.removeClass("l-tool-over");b.field.addClass("l-fieldset-collapsed")}});b.tool.hover(function(){if(b.tool.hasClass("l-tool-down")){b.tool.addClass("l-tool-down-over");b.tool.remove("l-tool-down")}else{b.tool.addClass("l-tool-over")}},function(){if(b.tool.hasClass("l-tool-down-over")){b.tool.addClass("l-tool-down");b.tool.removeClass("l-tool-down-over")}else{if(b.tool.hasClass("l-tool-over")){b.tool.removeClass("l-tool-over")}}})},_size:function(){var b=this,c=this.options;if(typeof c.width!="string"&&c.width){b.field.width(c.width)}var d=c.titleWidth||(c.title?(c.title.length)*12+20:20);b.header.width(d)}})})(jQuery);(function(a){a.fn.juiceFilter=function(){return a.jui.run.call(this,"juiceFilter",arguments)};a.fn.juiceGetFilterManager=function(){return a.jui.run.call(this,"juiceGetFilterManager",arguments)};a.juiceDefaults.Filter={fields:[],operators:{},editors:{}};a.juiceDefaults.FilterString={strings:{and:"并且",or:"或者",equal:"相等",notequal:"不相等",startwith:"以..开始",endwith:"以..结束",like:"相似",greater:"大于",greaterorequal:"大于或等于",less:"小于",lessorequal:"小于或等于","in":"包括在...",notin:"不包括...",addgroup:"增加分组",addrule:"增加条件",deletegroup:"删除分组"}};a.juiceDefaults.Filter.operators.string=a.juiceDefaults.Filter.operators.text=["equal","notequal","startwith","endwith","like","greater","greaterorequal","less","lessorequal","in","notin"];a.juiceDefaults.Filter.operators.number=a.juiceDefaults.Filter.operators["int"]=a.juiceDefaults.Filter.operators["float"]=a.juiceDefaults.Filter.operators.date=["equal","notequal","greater","greaterorequal","less","lessorequal","in","notin"];a.juiceDefaults.Filter.editors.string={create:function(b,d){var c=a("<input type='text'/>");b.append(c);c.juiceTextBox(d.editor.options||{});return c},setValue:function(b,c){b.val(c)},getValue:function(b){return b.juice("option","value")},destroy:function(b){b.juice("destroy")}};a.juiceDefaults.Filter.editors.date={create:function(b,d){var c=a("<input type='text'/>");b.append(c);c.juiceDateEditor(d.editor.options||{});return c},setValue:function(b,c){b.juice("option","value",c)},getValue:function(b,c){return b.juice("option","value")},destroy:function(b){b.juice("destroy")}};a.juiceDefaults.Filter.editors.number={create:function(b,e){var c=a("<input type='text'/>");b.append(c);var d={minValue:e.editor.minValue,maxValue:e.editor.maxValue};c.juiceSpinner(a.extend(d,e.editor.options||{}));return c},setValue:function(b,c){b.val(c)},getValue:function(b,d){var c=d.editor.type=="int";if(c){return parseInt(b.val(),10)}else{return parseFloat(b.val())}},destroy:function(b){b.juice("destroy")}};a.juiceDefaults.Filter.editors.combobox={create:function(b,e){var c=a("<input type='text'/>");b.append(c);var d={data:e.data,slide:false,valueField:e.editor.valueField||e.editor.valueColumnName,textField:e.editor.textField||e.editor.displayColumnName};a.extend(d,e.editor.options||{});c.juiceComboBox(d);return c},setValue:function(b,c){b.juice("option","value",c)},getValue:function(b){return b.juice("option","value")},destroy:function(b){b.juice("destroy")}};a.jui.controls.Filter=function(c,b){a.jui.controls.Filter.base.constructor.call(this,c,b)};a.jui.controls.Filter.juiceExtend(a.jui.core.UIComponent,{__getType:function(){return"Filter"},__idPrev:function(){return"Filter"},_init:function(){a.jui.controls.Filter.base._init.call(this)},_render:function(){var b=this,c=this.options;b.set(c);a("#"+b.id+" .addgroup").live("click",function(){var d=a(this).parent().parent().parent().parent();b.addGroup(d)});a("#"+b.id+" .deletegroup").live("click",function(){var d=a(this).parent().parent().parent().parent();b.deleteGroup(d)});a("#"+b.id+" .addrule").live("click",function(){var d=a(this).parent().parent().parent().parent();b.addRule(d)});a("#"+b.id+" .deleterole").live("click",function(){var d=a(this).parent().parent();b.deleteRule(d)})},_setFields:function(b){var c=this,d=this.options;if(c.group){c.group.remove()}c.group=a(c._bulidGroupTableHtml()).appendTo(c.element)},editors:{},editorCounter:0,addGroup:function(c){var e=this,f=this.options;c=a(c||e.group);var j=a(">tbody:first > tr:last",c);var b=[];b.push('<tr class="l-filter-rowgroup"><td class="l-filter-cellgroup" colSpan="4">');var d=!c.hasClass("l-filter-group-alt");b.push(e._bulidGroupTableHtml(d,true));b.push("</td></tr>");var h=a(b.join(""));j.before(h);return h.find("table:first")},deleteGroup:function(d){var b=this,c=this.options;a("td.l-filter-value",d).each(function(){var e=a(this).parent();a("select.fieldsel",e).unbind();b.removeEditor(e)});a(d).parent().parent().remove()},removeEditor:function(b){var e=this,f=this.options;var d=a(b).attr("editortype");var h=a(b).attr("editorid");var c=e.editors[h];if(c){f.editors[d].destroy(c)}a("td.l-filter-value:first",b).html("")},setData:function(e,b){var c=this,d=this.options;b=b||c.group;var f=a(">tbody:first > tr:last",b);b.find(">tbody:first > tr").not(f).remove();a("select:first",f).val(e.op);if(e.rules){a(e.rules).each(function(){var h=c.addRule(b);h.attr("fieldtype",this.type||"string");a("select.opsel",h).val(this.op);a("select.fieldsel",h).val(this.field).trigger("change");var j=h.attr("editorid");if(j&&c.editors[j]){var k=c.getField(this.field);d.editors[k.editor.type].setValue(c.editors[j],this.value,k)}else{a(":text",h).val(this.value)}})}if(e.groups){a(e.groups).each(function(){var h=c.addGroup(b);c.setData(this,h)})}},addRule:function(c){var d=this,e=this.options;c=c||d.group;var f=a(">tbody:first > tr:last",c);var b=a(d._bulidRuleRowHtml());f.before(b);if(e.fields.length){d.appendEditor(b,e.fields[0])}a("select.fieldsel",b).bind("change",function(){var m=a(this).parent().next().find("select:first");var o=a(this).val();var n=d.getField(o);var l=n.type||"string";var j=b.attr("fieldtype");if(l!=j){m.html(d._bulidOpSelectOptionsHtml(l));b.attr("fieldtype",l)}var h=null;var k=b.attr("editortype");if(d.enabledEditor(n)){h=n.editor.type}if(k){d.removeEditor(b)}if(h){d.appendEditor(b,n)}else{b.removeAttr("editortype").removeAttr("editorid");a("td.l-filter-value:first",b).html('<input type="text" class="valtxt" />')}});return b},deleteRule:function(b){a("select.fieldsel",b).unbind();this.removeEditor(b);a(b).remove()},appendEditor:function(c,h){var e=this,f=this.options;if(e.enabledEditor(h)){var b=a("td.l-filter-value:first",c).html("");var d=f.editors[h.editor.type];e.editors[++e.editorCounter]=d.create(b,h);c.attr("editortype",h.editor.type).attr("editorid",e.editorCounter)}},getData:function(e){var c=this,d=this.options;e=e||c.group;var b={};a("> tbody > tr",e).each(function(k,r){var j=a(r).hasClass("l-filter-rowlast");var h=a(r).hasClass("l-filter-rowgroup");if(h){var f=a("> td:first > table:first",r);if(f.length){if(!b.groups){b.groups=[]}b.groups.push(c.getData(f))}}else{if(j){b.op=a(".groupopsel:first",r).val()}else{var q=a("select.fieldsel:first",r).val();var n=c.getField(q);var l=a(".opsel:first",r).val();var o=c._getRuleValue(r,n);var m=a(r).attr("fieldtype")||"string";if(!b.rules){b.rules=[]}b.rules.push({field:q,op:l,value:o,type:m})}}});return b},_getRuleValue:function(b,j){var f=this,h=this.options;var d=a(b).attr("editorid");var c=a(b).attr("editortype");var e=f.editors[d];if(e){return h.editors[c].getValue(e,j)}return a(".valtxt:first",b).val()},enabledEditor:function(d){var b=this,c=this.options;if(!d.editor||!d.editor.type){return false}return(d.editor.type in c.editors)},getField:function(c){var e=this,h=this.options;for(var d=0,b=h.fields.length;d<b;d++){var f=h.fields[d];if(f.name==c){return f}}return null},_bulidGroupTableHtml:function(c,b){var d=this,f=this.options;var e=[];e.push('<table cellpadding="0" cellspacing="0" border="0" class="l-filter-group');if(c){e.push(" l-filter-group-alt")}e.push('"><tbody>');e.push('<tr class="l-filter-rowlast"><td class="l-filter-rowlastcell" align="right" colSpan="4">');e.push('<select class="groupopsel">');e.push('<option value="and">'+f.strings.and+"</option>");e.push('<option value="or">'+f.strings.or+"</option>");e.push("</select>");e.push('<input type="button" value="'+f.strings.addgroup+'" class="addgroup">');e.push('<input type="button" value="'+f.strings.addrule+'" class="addrule">');if(b){e.push('<input type="button" value="'+f.strings.deletegroup+'" class="deletegroup">')}e.push("</td></tr>");e.push("</tbody></table>");return e.join("")},_bulidRuleRowHtml:function(b){var h=this,k=this.options;b=b||k.fields;var f=[];var d=b[0].type||"string";f.push('<tr fieldtype="'+d+'"><td class="l-filter-column">');f.push('<select class="fieldsel">');for(var e=0,c=b.length;e<c;e++){var j=b[e];f.push('<option value="'+j.name+'"');if(e==0){f.push(" selected ")}f.push(">");f.push(j.display);f.push("</option>")}f.push("</select>");f.push("</td>");f.push('<td class="l-filter-op">');f.push('<select class="opsel">');f.push(h._bulidOpSelectOptionsHtml(d));f.push("</select>");f.push("</td>");f.push('<td class="l-filter-value">');f.push('<input type="text" class="valtxt" />');f.push("</td>");f.push("<td>");f.push('<div class="l-icon-cross deleterole"></div>');f.push("</td>");f.push("</tr>");return f.join("")},_bulidOpSelectOptionsHtml:function(d){var h=this,j=this.options;var f=j.operators[d];var b=[];for(var e=0,c=f.length;e<c;e++){var k=f[e];b[b.length]='<option value="'+k+'">';b[b.length]=j.strings[k];b[b.length]="</option>"}return b.join("")}})})(jQuery);(function(a){a.fn.juiceNumberBox=function(){return a.jui.run.call(this,"juiceNumberBox",arguments)};a.fn.juiceGetNumberBoxManager=function(){return a.jui.run.call(this,"juiceGetNumberBoxManager",arguments)};a.juiceDefaults.NumberBox={onChangeValue:null,width:null,disabled:false,initValue:null,nullText:null,digits:false,number:false,groupSeparator:",",decimalSeparator:".",precision:0,prefix:null,suffix:null};a.jui.controls.NumberBox=function(c,b){a.jui.controls.NumberBox.base.constructor.call(this,c,b)};a.jui.controls.NumberBox.juiceExtend(a.jui.controls.Input,{__getType:function(){return"NumberBox"},__idPrev:function(){return"NumberBox"},_init:function(){a.jui.controls.NumberBox.base._init.call(this);var b=this,c=this.options;b._copyProperty(c,a(b.element));if(!c.width){c.width=a(b.element).width()}if(a(this.element).attr("readonly")){c.disabled=true}},_render:function(){var b=this,c=this.options;b.inputText=a(this.element);b.wrapper=b.inputText.wrap('<div class="l-text"></div>').parent();b.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>');b.renderText=a('<input type="text"/>');b.wrapper.prepend(b.renderText);if(!b.renderText.hasClass("l-text-field")){b.renderText.addClass("l-text-field")}b.inputText.hide();this._setEvent();b.set(c);b.initValue();b.checkValue()},_getValue:function(){return this.inputText.val()},_setNullText:function(){this.checkNotNull()},getValue:function(){return this._getValue()},checkValue:function(){var c=this,d=this.options;var b=c.inputText.val();if(d.number&&!/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(b)||d.digits&&!/^\d+$/.test(b)){c.inputText.val(c.value||0);return}c.value=b},initValue:function(c){var b=this,d=this.options;b._setValue(d.initValue);b.renderText.val(b.getRenderValue())},getRenderValue:function(){var e=this,h=this.options;var f=e._getValue();var c="000";if(h.groupSeparator){c="0"+h.groupSeparator+c}if(h.precision>0){if(h.decimalSeparator){c+=h.decimalSeparator}for(var d=0;d<h.precision;d++){c+="0"}}var b=a.jui.uitl.numberFormat(f,c,{comma:h.groupSeparator});if(h.prefix){b=h.prefix+b}if(h.suffix){b+=h.suffix}return b},checkNotNull:function(){var b=this,c=this.options;if(c.nullText&&!c.disabled){if(!b.inputText.val()){b.inputText.addClass("l-text-field-null").val(c.nullText)}}},_setEvent:function(){var b=this,c=this.options;b.renderText.bind("blur.NumberBox",function(){b.trigger("blur");b.checkNotNull();b.checkValue();b._setValue(b.renderText.val());b.renderText.val(b.getRenderValue());b.wrapper.removeClass("l-text-focus")}).bind("focus.NumberBox",function(){if(c.nullText){if(a(this).hasClass("l-text-field-null")){a(this).removeClass("l-text-field-null").val("")}}b.trigger("focus");b.renderText.val(b._getValue());var e=b.renderText[0];if(e==null){e=event.srcElement||event.target}var d=e.createTextRange();d.moveStart("character",e.value.length);d.collapse(true);d.select();b.wrapper.addClass("l-text-focus")}).change(function(){b.trigger("changeValue",[this.value])}).bind("keydown",function(f){var d=f.keyCode;if(((d>=48&&d<=57)||(d>=96&&d<=105)||d==8)&&f.shiftKey!=true){return true}else{return false}});b.wrapper.hover(function(){b.trigger("mouseOver");b.wrapper.addClass("l-text-over")},function(){b.trigger("mouseOut");b.wrapper.removeClass("l-text-over")})},_setDisabled:function(b){if(b){this.inputText.attr("readonly","readonly");this.wrapper.addClass("l-text-disabled")}else{this.inputText.removeAttr("readonly");this.wrapper.removeClass("l-text-disabled")}},_setWidth:function(b){if(b>20){this.wrapper.css({width:b});this.inputText.css({width:b-4})}},_setHeight:function(b){if(b>10){this.wrapper.height(b);this.inputText.height(b-2)}},_setValue:function(b){if(b!=null){this.inputText.val(b)}},_setLabel:function(d){var c=this,e=this.options;if(!c.labelwrapper){c.labelwrapper=c.wrapper.wrap('<div class="l-labeltext"></div>').parent();var b=a('<div class="l-text-label" style="float:left;">'+d+":&nbsp</div>");c.labelwrapper.prepend(b);c.wrapper.css("float","left");if(!e.labelWidth){e.labelWidth=b.width()}else{c._setLabelWidth(e.labelWidth)}b.height(c.wrapper.height());if(e.labelAlign){c._setLabelAlign(e.labelAlign)}c.labelwrapper.append('<br style="clear:both;" />');c.labelwrapper.width(e.labelWidth+e.width+2)}else{c.labelwrapper.find(".l-text-label").html(d+":&nbsp")}},_setLabelWidth:function(c){var b=this,d=this.options;if(!b.labelwrapper){return}b.labelwrapper.find(".l-text-label").width(c)},_setLabelAlign:function(c){var b=this,d=this.options;if(!b.labelwrapper){return}b.labelwrapper.find(".l-text-label").css("text-align",c)},updateStyle:function(){var b=this,c=this.options;if(b.inputText.attr("disabled")||b.inputText.attr("readonly")){b.wrapper.addClass("l-text-disabled");b.options.disabled=true}else{b.wrapper.removeClass("l-text-disabled");b.options.disabled=false}if(b.inputText.hasClass("l-text-field-null")&&b.inputText.val()!=c.nullText){b.inputText.removeClass("l-text-field-null")}b.checkValue()}})})(jQuery);(function(a){a.fn.juiceSpinner=function(){return a.jui.run.call(this,"juiceSpinner",arguments)};a.fn.juiceGetSpinnerManager=function(){return a.jui.run.call(this,"juiceGetSpinnerManager",arguments)};a.juiceDefaults.Spinner={type:"float",isNegative:true,decimalplace:2,step:0.1,interval:50,onChangeValue:null,minValue:null,maxValue:null,disabled:false};a.juiceMethos.Spinner={};a.jui.controls.Spinner=function(c,b){a.jui.controls.Spinner.base.constructor.call(this,c,b)};a.jui.controls.Spinner.juiceExtend(a.jui.controls.Input,{__getType:function(){return"Spinner"},__idPrev:function(){return"Spinner"},_extendMethods:function(){return a.juiceMethos.Spinner},_init:function(){a.jui.controls.Spinner.base._init.call(this);var b=this.options;if(b.type=="float"){b.step=0.1;b.interval=50}else{if(b.type=="int"){b.step=1;b.interval=100}else{if(b.type=="time"){b.step=1;b.interval=100}}}},_render:function(){var b=this,c=this.options;b.interval=null;b.inputText=null;b.value=null;b.textFieldID="";if(this.element.tagName.toLowerCase()=="input"&&this.element.type&&this.element.type=="text"){b.inputText=a(this.element);if(this.element.id){b.textFieldID=this.element.id}}else{b.inputText=a('<input type="text"/>');b.inputText.appendTo(a(this.element))}if(b.textFieldID==""&&c.textFieldID){b.textFieldID=c.textFieldID}b.link=a('<div class="l-trigger"><div class="l-spinner-up"><div class="l-spinner-icon"></div></div><div class="l-spinner-split"></div><div class="l-spinner-down"><div class="l-spinner-icon"></div></div></div>');b.wrapper=b.inputText.wrap('<div class="l-text"></div>').parent();b.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>');b.wrapper.append(b.link).after(b.selectBox).after(b.valueField);b.link.up=a(".l-spinner-up",b.link);b.link.down=a(".l-spinner-down",b.link);b.inputText.addClass("l-text-field");if(c.disabled){b.wrapper.addClass("l-text-disabled")}if(!b._isVerify(b.inputText.val())){b.value=b._getDefaultValue();b.inputText.val(b.value)}b.link.up.hover(function(){if(!c.disabled){a(this).addClass("l-spinner-up-over")}},function(){clearInterval(b.interval);a(document).unbind("selectstart.spinner");a(this).removeClass("l-spinner-up-over")}).mousedown(function(){if(!c.disabled){b._uping.call(b);b.interval=setInterval(function(){b._uping.call(b)},c.interval);a(document).bind("selectstart.spinner",function(){return false})}}).mouseup(function(){clearInterval(b.interval);b.inputText.trigger("change").focus();a(document).unbind("selectstart.spinner")});b.link.down.hover(function(){if(!c.disabled){a(this).addClass("l-spinner-down-over")}},function(){clearInterval(b.interval);a(document).unbind("selectstart.spinner");a(this).removeClass("l-spinner-down-over")}).mousedown(function(){if(!c.disabled){b.interval=setInterval(function(){b._downing.call(b)},c.interval);a(document).bind("selectstart.spinner",function(){return false})}}).mouseup(function(){clearInterval(b.interval);b.inputText.trigger("change").focus();a(document).unbind("selectstart.spinner")});b.inputText.change(function(){var d=b.inputText.val();b.value=b._getVerifyValue(d);b.trigger("changeValue",[b.value]);b.inputText.val(b.value)}).blur(function(){b.wrapper.removeClass("l-text-focus")}).focus(function(){b.wrapper.addClass("l-text-focus")});b.wrapper.hover(function(){if(!c.disabled){b.wrapper.addClass("l-text-over")}},function(){b.wrapper.removeClass("l-text-over")});b.set(c)},_setWidth:function(c){var b=this;if(c>20){b.wrapper.css({width:c});b.inputText.css({width:c-20})}},_setHeight:function(c){var b=this;if(c>10){b.wrapper.height(c);b.inputText.height(c-2);b.link.height(c-4)}},_setDisabled:function(b){if(b){this.wrapper.addClass("l-text-disabled")}else{this.wrapper.removeClass("l-text-disabled")}},setValue:function(b){this.inputText.val(b)},getValue:function(){return this.inputText.val()},_round:function(b,h){var d=this,f=this.options;var c=1;for(;h>0;c*=10,h--){}for(;h<0;c/=10,h++){}return Math.round(b*c)/c},_isInt:function(e){var b=this,c=this.options;var d=c.isNegative?/^-?\d+$/:/^\d+$/;if(!d.test(e)){return false}if(parseFloat(e)!=e){return false}return true},_isFloat:function(e){var b=this,c=this.options;var d=c.isNegative?/^-?\d+(\.\d+)?$/:/^\d+(\.\d+)?$/;if(!d.test(e)){return false}if(parseFloat(e)!=e){return false}return true},_isTime:function(e){var c=this,d=this.options;var b=e.match(/^(\d{1,2}):(\d{1,2})$/);if(b==null){return false}if(b[1]>24||b[2]>60){return false}return true},_isVerify:function(e){var b=this,d=this.options;if(d.type=="float"){if(!b._isFloat(e)){return false}var c=parseFloat(e);if(d.minValue!=undefined&&d.minValue>c){return false}if(d.maxValue!=undefined&&d.maxValue<c){return false}return true}else{if(d.type=="int"){if(!b._isInt(e)){return false}var c=parseInt(e);if(d.minValue!=undefined&&d.minValue>c){return false}if(d.maxValue!=undefined&&d.maxValue<c){return false}return true}else{if(d.type=="time"){return b._isTime(e)}}}return false},_getVerifyValue:function(d){var c=this,e=this.options;var b=null;if(e.type=="float"){b=c._round(d,e.decimalplace)}else{if(e.type=="int"){b=parseInt(d)}else{if(e.type=="time"){b=d}}}if(!c._isVerify(b)){return c.value}else{return b}},_isOverValue:function(c){var b=this,d=this.options;if(d.minValue!=null&&d.minValue>c){return true}if(d.maxValue!=null&&d.maxValue<c){return true}return false},_getDefaultValue:function(){var b=this,c=this.options;if(c.type=="float"||c.type=="int"){return 0}else{if(c.type=="time"){return"00:00"}}},_addValue:function(b){var c=this,e=this.options;var d=c.inputText.val();d=parseFloat(d)+b;if(c._isOverValue(d)){return}c.inputText.val(d);c.inputText.trigger("change")},_addTime:function(f){var c=this,e=this.options;var d=c.inputText.val();var b=d.match(/^(\d{1,2}):(\d{1,2})$/);newminute=parseInt(b[2])+f;if(newminute<10){newminute="0"+newminute}d=b[1]+":"+newminute;if(c._isOverValue(d)){return}c.inputText.val(d);c.inputText.trigger("change")},_uping:function(){var b=this,c=this.options;if(c.type=="float"||c.type=="int"){b._addValue(c.step)}else{if(c.type=="time"){b._addTime(c.step)}}},_downing:function(){var b=this,c=this.options;if(c.type=="float"||c.type=="int"){b._addValue(-1*c.step)}else{if(c.type=="time"){b._addTime(-1*c.step)}}},_isDateTime:function(b){var e=this,f=this.options;var c=b.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/);if(c==null){return false}var h=new Date(c[1],c[3]-1,c[4]);if(h=="NaN"){return false}return(h.getFullYear()==c[1]&&(h.getMonth()+1)==c[3]&&h.getDate()==c[4])},_isLongDateTime:function(b){var f=this,h=this.options;var c=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2})$/;var e=b.match(c);if(e==null){return false}var j=new Date(e[1],e[3]-1,e[4],e[5],e[6]);if(j=="NaN"){return false}return(j.getFullYear()==e[1]&&(j.getMonth()+1)==e[3]&&j.getDate()==e[4]&&j.getHours()==e[5]&&j.getMinutes()==e[6])}})})(jQuery);(function(a){a.juiceTip=function(b){return a.jui.run.call(null,"juiceTip",arguments)};a.fn.juiceTip=function(b){this.each(function(){var c=a.extend({},a.juiceDefaults.ElementTip,b||{});c.target=c.target||this;if(c.auto||b==undefined){if(!c.content){c.content=this.title;if(c.removeTitle){a(this).removeAttr("title")}}c.content=c.content||this.title;a(this).bind("mouseover.tip",function(){c.x=a(this).offset().left+a(this).width()+(c.distanceX||0);c.y=a(this).offset().top+(c.distanceY||0);a.juiceTip(c)}).bind("mouseout.tip",function(){var d=a.jui.managers[this.juitipid];if(d){d.remove()}})}else{if(c.target.juitipid){return}c.x=a(this).offset().left+a(this).width()+(c.distanceX||0);c.y=a(this).offset().top+(c.distanceY||0);c.x=c.x||0;c.y=c.y||0;a.juiceTip(c)}});return a.jui.get(this,"juitipid")};a.fn.juiceHideTip=function(b){return this.each(function(){var f=b||{};if(f.isLabel==undefined){f.isLabel=this.tagName.toLowerCase()=="label"&&a(this).attr("for")!=null}var e=this;if(f.isLabel){var c=a("#"+a(this).attr("for"));if(c.length==0){return}e=c[0]}var d=a.jui.managers[e.juitipid];if(d){d.remove()}}).unbind("mouseover.tip").unbind("mouseout.tip")};a.fn.juiceGetTipManager=function(){return a.jui.get(this)};a.juiceDefaults=a.juiceDefaults||{};a.juiceDefaults.HideTip={};a.juiceDefaults.Tip={content:null,callback:null,width:150,height:null,x:0,y:0,appendIdTo:null,target:null,auto:null,removeTitle:true};a.juiceDefaults.ElementTip={distanceX:1,distanceY:-3,auto:null,removeTitle:true};a.juiceMethos.Tip={};a.jui.controls.Tip=function(b){a.jui.controls.Tip.base.constructor.call(this,null,b)};a.jui.controls.Tip.juiceExtend(a.jui.core.UIComponent,{__getType:function(){return"Tip"},__idPrev:function(){return"Tip"},_extendMethods:function(){return a.juiceMethos.Tip},_render:function(){var b=this,d=this.options;var c=a('<div class="l-verify-tip"><div class="l-verify-tip-corner"></div><div class="l-verify-tip-content"></div></div>');b.tip=c;b.tip.attr("id",b.id);if(d.content){a("> .l-verify-tip-content:first",c).html(d.content);c.appendTo("body")}else{return}c.css({left:d.x,top:d.y}).show();d.width&&a("> .l-verify-tip-content:first",c).width(d.width-8);d.height&&a("> .l-verify-tip-content:first",c).width(d.height);eee=d.appendIdTo;if(d.appendIdTo){d.appendIdTo.attr("juiceTipId",b.id)}if(d.target){a(d.target).attr("juiceTipId",b.id);d.target.juitipid=b.id}d.callback&&d.callback(c);b.set(d)},_setContent:function(b){a("> .l-verify-tip-content:first",this.tip).html(b)},remove:function(){if(this.options.appendIdTo){this.options.appendIdTo.removeAttr("juiceTipId")}if(this.options.target){a(this.options.target).removeAttr("juiceTipId");this.options.target.juitipid=null}this.tip.remove()}})})(jQuery);(function(b){var a=b.jui;a.windowCount=0;b.juiceWindow=function(c){return a.run.call(null,"juiceWindow",arguments,{isStatic:true})};b.juiceWindow.show=function(c){return b.juiceWindow(c)};b.juiceDefaults.Window={showClose:true,showMax:true,showToggle:true,showMin:true,title:"window",load:false,onLoaded:null,modal:false};b.juiceMethos.Window={};a.controls.Window=function(c){a.controls.Window.base.constructor.call(this,null,c)};a.controls.Window.juiceExtend(a.core.Win,{__getType:function(){return"Window"},__idPrev:function(){return"Window"},_extendMethods:function(){return b.juiceMethos.Window},_render:function(){var f=this,k=this.options;f.window=b('<div class="l-window"><div class="l-window-header"><div class="l-window-header-buttons"><div class="l-window-toggle"></div><div class="l-window-max"></div><div class="l-window-close"></div><div class="l-clear"></div></div><div class="l-window-header-inner"></div></div><div class="l-window-content"></div></div>');f.element=f.window[0];f.window.content=b(".l-window-content",f.window);f.window.header=b(".l-window-header",f.window);f.window.buttons=b(".l-window-header-buttons:first",f.window);if(k.url){if(k.load){f.window.content.load(k.url,function(){f.trigger("loaded")});f.window.content.addClass("l-window-content-scroll")}else{var d=b("<iframe frameborder='0' src='"+k.url+"'></iframe>");var c="juiwindow"+a.windowCount++;if(k.name){c=k.name}d.attr("name",c).attr("id",c);k.framename=c;d.appendTo(f.window.content);f.iframe=d}}else{if(k.content){var e=b("<div>"+k.content+"</div>");e.appendTo(f.window.content)}else{if(k.target){f.window.content.append(k.target);k.target.show()}}}this.mask();f.active();b("body").append(f.window);f.set({width:k.width,height:k.height});var j=0;var h=0;if(k.left!=null){j=k.left}else{k.left=j=0.5*(b(window).width()-f.window.width())}if(k.top!=null){h=k.top}else{k.top=h=0.5*(b(window).height()-f.window.height())+b(window).scrollTop()-10}if(j<0){k.left=j=0}if(h<0){k.top=h=0}f.set(k);k.framename&&b(">iframe",f.window.content).attr("name",k.framename);if(!k.showToggle){b(".l-window-toggle",f.window).remove()}if(!k.showMax){b(".l-window-max",f.window).remove()}if(!k.showClose){b(".l-window-close",f.window).remove()}f._saveStatus();if(b.fn.juiceDrag){f.draggable=f.window.drag=f.window.juiceDrag({handler:".l-window-header-inner",onStartDrag:function(){f.active()},onStopDrag:function(){f._saveStatus()},animate:false})}if(b.fn.juiceResizable){f.resizeable=f.window.resizable=f.window.juiceResizable({onStartResize:function(){f.active();b(".l-window-max",f.window).removeClass("l-window-regain")},onStopResize:function(o,n){var m=0;var l=0;if(!isNaN(parseInt(f.window.css("top")))){m=parseInt(f.window.css("top"))}if(!isNaN(parseInt(f.window.css("left")))){l=parseInt(f.window.css("left"))}if(o.diffTop){f.window.css({top:m+o.diffTop})}if(o.diffLeft){f.window.css({left:l+o.diffLeft})}if(o.newWidth){f.window.width(o.newWidth)}if(o.newHeight){f.window.content.height(o.newHeight-28)}f._saveStatus();return false}});f.window.append("<div class='l-btn-nw-drop'></div>")}b(".l-window-toggle",f.window).click(function(){if(b(this).hasClass("l-window-toggle-close")){f.collapsed=false;b(this).removeClass("l-window-toggle-close")}else{f.collapsed=true;b(this).addClass("l-window-toggle-close")}f.window.content.slideToggle()}).hover(function(){if(f.window.drag){f.window.drag.set("disabled",true)}},function(){if(f.window.drag){f.window.drag.set("disabled",false)}});b(".l-window-close",f.window).click(function(){if(f.trigger("close")==false){return false}f.window.hide();a.win.removeTask(f)}).hover(function(){if(f.window.drag){f.window.drag.set("disabled",true)}},function(){if(f.window.drag){f.window.drag.set("disabled",false)}});b(".l-window-max",f.window).click(function(){if(b(this).hasClass("l-window-regain")){if(f.trigger("regain")==false){return false}f.window.width(f._width).css({left:f._left,top:f._top});f.window.content.height(f._height-28);b(this).removeClass("l-window-regain")}else{if(f.trigger("max")==false){return false}f.window.width(b(window).width()-2).css({left:0,top:0});f.window.content.height(b(window).height()-28).show();b(this).addClass("l-window-regain")}})},_saveStatus:function(){var c=this;c._width=c.window.width();c._height=c.window.height();var e=0;var d=0;if(!isNaN(parseInt(c.window.css("top")))){e=parseInt(c.window.css("top"))}if(!isNaN(parseInt(c.window.css("left")))){d=parseInt(c.window.css("left"))}c._top=e;c._left=d},min:function(){this.window.hide();this.minimize=true;this.actived=false},_setShowMin:function(d){var c=this,e=this.options;if(d){if(!c.winmin){c.winmin=b('<div class="l-window-min"></div>').prependTo(c.window.buttons).click(function(){c.min()});a.win.addTask(c)}}else{if(c.winmin){c.winmin.remove();c.winmin=null}}},_setLeft:function(c){if(c!=null){this.window.css({left:c})}},_setTop:function(c){if(c!=null){this.window.css({top:c})}},_setWidth:function(c){if(c>0){this.window.width(c)}},_setHeight:function(c){if(c>28){this.window.content.height(c-28)}},_setTitle:function(c){if(c){b(".l-window-header-inner",this.window.header).html(c)}},_setUrl:function(c){var d=this,e=this.options;e.url=c;if(e.load){d.window.content.html("").load(e.url,function(){if(d.trigger("loaded")==false){return false}})}else{if(d.jiframe){d.jiframe.attr("src",e.url)}}},hide:function(){var c=this,d=this.options;this.unmask();this.window.hide()},show:function(){var c=this,d=this.options;this.mask();this.window.show()},remove:function(){var c=this,d=this.options;this.unmask();this.window.remove()},active:function(){var e=this,j=this.options;if(e.minimize){var d=e._width,c=e._height,h=e._left,f=e._top;if(e.maximum){d=b(window).width();c=b(window).height();h=f=0;if(a.win.taskbar){c-=a.win.taskbar.outerHeight();if(a.win.top){f+=a.win.taskbar.outerHeight()}}}e.set({width:d,height:c,left:h,top:f})}e.actived=true;e.minimize=false;a.win.setFront(e);e.show();a.win.setFront(this)},setUrl:function(c){return _setUrl(c)}})})(jQuery);(function(a){a.fn.juiceToolBar=function(b){return a.jui.run.call(this,"juiceToolBar",arguments)};a.fn.juiceGetToolBarManager=function(){return a.jui.run.call(this,"juiceGetToolBarManager",arguments)};a.juiceDefaults.ToolBar={};a.juiceMethos.ToolBar={};a.jui.controls.ToolBar=function(c,b){a.jui.controls.ToolBar.base.constructor.call(this,c,b)};a.jui.controls.ToolBar.juiceExtend(a.jui.core.UIComponent,{__getType:function(){return"ToolBar"},__idPrev:function(){return"ToolBar"},_extendMethods:function(){return a.juiceMethos.ToolBar},_render:function(){var b=this,c=this.options;b.toolBar=a(this.element);b.toolBar.addClass("l-toolbar");b.set(c)},_setItems:function(b){var c=this,e=this.options;var d=(e.align&&e.align=="right");a(d?b.reverse():b).each(function(f,h){c.addItem(h)})},addItem:function(e){var d=this,f=this.options;if(e.line){var c=a('<div class="l-bar-separator"></div>');d.toolBar.append(c);if(f.align&&f.align=="right"){c.css("float","right")}return}var b=a('<div class="l-toolbar-item l-panel-btn"><span></span><div class="l-panel-btn-l"></div><div class="l-panel-btn-r"></div></div>');d.toolBar.append(b);if(f.align&&f.align=="right"){b.css("float","right")}e.id&&b.attr("toolbarid",e.id);if(e.img){b.append("<img src='"+e.img+"' />");b.addClass("l-toolbar-item-hasicon")}else{if(e.icon){b.append("<div class='l-icon l-icon-"+e.icon+"'></div>");b.addClass("l-toolbar-item-hasicon")}}e.text&&a("span:first",b).html(e.text);e.disable&&b.addClass("l-toolbar-item-disable");e.click&&b.click(function(){e.click(e)});b.hover(function(){a(this).addClass("l-panel-btn-over")},function(){a(this).removeClass("l-panel-btn-over")})}})})(jQuery);(function(a){a.fn.juiceTab=function(b){return a.jui.run.call(this,"juiceTab",arguments)};a.fn.juiceGetTabManager=function(){return a.jui.run.call(this,"juiceGetTabManager",arguments)};a.juiceDefaults.Tab={height:null,heightDiff:0,changeHeightOnResize:false,contextmenu:true,dblClickToClose:false,dragToMove:false,onBeforeOverrideTabItem:null,onAfterOverrideTabItem:null,onBeforeRemoveTabItem:null,onAfterRemoveTabItem:null,onBeforeAddTabItem:null,onAfterAddTabItem:null,onBeforeSelectTabItem:null,onAfterSelectTabItem:null};a.juiceDefaults.TabString={closeMessage:"关闭当前页",closeOtherMessage:"关闭其他",closeAllMessage:"关闭所有",reloadMessage:"刷新"};a.juiceMethos.Tab={};a.jui.controls.Tab=function(c,b){a.jui.controls.Tab.base.constructor.call(this,c,b)};a.jui.controls.Tab.juiceExtend(a.jui.core.UIComponent,{__getType:function(){return"Tab"},__idPrev:function(){return"Tab"},_extendMethods:function(){return a.juiceMethos.Tab},_render:function(){var c=this,e=this.options;if(e.height){c.makeFullHeight=true}c.tab=a(this.element);c.tab.addClass("l-tab");if(e.contextmenu&&a.juiceMenu){c.tab.menu=a.juiceMenu({width:100,items:[{text:e.closeMessage,id:"close",click:function(){c._menuItemClick.apply(c,arguments)}},{text:e.closeOtherMessage,id:"closeother",click:function(){c._menuItemClick.apply(c,arguments)}},{text:e.closeAllMessage,id:"closeall",click:function(){c._menuItemClick.apply(c,arguments)}},{text:e.reloadMessage,id:"reload",click:function(){c._menuItemClick.apply(c,arguments)}}]})}c.tab.content=a('<div class="l-tab-content"></div>');a("> div",c.tab).appendTo(c.tab.content);c.tab.content.appendTo(c.tab);c.tab.links=a('<div class="l-tab-links"><ul style="left: 0px; "></ul></div>');c.tab.links.prependTo(c.tab);c.tab.links.ul=a("ul",c.tab.links);var b=a("> div[lselected=true]",c.tab.content);var d=b.length>0;c.selectedTabId=b.attr("tabid");a("> div",c.tab.content).each(function(k,m){var f=a('<li class=""><a></a><div class="l-tab-links-item-left"></div><div class="l-tab-links-item-right"></div></li>');var j=a(this);if(j.attr("title")){a("> a",f).html(j.attr("title"));j.attr("title","")}var h=j.attr("tabid");if(h==undefined){h=c.getNewTabid();j.attr("tabid",h);if(j.attr("lselected")){c.selectedTabId=h}}f.attr("tabid",h);if(!d&&k==0){c.selectedTabId=h}var o=j.attr("showClose");if(o){f.append("<div class='l-tab-links-item-close'></div>")}a("> ul",c.tab.links).append(f);if(!j.hasClass("l-tab-content-item")){j.addClass("l-tab-content-item")}if(j.find("iframe").length>0){var l=a("iframe:first",j);if(l[0].readyState!="complete"){if(j.find(".l-tab-loading:first").length==0){j.prepend("<div class='l-tab-loading' style='display:block;'></div>")}var n=a(".l-tab-loading:first",j);l.bind("load.tab",function(){n.hide()})}}});c.selectTabItem(c.selectedTabId);if(e.height){if(typeof(e.height)=="string"&&e.height.indexOf("%")>0){c.onResize();if(e.changeHeightOnResize){a(window).resize(function(){c.onResize.call(c)})}}else{c.setHeight(e.height)}}if(c.makeFullHeight){c.setContentHeight()}a("li",c.tab.links).each(function(){c._addTabItemEvent(a(this))});c.tab.bind("dblclick.tab",function(l){if(!e.dblClickToClose){return}c.dblclicking=true;var k=(l.target||l.srcElement);var j=k.tagName.toLowerCase();if(j=="a"){var h=a(k).parent().attr("tabid");var f=a(k).parent().find("div.l-tab-links-item-close").length?true:false;if(f){c.removeTabItem(h)}}c.dblclicking=false});c.set(e)},_applyDrag:function(d){var c=this,e=this.options;c.droptip=c.droptip||a("<div class='l-tab-drag-droptip' style='display:none'><div class='l-drop-move-up'></div><div class='l-drop-move-down'></div></div>").appendTo("body");var b=a(d).juiceDrag({revert:true,animate:false,proxy:function(){var f=a(this).find("a").html();c.dragproxy=a("<div class='l-tab-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div></div>").appendTo("body");c.dragproxy.append(f);return c.dragproxy},onRendered:function(){this.set("cursor","pointer")},onStartDrag:function(j,h){if(!a(d).hasClass("l-selected")){return false}if(h.button==2){return false}var f=h.srcElement||h.target;if(a(f).hasClass("l-tab-links-item-close")){return false}},onDrag:function(j,h){if(c.dropIn==null){c.dropIn=-1}var k=c.tab.links.ul.find(">li");var f=k.index(j.target);k.each(function(o,r){if(f==o){return}var l=o>f;if(c.dropIn!=-1&&c.dropIn!=o){return}var s=a(this).offset();var m={top:s.top,bottom:s.top+a(this).height(),left:s.left-10,right:s.left+10};if(l){m.left+=a(this).width();m.right+=a(this).width()}var q=h.pageX||h.screenX;var n=h.pageY||h.screenY;if(q>m.left&&q<m.right&&n>m.top&&n<m.bottom){c.droptip.css({left:m.left+5,top:m.top-9}).show();c.dropIn=o;c.dragproxy.find(".l-drop-icon").removeClass("l-drop-no").addClass("l-drop-yes")}else{c.dropIn=-1;c.droptip.hide();c.dragproxy.find(".l-drop-icon").removeClass("l-drop-yes").addClass("l-drop-no")}})},onStopDrag:function(h,f){if(c.dropIn>-1){var k=c.tab.links.ul.find(">li:eq("+c.dropIn+")").attr("tabid");var j=a(h.target).attr("tabid");setTimeout(function(){c.moveTabItem(j,k)},0);c.dropIn=-1;c.dragproxy.remove()}c.droptip.hide();this.set("cursor","default")}});return b},_setDragToMove:function(c){if(!a.fn.juiceDrag){return}var b=this,d=this.options;if(c){if(b.drags){return}b.drags=b.drags||[];b.tab.links.ul.find(">li").each(function(){b.drags.push(b._applyDrag(this))})}},moveTabItem:function(j,c){var b=this;var h=b.tab.links.ul.find(">li[tabid="+j+"]");var f=b.tab.links.ul.find(">li[tabid="+c+"]");var e=b.tab.links.ul.find(">li").index(h);var d=b.tab.links.ul.find(">li").index(f);if(e<d){f.after(h)}else{f.before(h)}},setTabButton:function(){var c=this,d=this.options;var e=0;a("li",c.tab.links.ul).each(function(){e+=a(this).width()+2});var b=c.tab.width();if(e>b){c.tab.links.append('<div class="l-tab-links-left"></div><div class="l-tab-links-right"></div>');c.setTabButtonEven();return true}else{c.tab.links.ul.animate({left:0});a(".l-tab-links-left,.l-tab-links-right",c.tab.links).remove();return false}},setTabButtonEven:function(){var b=this,c=this.options;a(".l-tab-links-left",b.tab.links).hover(function(){a(this).addClass("l-tab-links-left-over")},function(){a(this).removeClass("l-tab-links-left-over")}).click(function(){b.moveToPrevTabItem()});a(".l-tab-links-right",b.tab.links).hover(function(){a(this).addClass("l-tab-links-right-over")},function(){a(this).removeClass("l-tab-links-right-over")}).click(function(){b.moveToNextTabItem()})},moveToPrevTabItem:function(){var e=this,h=this.options;var b=a(".l-tab-links-left",e.tab.links).width();var f=new Array();a("li",e.tab.links).each(function(j,k){var l=-1*b;if(j>0){l=parseInt(f[j-1])+a(this).prev().width()+2}f.push(l)});var d=-1*parseInt(e.tab.links.ul.css("left"));for(var c=0;c<f.length-1;c++){if(f[c]<d&&f[c+1]>=d){e.tab.links.ul.animate({left:-1*parseInt(f[c])});return}}},moveToNextTabItem:function(){var n=this,c=this.options;var h=a(".l-tab-links-right",n.tab).width();var k=0;var d=a("li",n.tab.links.ul);d.each(function(){k+=a(this).width()+2});var m=n.tab.width();var l=new Array();for(var f=d.length-1;f>=0;f--){var o=k-m+h+2;if(f!=d.length-1){o=parseInt(l[d.length-2-f])-a(d[f+1]).width()-2}l.push(o)}var b=-1*parseInt(n.tab.links.ul.css("left"));for(var e=1;e<l.length;e++){if(l[e]<=b&&l[e-1]>b){n.tab.links.ul.animate({left:-1*parseInt(l[e-1])});return}}},getTabItemCount:function(){var b=this,c=this.options;return a("li",b.tab.links.ul).length},getSelectedTabItemID:function(){var b=this,c=this.options;return a("li.l-selected",b.tab.links.ul).attr("tabid")},getSelectedTabItem:function(){var b=this,c=this.options;return a("li.l-selected",b.tab.links.ul)},removeSelectedTabItem:function(){var b=this,c=this.options;b.removeTabItem(b.getSelectedTabItemID())},overrideSelectedTabItem:function(b){var c=this,d=this.options;c.overrideTabItem(c.getSelectedTabItemID(),b)},overrideTabItem:function(m,q){var f=this,d=this.options;if(f.trigger("beforeOverrideTabItem",[m])==false){return false}var b=q.tabid;if(b==undefined){b=f.getNewTabid()}var c=q.url;var j=q.content;var h=q.target;var o=q.text;var k=q.showClose;var n=q.height;if(f.isTabItemExist(b)){return}var e=a("li[tabid="+m+"]",f.tab.links.ul);var l=a(".l-tab-content-item[tabid="+m+"]",f.tab.content);if(!e||!l){return}e.attr("tabid",b);l.attr("tabid",b);if(a("iframe",l).length==0&&c){l.html("<iframe frameborder='0' style='overflow: hidden;'></iframe>")}else{if(j){l.html(j)}}a("iframe",l).attr("name",b);if(k==undefined){k=true}if(k==false){a(".l-tab-links-item-close",e).remove()}else{if(a(".l-tab-links-item-close",e).length==0){e.append("<div class='l-tab-links-item-close'></div>")}}if(o==undefined){o=b}if(n){l.height(n)}a("a",e).text(o);a("iframe",l).attr("src",c);f.trigger("afterOverrideTabItem",[m])},selectTabItem:function(b){var c=this,d=this.options;if(c.trigger("beforeSelectTabItem",[b])==false){return false}c.selectedTabId=b;a("> .l-tab-content-item[tabid="+b+"]",c.tab.content).show().siblings().hide();a("li[tabid="+b+"]",c.tab.links.ul).addClass("l-selected").siblings().removeClass("l-selected");c.trigger("afterSelectTabItem",[b])},moveToLastTabItem:function(){var d=this,e=this.options;var f=0;a("li",d.tab.links.ul).each(function(){f+=a(this).width()+2});var c=d.tab.width();if(f>c){var b=a(".l-tab-links-right",d.tab.links).width();d.tab.links.ul.animate({left:-1*(f-c+b+2)})}},isTabItemExist:function(b){var c=this,d=this.options;return a("li[tabid="+b+"]",c.tab.links.ul).length>0},addTabItem:function(r){var h=this,d=this.options;if(h.trigger("beforeAddTabItem",[b])==false){return false}var b=r.tabid;if(b==undefined){b=h.getNewTabid()}var c=r.url;var j=r.content;var q=r.text;var k=r.showClose;var o=r.height;if(h.isTabItemExist(b)){h.selectTabItem(b);return}var e=a("<li><a></a><div class='l-tab-links-item-left'></div><div class='l-tab-links-item-right'></div><div class='l-tab-links-item-close'></div></li>");var m=a("<div class='l-tab-content-item'><div class='l-tab-loading' style='display:block;'></div><iframe frameborder='0' style='overflow: hidden;'></iframe></div>");var n=a("div:first",m);var f=a("iframe:first",m);if(h.makeFullHeight){var l=h.tab.height()-h.tab.links.height();m.height(l)}e.attr("tabid",b);m.attr("tabid",b);if(c){f.attr("name",b).attr("id",b).attr("src",c).bind("load.tab",function(){n.hide();if(r.callback){r.callback()}})}else{f.remove();n.remove()}if(j){m.html(j)}else{if(r.target){m.append(r.target)}}if(k==undefined){k=true}if(k==false){a(".l-tab-links-item-close",e).remove()}if(q==undefined){q=b}if(o){m.height(o)}a("a",e).html(q);h.tab.links.ul.append(e);h.tab.content.append(m);h.selectTabItem(b);if(h.setTabButton()){h.moveToLastTabItem()}h._addTabItemEvent(e);if(d.dragToMove&&a.fn.juiceDrag){h.drags=h.drags||[];e.each(function(){h.drags.push(h._applyDrag(this))})}h.trigger("afterAddTabItem",[b])},_addTabItemEvent:function(b){var c=this,d=this.options;b.click(function(){var e=a(this).attr("tabid");c.selectTabItem(e)});c.tab.menu&&c._addTabItemContextMenuEven(b);a(".l-tab-links-item-close",b).hover(function(){a(this).addClass("l-tab-links-item-close-over")},function(){a(this).removeClass("l-tab-links-item-close-over")}).click(function(){var e=a(this).parent().attr("tabid");c.removeTabItem(e)})},removeTabItem:function(b){var d=this,e=this.options;if(d.trigger("beforeRemoveTabItem",[b])==false){return false}var c=a("li[tabid="+b+"]",d.tab.links.ul).hasClass("l-selected");if(c){a(".l-tab-content-item[tabid="+b+"]",d.tab.content).prev().show();a("li[tabid="+b+"]",d.tab.links.ul).prev().addClass("l-selected").siblings().removeClass("l-selected")}a(".l-tab-content-item[tabid="+b+"]",d.tab.content).remove();a("li[tabid="+b+"]",d.tab.links.ul).remove();d.setTabButton();d.trigger("afterRemoveTabItem",[b])},addHeight:function(e){var c=this,d=this.options;var b=c.tab.height()+e;c.setHeight(b)},setHeight:function(b){var c=this,d=this.options;c.tab.height(b);c.setContentHeight()},setContentHeight:function(){var c=this,d=this.options;var b=c.tab.height()-c.tab.links.height();c.tab.content.height(b);a("> .l-tab-content-item",c.tab.content).height(b)},getNewTabid:function(){var b=this,c=this.options;b.getnewidcount=b.getnewidcount||0;return"tabitem"+(++b.getnewidcount)},getTabidList:function(c,b){var e=this,f=this.options;var d=[];a("> li",e.tab.links.ul).each(function(){if(a(this).attr("tabid")&&a(this).attr("tabid")!=c&&(!b||a(".l-tab-links-item-close",this).length>0)){d.push(a(this).attr("tabid"))}});return d},removeOther:function(b,f){var d=this,e=this.options;var c=d.getTabidList(b,true);a(c).each(function(){d.removeTabItem(this)})},reload:function(b){var f=this,j=this.options;var d=a(".l-tab-content-item[tabid="+b+"]");var h=a(".l-tab-loading:first",d);var e=a("iframe:first",d);var c=a(e).attr("src");h.show();e.attr("src",c).unbind("load.tab").bind("load.tab",function(){h.hide()})},removeAll:function(e){var c=this,d=this.options;var b=c.getTabidList(null,true);a(b).each(function(){c.removeTabItem(this)})},onResize:function(){var b=this,c=this.options;if(!c.height||typeof(c.height)!="string"||c.height.indexOf("%")==-1){return false}if(b.tab.parent()[0].tagName.toLowerCase()=="body"){var d=a(window).height();d-=parseInt(b.tab.parent().css("paddingTop"));d-=parseInt(b.tab.parent().css("paddingBottom"));b.height=c.heightDiff+d*parseFloat(b.height)*0.01}else{b.height=c.heightDiff+(b.tab.parent().height()*parseFloat(c.height)*0.01)}b.tab.height(b.height);b.setContentHeight()},_menuItemClick:function(c){var b=this,d=this.options;if(!c.id||!b.actionTabid){return}switch(c.id){case"close":b.removeTabItem(b.actionTabid);b.actionTabid=null;break;case"closeother":b.removeOther(b.actionTabid);break;case"closeall":b.removeAll();b.actionTabid=null;break;case"reload":b.selectTabItem(b.actionTabid);b.reload(b.actionTabid);break}},_addTabItemContextMenuEven:function(b){var c=this,d=this.options;b.bind("contextmenu",function(f){if(!c.tab.menu){return}c.actionTabid=b.attr("tabid");c.tab.menu.show({top:f.pageY,left:f.pageX});if(a(".l-tab-links-item-close",this).length==0){c.tab.menu.setDisabled("close")}else{c.tab.menu.setEnabled("close")}return false})},getItemUrl:function(b){var c=a(".l-tab-content-item[tabid="+b+"]");var d=a("iframe:first",c);return a(d).attr("src")},getSelectedItemUrl:function(){var b=this.getSelectedTabItemID();return this.getItemUrl(b)},getItemByTabId:function(b){var c=this,d=this.options;return a("li[tabid="+b+"]",c.tab.links.ul)},tabItemLoad:function(d,c){var b=a(".l-tab-content-item[tabid="+d+"]");var e=a("iframe:first",b);a(e).attr("src",c)}})})(jQuery);(function(a){a.juiceMessageBox=function(b){return a.jui.run.call(null,"juiceMessageBox",arguments,{isStatic:true})};a.juiceDefaults.MessageBox={isDrag:true};a.juiceMethos.MessageBox={};a.jui.controls.MessageBox=function(b){a.jui.controls.MessageBox.base.constructor.call(this,null,b)};a.jui.controls.MessageBox.juiceExtend(a.jui.core.UIComponent,{__getType:function(){return"MessageBox"},__idPrev:function(){return"MessageBox"},_extendMethods:function(){return a.juiceMethos.MessageBox},_render:function(){var e=this,k=this.options;var f="";f+='<div class="l-messagebox">';f+='        <div class="l-messagebox-lt"></div><div class="l-messagebox-rt"></div>';f+='        <div class="l-messagebox-l"></div><div class="l-messagebox-r"></div> ';f+='        <div class="l-messagebox-image"></div>';f+='        <div class="l-messagebox-title">';f+='            <div class="l-messagebox-title-inner"></div>';f+='            <div class="l-messagebox-close"></div>';f+="        </div>";f+='        <div class="l-messagebox-content">';f+="        </div>";f+='        <div class="l-messagebox-buttons"><div class="l-messagebox-buttons-inner">';f+="        </div></div>";f+="    </div>";e.messageBox=a(f);a("body").append(e.messageBox);e.messageBox.close=function(){e._removeWindowMask();e.messageBox.remove()};k.width&&e.messageBox.width(k.width);k.title&&a(".l-messagebox-title-inner",e.messageBox).html(k.title);k.content&&a(".l-messagebox-content",e.messageBox).html(k.content);if(k.buttons){a(k.buttons).each(function(m,n){var l=a('<div class="l-messagebox-btn"><div class="l-messagebox-btn-l"></div><div class="l-messagebox-btn-r"></div><div class="l-messagebox-btn-inner"></div></div>');a(".l-messagebox-btn-inner",l).html(n.text);a(".l-messagebox-buttons-inner",e.messageBox).append(l);n.width&&l.width(n.width);n.onclick&&l.click(function(){n.onclick(n,m,e.messageBox)})});a(".l-messagebox-buttons-inner",e.messageBox).append("<div class='l-clear'></div>")}var d=e.messageBox.width();var c=0;a(".l-messagebox-buttons-inner .l-messagebox-btn",e.messageBox).each(function(){c+=a(this).width()});a(".l-messagebox-buttons-inner",e.messageBox).css({marginLeft:parseInt((d-c)*0.5)});e._applyWindowMask();e._applyDrag();e._setImage();var j=0;var h=0;var b=k.width||e.messageBox.width();if(k.left!=null){j=k.left}else{k.left=j=0.5*(a(window).width()-b)}if(k.top!=null){h=k.top}else{k.top=h=0.5*(a(window).height()-e.messageBox.height())+a(window).scrollTop()-10}if(j<0){k.left=j=0}if(h<0){k.top=h=0}e.messageBox.css({left:j,top:h});a(".l-messagebox-btn",e.messageBox).hover(function(){a(this).addClass("l-messagebox-btn-over")},function(){a(this).removeClass("l-messagebox-btn-over")});a(".l-messagebox-close",e.messageBox).hover(function(){a(this).addClass("l-messagebox-close-over")},function(){a(this).removeClass("l-messagebox-close-over")}).click(function(){e.messageBox.close()});e.set(k)},close:function(){var b=this,c=this.options;this.g._removeWindowMask();this.messageBox.remove()},_applyWindowMask:function(){var b=this,c=this.options;a(".l-window-mask").remove();a("<div class='l-window-mask' style='display: block;'></div>").appendTo(a("body"))},_removeWindowMask:function(){var b=this,c=this.options;a(".l-window-mask").remove()},_applyDrag:function(){var b=this,c=this.options;if(c.isDrag&&a.fn.juiceDrag){b.messageBox.juiceDrag({handler:".l-messagebox-title-inner",animate:false})}},_setImage:function(){var b=this,c=this.options;if(c.type){if(c.type=="success"||c.type=="donne"){a(".l-messagebox-image",b.messageBox).addClass("l-messagebox-image-donne").show();a(".l-messagebox-content",b.messageBox).css({paddingLeft:64,paddingBottom:30})}else{if(c.type=="error"){a(".l-messagebox-image",b.messageBox).addClass("l-messagebox-image-error").show();a(".l-messagebox-content",b.messageBox).css({paddingLeft:64,paddingBottom:30})}else{if(c.type=="warn"){a(".l-messagebox-image",b.messageBox).addClass("l-messagebox-image-warn").show();a(".l-messagebox-content",b.messageBox).css({paddingLeft:64,paddingBottom:30})}else{if(c.type=="question"){a(".l-messagebox-image",b.messageBox).addClass("l-messagebox-image-question").show();a(".l-messagebox-content",b.messageBox).css({paddingLeft:64,paddingBottom:40})}}}}}}});a.juiceMessageBox.show=function(b){return a.juiceMessageBox(b)};a.juiceMessageBox.alert=function(f,e,d,c){f=f||"";e=e||f;var b=function(j,h,k){k.close();if(c){c(j,h,k)}};p={title:f,content:e,buttons:[{text:"确定",onclick:b}]};if(d){p.type=d}return a.juiceMessageBox(p)};a.juiceMessageBox.confirm=function(d,c,e){var b=function(h,f,j){j.close();if(e){e(f==0)}};p={type:"question",title:d,content:c,buttons:[{text:"是",onclick:b},{text:"否",onclick:b}]};return a.juiceMessageBox(p)};a.juiceMessageBox.success=function(d,c,b){return a.juiceMessageBox.alert(d,c,"success",b)};a.juiceMessageBox.error=function(d,c,b){return a.juiceMessageBox.alert(d,c,"error",b)};a.juiceMessageBox.warn=function(d,c,b){return a.juiceMessageBox.alert(d,c,"warn",b)};a.juiceMessageBox.question=function(c,b){return a.juiceMessageBox.alert(c,b,"question")}})(jQuery);(function(a){a.fn.juiceMenuBar=function(b){return a.jui.run.call(this,"juiceMenuBar",arguments)};a.fn.juiceGetMenuBarManager=function(){return a.jui.run.call(this,"juiceGetMenuBarManager",arguments)};a.juiceDefaults.MenuBar={};a.juiceMethos.MenuBar={};a.jui.controls.MenuBar=function(c,b){a.jui.controls.MenuBar.base.constructor.call(this,c,b)};a.jui.controls.MenuBar.juiceExtend(a.jui.core.UIComponent,{__getType:function(){return"MenuBar"},__idPrev:function(){return"MenuBar"},_extendMethods:function(){return a.juiceMethos.MenuBar},_render:function(){var b=this,c=this.options;b.menubar=a(this.element);if(!b.menubar.hasClass("l-menubar")){b.menubar.addClass("l-menubar")}if(c&&c.items){a(c.items).each(function(d,e){b.addItem(e)})}a(document).click(function(){a(".l-panel-btn-selected",b.menubar).removeClass("l-panel-btn-selected")});b.set(c)},addItem:function(d){var c=this,e=this.options;var b=a('<div class="l-menubar-item l-panel-btn"><span></span><div class="l-panel-btn-l"></div><div class="l-panel-btn-r"></div><div class="l-menubar-item-down"></div></div>');c.menubar.append(b);d.id&&b.attr("menubarid",d.id);d.text&&a("span:first",b).html(d.text);d.disable&&b.addClass("l-menubar-item-disable");d.click&&b.click(function(){d.click(d)});if(d.menu){var f=a.juiceMenu(d.menu);b.hover(function(){c.actionMenu&&c.actionMenu.hide();var j=a(this).offset().left;var h=a(this).offset().top+a(this).height();f.show({top:h,left:j});c.actionMenu=f;a(this).addClass("l-panel-btn-over l-panel-btn-selected").siblings(".l-menubar-item").removeClass("l-panel-btn-selected")},function(){a(this).removeClass("l-panel-btn-over")})}else{b.hover(function(){a(this).addClass("l-panel-btn-over")},function(){a(this).removeClass("l-panel-btn-over")});a(".l-menubar-item-down",b).remove()}}})})(jQuery);(function(a){a.juiceMenu=function(b){return a.jui.run.call(null,"juiceMenu",arguments)};a.juiceDefaults.Menu={width:120,top:0,left:0,items:null,selfClose:false,shadow:true};a.juiceMethos.Menu={};a.jui.controls.Menu=function(b){a.jui.controls.Menu.base.constructor.call(this,null,b)};a.jui.controls.Menu.juiceExtend(a.jui.core.UIComponent,{__getType:function(){return"SysMenu"},__idPrev:function(){return"SysMenu"},_extendMethods:function(){return a.juiceMethos.Menu},_render:function(){var b=this,c=this.options;b.menuItemCount=0;b.menus={};b.menu=b.createMenu();b.element=b.menu[0];b.menu.css({top:c.top,left:c.left,width:c.width});c.items&&a(c.items).each(function(d,e){b.addItem(e)});a(document).bind("click.menu",function(j){var h=(j.target||j.srcElement);var d=a(h).parents().add(h);for(var f in b.menus){var k=b.menus[f];if(d.index(k)!=-1&&a(".l-checkbox",k.items).length>0){return false}}for(var f in b.menus){var k=b.menus[f];if(!k){return}k.hide();if(k.shadow){k.shadow.hide()}}});b.set(c)},show:function(b,e){var c=this,d=this.options;if(e==undefined){e=c.menu}if(b&&b.left!=undefined){e.css({left:b.left})}if(b&&b.top!=undefined){e.css({top:b.top})}e.show();c.updateShadow(e)},updateShadow:function(d){var b=this,c=this.options;if(!c.shadow){return}d.shadow.css({left:d.css("left"),top:d.css("top"),width:d.outerWidth(),height:d.outerHeight()});if(d.is(":visible")){d.shadow.show()}else{d.shadow.hide()}},hide:function(d){var b=this,c=this.options;if(d==undefined){d=b.menu}b.hideAllSubMenu(d);d.hide();b.updateShadow(d)},toggle:function(){var b=this,c=this.options;b.menu.toggle();b.updateShadow(b.menu)},removeItem:function(c){var b=this,d=this.options;a("> .l-menu-item[menuitemid="+c+"]",b.menu.items).remove()},setEnabled:function(c){var b=this,d=this.options;a("> .l-menu-item[menuitemid="+c+"]",b.menu.items).removeClass("l-menu-item-disable")},setDisabled:function(c){var b=this,d=this.options;a("> .l-menu-item[menuitemid="+c+"]",b.menu.items).addClass("l-menu-item-disable")},isEnable:function(c){var b=this,d=this.options;return !a("> .l-menu-item[menuitemid="+c+"]",b.menu.items).hasClass("l-menu-item-disable")},getItemCount:function(){var b=this,c=this.options;return a("> .l-menu-item",b.menu.items).length},addItem:function(e,h){var d=this,f=this.options;if(!e){return}if(h==undefined){h=d.menu}d._items=d._items||{};if(e.line){h.items.append('<div class="l-menu-item-line"></div>');return}var b=a('<div class="l-menu-item"><div class="l-menu-item-text"></div> </div>');var c=a("> .l-menu-item",h.items).length;h.items.append(b);b.attr("juimenutemid",++d.menuItemCount);e.id=(e.id?e.id:"_Menu_"+d.menuItemCount);b.attr("menuitemid",e.id);b.attr("parentid",e.parentId||("parent_"+d.menuItemCount));b.attr("parentMenuId",e.parentMenuId||-1);e.checkbox&&b.prepend('<div>&nbsp;<a class="l-checkbox '+(e.checked?"l-checkbox-checked":"")+'"/></div>');e.text&&a(">.l-menu-item-text:first",b).html(e.text);e.icon&&b.prepend('<div class="l-menu-item-icon l-icon-'+e.icon+'"></div>');d._items[e.id]=e;if(e.disable||e.disabled){b.addClass("l-menu-item-disable")}if(e.children){b.append('<div class="l-menu-item-arrow"></div>');var k=d.createMenu(b.attr("juimenutemid"));d.menus[b.attr("juimenutemid")]=k;k.width(f.width);k.hover(null,function(){if(!k.showedSubMenu){d.hide(k)}});a(e.children).each(function(){this.parentId=e.id;this.parentMenuId=d.menuItemCount;d.addItem(this,k)})}e.click&&b.click(function(){if(a(this).hasClass("l-menu-item-disable")){return}if(e.checkbox){var o=a(".l-checkbox",this).hasClass("l-checkbox-checked");var n=d.getParentItems(a(this));var l=d.getChildItems(a(this)).reverse();var m=l.concat(n);if(o){a(m.reverse()).each(function(){if(a(this).attr("parentMenuId")=="-1"&&a(".l-checkbox-checked",a(this).parent()).length==1){return false}a(".l-checkbox",this).removeClass("l-checkbox-checked");var q=d.getItemById(a(this).attr("menuitemid"));q.checked=false;q.click(q,c)})}else{a(m).each(function(){a(".l-checkbox",this).addClass("l-checkbox-checked");var q=d.getItemById(a(this).attr("menuitemid"));q.checked=true;q.click(q,c)})}}else{e.click(e,c,b)}});e.dblclick&&b.dblclick(function(){if(a(this).hasClass("l-menu-item-disable")){return}e.dblclick(e,c)});var j=a("> .l-menu-over:first",h);b.hover(function(){if(a(this).hasClass("l-menu-item-disable")){return}var m=a(this).offset().top;var n=m-h.offset().top;j.css({top:n});d.hideAllSubMenu(h);if(e.children){var l=a(this).attr("juimenutemid");if(!l){return}if(d.menus[l]){d.show({top:m,left:a(this).offset().left+a(this).width()-5},d.menus[l]);h.showedSubMenu=true}}},function(){if(a(this).hasClass("l-menu-item-disable")){return}var l=a(this).attr("juimenutemid");if(e.children){var l=a(this).attr("juimenutemid");if(!l){return}}})},getItemById:function(d){var b=this,c=this.options;return b._items[d]},getParentItems:function(d,c){var f=this,h=this.options;if(!c){c=new Array()}c.push(d);var e=a(".l-checkbox-checked",d.parent());if(e.length==1||e.length==0){var k=d.attr("parentId");if(k){for(var j in f.menus){var b=a("div[menuitemid='"+k+"']",f.menus[j]);if(b.length>0){f.getParentItems(b,c)}}}}return c},getChildItems:function(c,b){var e=this,f=this.options;if(!b){b=new Array()}if(e.menus[c.attr("juimenutemid")]){var d=a(".l-menu-item",e.menus[c.attr("juimenutemid")].items);if(d.length>0){d.each(function(h){b.push(a(this));e.getChildItems(a(this),b)})}}return b},hideAllSubMenu:function(d){var b=this,c=this.options;if(d==undefined){d=b.menu}a("> .l-menu-item",d.items).each(function(){if(a("> .l-menu-item-arrow",this).length>0){var e=a(this).attr("juimenutemid");if(!e){return}b.menus[e]&&b.hide(b.menus[e])}});d.showedSubMenu=false},createMenu:function(c){var b=this,d=this.options;var e=a('<div class="l-menu" style="display:none"><div class="l-menu-yline"></div><div class="l-menu-over"><div class="l-menu-over-l"></div> <div class="l-menu-over-r"></div></div><div class="l-menu-inner"></div></div>');c&&e.attr("juiparentmenuitemid",c);e.items=a("> .l-menu-inner:first",e);e.appendTo("body");if(d.shadow){e.shadow=a('<div class="l-menu-shadow"></div>').insertAfter(e);b.updateShadow(e)}e.hover(null,function(){if(!e.showedSubMenu){a("> .l-menu-over:first",e).css({top:-24})}});if(c){b.menus[c]=e}else{b.menus[0]=e}return e}});a.jui.controls.Menu.prototype.setEnable=a.jui.controls.Menu.prototype.setEnabled;a.jui.controls.Menu.prototype.setDisable=a.jui.controls.Menu.prototype.setDisabled})(jQuery);(function(a){a.fn.juicePanel=function(b){return a.jui.run.call(this,"juicePanel",arguments)};a.fn.juiceGetPanelManager=function(){return a.jui.run.call(this,"juiceGetPanelManager",arguments)};a.juiceDefaults=a.juiceDefaults||{};a.juiceDefaults.Panel={width:"100%",height:"auto",closeAble:true,draggable:true,onBeforeClose:null,onAfterClose:null,top:0,left:0,items:null,url:"",title:"",selfClose:false,icon:"",shadow:true};a.juiceMethos.Panel={};a.jui.controls.Panel=function(c,b){a.jui.controls.Panel.base.constructor.call(this,c,b)};a.jui.controls.Panel.juiceExtend(a.jui.core.UIComponent,{__getType:function(){return"Panel"},__idPrev:function(){return"Panel"},_extendMethods:function(){return a.juiceMethos.Panel},_init:function(){a.jui.controls.Panel.base._init.call(this);var b=this,c=this.options;this._copyProperty(c,a(this.element))},_render:function(){var b=this,c=this.options;b.content=a(b.element);var d=[];d.push("　　<div class='l-panel'>");d.push("        <div class='l-panel-header'><div class='panel-toggle-default'/><div class='panel-closed-defalut'/><div class='l-panel-icon-default'></div><span class='l-panel-header-text'></span></div>");d.push("        <div class='l-grid-loading'></div>");d.push("        <div class='l-panel-content'></div>");d.push("    </div>");b.panel=a(d.join(""));b.panel.insertBefore(b.content);b.contantPanel=a(".l-panel-content",b.panel);b.contantPanel.append(b.content);b._build();b._initSize();b._setEvent()},_build:function(){var b=this,c=this.options;b._initHeader();if(c.url){b._setUrl(c.url)}},_initHeader:function(){var b=this,c=this.options;if(c.collapse){a(".panel-toggle-default",b.panel).addClass("panel-toggle")}if(c.closeAble){a(".panel-closed-defalut",b.panel).addClass("panel-closed l-panel-close")}else{a(".panel-toggle-default",b.panel).css({right:"3px"})}if(c.title){a(".l-panel-header-text",b.panel).html(c.title)}if(c.icon){a(".l-panel-icon-default",b.panel).addClass("l-panel-icon l-icon-"+c.icon);a(".l-panel-header-text").css({left:"20px",position:"absolute"})}},_initSize:function(){var b=this,c=this.options;if(b.content.width()){b.contantPanel.width(b.content.width());b.panel.width(b.content.width())}else{b.contantPanel.width(c.width);b.panel.width(c.width)}if(b.content.height()||c.height=="auto"){b.contantPanel.height(b.content.height())}else{b.contantPanel.height(c.height)}},_setEvent:function(){var b=this,c=this.options;a(".panel-toggle",b.panel).toggle(function(){a(".panel-toggle-default",b.panel).addClass("panel-toggle-down");b.contantPanel.hide()},function(){a(".panel-toggle-default",b.panel).removeClass("panel-toggle-down");b.contantPanel.show()});a(".l-panel-close",b.panel).click(function(){b.trigger("beforeClose",[]);b.panel.remove();b.trigger("afterClose",[])});a(window).bind("resize.panel",function(d){b._onResize.call(b)})},_setWidth:function(c){var b=this,d=this.options;d.width=c;b.panel.width(c)},setWidth:function(b){this._setWidth(b)},_onResize:function(){var b=this,c=this.options;b._setWidth(b.panel.parent().width())},_setUrl:function(b){}})})(jQuery);(function($){var l=$.jui;$.fn.juiceGrid=function(options){return $.jui.run.call(this,"juiceGrid",arguments)};$.fn.juiceGetGridManager=function(){return $.jui.run.call(this,"juiceGetGridManager",arguments)};$.juiceDefaults.Grid={title:"",width:"auto",height:"auto",columnWidth:null,resizable:true,url:"",usePager:true,page:1,pageSize:15,pageSizeOptions:[15,30,50],parms:[],columns:[],toggleAble:true,minColToggle:1,dataType:"server",data:null,dataAction:"server",showTableToggleBtn:false,switchPageSizeApplyComboBox:false,allowAdjustColWidth:true,checkbox:false,allowHideColumn:true,enabledEdit:false,isScroll:true,onDragCol:null,onToggleCol:null,onChangeSort:null,onSuccess:null,onDblClickRow:null,onSelectRow:null,onUnSelectRow:null,onBeforeCheckRow:null,onCheckRow:null,onBeforeCheckAllRow:null,onCheckAllRow:null,onBeforeShowData:null,onAfterShowData:null,onError:null,onSubmit:null,dateFormat:"yyyy-MM-dd",InWindow:true,statusName:"__status",method:"post",async:true,dataTransform:null,fixedCellHeight:true,heightDiff:0,cssClass:null,root:"Rows",record:"Total",pageParmName:"page",pagesizeParmName:"pageSize",sortnameParmName:"sortname",sortorderParmName:"sortorder",onReload:null,onToFirst:null,onToPrev:null,onToNext:null,onToLast:null,allowUnSelectRow:false,alternatingRow:true,mouseoverRowCssClass:"l-grid-row-over",enabledSort:true,rowAttrRender:null,groupColumnName:"",groupColumnDisplay:"分组",groupRender:null,totalRender:null,delayLoad:false,where:null,selectRowButtonOnly:false,onAfterAddRow:null,onBeforeEdit:null,onBeforeSubmitEdit:null,onAfterEdit:null,onLoading:null,onLoaded:null,onContextmenu:null,onRClickToSelect:false,contentType:null,checkboxColWidth:27,detailColWidth:29,clickToEdit:true,detailToEdit:false,onEndEdit:null,onDblClickRow:null,minColumnWidth:80,tree:null,isChecked:null,frozen:true,frozenDetail:false,frozenCheckbox:true,detailHeight:260,rownumbers:false,frozenRownumbers:true,rownumbersColWidth:26,colDraggable:false,rowDraggable:false,rowDraggingRender:null,autoCheckChildren:true,onRowDragDrop:null,rowHeight:22,headerRowHeight:23,toolbar:null,headerImg:null,detail:null,showHeadMenu:true,showAddButton:true};$.juiceDefaults.GridString={errorMessage:"发生错误",pageStatMessage:"当前显示{from}-{to}条，共{total}条",pageTextMessage:"Page",loadingMessage:"加载中...",findTextMessage:"查找",noRecordMessage:"没有符合条件的记录存在",isContinueByDataChanged:"数据已经改变,如果继续将丢失数据,是否继续?",cancelMessage:"取消",saveMessage:"保存",applyMessage:"应用",draggingMessage:"{count}行"};$.juiceMethos.Grid=$.juiceMethos.Grid||{};$.juiceDefaults.Grid.sorters=$.juiceDefaults.Grid.sorters||{};$.juiceDefaults.Grid.formatters=$.juiceDefaults.Grid.formatters||{};$.juiceDefaults.Grid.editors=$.juiceDefaults.Grid.editors||{};$.juiceDefaults.Grid.sorters.date=function(val1,val2){return val1<val2?-1:val1>val2?1:0};$.juiceDefaults.Grid.sorters["int"]=function(val1,val2){return parseInt(val1)<parseInt(val2)?-1:parseInt(val1)>parseInt(val2)?1:0};$.juiceDefaults.Grid.sorters["float"]=function(val1,val2){return parseFloat(val1)<parseFloat(val2)?-1:parseFloat(val1)>parseFloat(val2)?1:0};$.juiceDefaults.Grid.sorters.string=function(val1,val2){return val1.localeCompare(val2)};$.juiceDefaults.Grid.formatters["float"]=$.juiceDefaults.Grid.formatters["int"]=$.juiceDefaults.Grid.formatters.text=function(value,column){var format=column.decimalFormat;if(format&&(0!=value)&&value){var ret=$.jui.uitl.numberFormat(value,format);var prefix=format.match(/^([^\d]+)/g);var subfix=format.match(/([^\d]+)$/g);if(prefix!=null){ret=prefix+ret}if(subfix!=null){ret+=subfix}return ret}return value};$.juiceDefaults.Grid.formatters.date=function(value,column){function getFormatDate(date,dateformat){var g=this,p=this.options;if(isNaN(date)){return null}var format=dateformat;var o={"M+":date.getMonth()+1,"d+":date.getDate(),"h+":date.getHours(),"m+":date.getMinutes(),"s+":date.getSeconds(),"q+":Math.floor((date.getMonth()+3)/3),S:date.getMilliseconds()};if(/(y+)/.test(format)){format=format.replace(RegExp.$1,(date.getFullYear()+"").substr(4-RegExp.$1.length))}for(var k in o){if(new RegExp("("+k+")").test(format)){format=format.replace(RegExp.$1,RegExp.$1.length==1?o[k]:("00"+o[k]).substr((""+o[k]).length))}}return format}if(!value){return""}if(typeof(value)=="string"&&/^\/Date/.test(value)){value=value.replace(/^\//,"new ").replace(/\/$/,"");eval("value = "+value)}else{value=new Date(value)}if(value instanceof Date){var format=column.dateFormat||this.options.dateFormat||"yyyy-MM-dd";return getFormatDate(value,format)}else{return value.toString()}};$.juiceDefaults.Grid.editors.date={create:function(container,editParm){var column=editParm.column;var input=$("<input type='text'/>");container.append(input);var options={};var ext=column.editor.p||column.editor.ext;if(ext){var tmp=typeof(ext)=="function"?ext(editParm.record,editParm.rowindex,editParm.value,column):ext;$.extend(options,tmp)}this.box=input.juiceDateEditor(options);return input},getValue:function(input,editParm){return input.juice("option","value")},setValue:function(input,value,editParm){input.juice("option","value",value)},resize:function(input,width,height,editParm){input.juice("option","width",width);input.juice("option","height",height)},destroy:function(input,editParm){input.juice("destroy")}};$.juiceDefaults.Grid.editors.select=$.juiceDefaults.Grid.editors.combobox={create:function(container,editParm){var column=editParm.column;var input=$("<input type='text'/>");container.append(input);var options={slide:false,onBeforeEditor:column.editor.onBeforeEditor,valueField:column.editor.valueField||column.editor.valueColumnName,textField:column.editor.textField||column.editor.displayColumnName};this.options=$.extend(true,options,column.editor);var ext=column.editor.p||column.editor.ext;if(ext){var tmp=typeof(ext)=="function"?ext(editParm.record,editParm.rowindex,editParm.value,column):ext;$.extend(options,tmp)}if(options.onBeforeEditor){options.onBeforeEditor.call(this,options,editParm.record)}this.box=input.juiceComboBox(options);return input},getValue:function(input,editParm){var value=input.juice("option","value");editParm.record[this.options.textField]=this.box.selectedText||"";if(this.options.onAfterEditor&&this.value!=value){this.options.onAfterEditor.call(this,editParm.record)}return value},setValue:function(input,value,editParm){this.value=value;input.juice("option","value",value)},getData:function(){return this.box.data},resize:function(input,width,height,editParm){input.juice("option","width",width);this.box.selectBox.width(width);input.juice("option","height",height)},destroy:function(input,editParm){input.juice("destroy")}};$.juiceDefaults.Grid.editors.tree={create:function(container,editParm){var column=editParm.column;var input=$("<input type='text'/>");container.append(input);var options={slide:false,valueField:column.editor.valueField||"id",textField:column.editor.textField||"text",valueColumnName:column.editor.valueColumnName||column.name,displayColumnName:column.editor.displayColumnName||column.name+"_text"};options=$.extend(true,options,column.editor);var ext=column.editor.p||column.editor.ext;if(ext){var tmp=typeof(ext)=="function"?ext(editParm.record,editParm.rowindex,editParm.value,column):ext;$.extend(options,tmp)}this.box=input.juiceComboBox(options);this.options=options;return input},getValue:function(input,editParm){var value=input.juice("option","value");editParm.record[this.options.displayColumnName]=this.box.selectedText||"";return value},setValue:function(input,value,editParm){input.juice("option","value",value)},resize:function(input,width,height,editParm){input.juice("option","width",width);this.box.selectBox.width(width);input.juice("option","height",height)},destroy:function(input,editParm){input.juice("destroy")}};$.juiceDefaults.Grid.editors.grid={create:function(container,editParm){var column=editParm.column;var input=$("<input type='text'/>");container.append(input);var options={slide:false,initText:editParm.record[column.editor.textField],valueField:column.editor.valueField||"id",textField:column.editor.textField||"text",valueColumnName:column.editor.valueField||column.name,displayColumnName:column.editor.textField||column.name+"_text"};options=$.extend(true,options,column.editor);var ext=column.editor.p||column.editor.ext;if(ext){var tmp=typeof(ext)=="function"?ext(editParm.record,editParm.rowindex,editParm.value,column):ext;$.extend(options,tmp)}this.box=input.juiceComboBox(options);this.options=options;return input},getValue:function(input,editParm){var value=this.box.selectedValue;editParm.record[this.options.displayColumnName]=this.box.selectedText||"";if(this.options.onAfterEditor&&this.value!=value&&this.box.selectedRow){this.options.onAfterEditor.call(this,editParm.record,this.box.selectedRow)}return value},setValue:function(input,value,editParm){input.juice("option","value",value)},getData:function(){return this.box.gridManager.data},resize:function(input,width,height,editParm){input.juice("option","width",width);input.juice("option","height",height)},destroy:function(input,editParm){input.juice("destroy")}};$.juiceDefaults.Grid.editors["int"]=$.juiceDefaults.Grid.editors["float"]=$.juiceDefaults.Grid.editors.spinner={create:function(container,editParm){var column=editParm.column;var input=$("<input type='text'/>");container.append(input);input.css({border:"#6E90BE"});var options={type:column.editor.type=="float"?"float":"int"};if(column.editor.minValue!=undefined){options.minValue=column.editor.minValue}if(column.editor.maxValue!=undefined){options.maxValue=column.editor.maxValue}input.juiceSpinner(options);return input},getValue:function(input,editParm){var column=editParm.column;var isInt=column.editor.type=="int";if(input.val()){if(isInt){return parseInt(input.val(),10)}else{return parseFloat(input.val())}}},setValue:function(input,value,editParm){input.val(value)},resize:function(input,width,height,editParm){input.juice("option","width",width);input.juice("option","height",height)},destroy:function(input,editParm){input.juice("destroy")}};$.juiceDefaults.Grid.editors.string=$.juiceDefaults.Grid.editors.text={create:function(container,editParm){var input=$("<input type='text' class='l-text-editing'/>");container.append(input);input.juiceTextBox();return input},getValue:function(input,editParm){return input.val()},setValue:function(input,value,editParm){input.val(value)},resize:function(input,width,height,editParm){input.juice("option","width",width);input.juice("option","height",height)},destroy:function(input,editParm){input.juice("destroy")}};$.juiceDefaults.Grid.editors.chk=$.juiceDefaults.Grid.editors.checkbox={create:function(container,editParm){var input=$("<input type='checkbox' />");container.append(input);input.juiceCheckBox();return input},getValue:function(input,editParm){return input[0].checked?1:0},setValue:function(input,value,editParm){input.val(value?true:false)},resize:function(input,width,height,editParm){input.juice("option","width",width);input.juice("option","height",height)},destroy:function(input,editParm){input.juice("destroy")}};$.jui.controls.Grid=function(element,options){$.jui.controls.Grid.base.constructor.call(this,element,options)};$.jui.controls.Grid.juiceExtend($.jui.core.UIComponent,{__getType:function(){return"$.jui.controls.Grid"},__idPrev:function(){return"grid"},_extendMethods:function(){return $.juiceMethos.Grid},_init:function(){$.jui.controls.Grid.base._init.call(this);var g=this,p=this.options;$.jui.controls.Grid.createParams(p,$(this.element));p.dataType=(p.url)?"server":"local";if(p.dataType=="local"){p.data=p.data||[];p.dataAction="local"}if(p.isScroll==false){p.height="auto"}if(!p.frozen){p.frozenCheckbox=false;p.frozenDetail=false;p.frozenRownumbers=false}if(p.detailToEdit){p.enabledEdit=true;p.clickToEdit=false;p.detail={height:"auto",onShowDetail:function(record,container,callback){$(container).addClass("l-grid-detailpanel-edit");g.beginEdit(record,function(rowdata,column){var editContainer=$("<div class='l-editbox'></div>");editContainer.width(120).height(p.rowHeight+1);editContainer.appendTo(container);return editContainer});function removeRow(){$(container).parent().parent().remove();g.collapseDetail(record)}$("<div class='l-clear'></div>").appendTo(container);$("<div class='l-button'>"+p.saveMessage+"</div>").appendTo(container).click(function(){g.endEdit(record);removeRow()});$("<div class='l-button'>"+p.applyMessage+"</div>").appendTo(container).click(function(){g.submitEdit(record)});$("<div class='l-button'>"+p.cancelMessage+"</div>").appendTo(container).click(function(){g.cancelEdit(record);removeRow()})}}}if(p.tree){p.tree.childrenName=p.tree.childrenName||"children";p.tree.isParent=p.tree.isParent||function(rowData){var exist=p.tree.childrenName in rowData;return exist};p.tree.isExtend=p.tree.isExtend||function(rowData){if("isextend" in rowData&&rowData.isextend==false){return false}return true}}g.editorDatas={}},_render:function(){var g=this,p=this.options;g.grid=$(g.element);g.grid.addClass("l-panel");var gridhtmlarr=[];gridhtmlarr.push("        <div class='l-panel-header'><div class='grid-panel-title'></div><div class='grid-up-toggle'/><div class='grid-down-toggle' style='display: none'/><span class='l-panel-header-text'></span></div>");gridhtmlarr.push("                    <div class='l-grid-loading'></div>");gridhtmlarr.push("        <div class='l-panel-topbar'></div>");gridhtmlarr.push("        <div class='l-panel-bwarp'>");gridhtmlarr.push("            <div class='l-panel-body'>");gridhtmlarr.push("                <div class='l-grid'>");gridhtmlarr.push("                    <div class='l-grid-dragging-line'></div>");gridhtmlarr.push("                    <div class='l-grid-popup'><table cellpadding='0' cellspacing='0'><tbody></tbody></table></div>");gridhtmlarr.push("                  <div class='l-grid1'>");gridhtmlarr.push("                      <div class='l-grid-header l-grid-header1'>");gridhtmlarr.push("                          <div class='l-grid-header-inner'><table class='l-grid-header-table' cellpadding='0' cellspacing='0'><tbody></tbody></table></div>");gridhtmlarr.push("                      </div>");gridhtmlarr.push("                      <div class='l-grid-body l-grid-body1'>");gridhtmlarr.push("                      </div>");gridhtmlarr.push("                  </div>");gridhtmlarr.push("                  <div class='l-grid2'>");gridhtmlarr.push("                      <div class='l-grid-header l-grid-header2'>");gridhtmlarr.push("                          <div class='l-grid-header-inner'><table class='l-grid-header-table' cellpadding='0' cellspacing='0'><tbody></tbody></table></div>");gridhtmlarr.push("                      </div>");gridhtmlarr.push("                      <div class='l-grid-body l-grid-body2 l-scroll'>");gridhtmlarr.push("                      </div>");gridhtmlarr.push("                  </div>");gridhtmlarr.push("                 </div>");gridhtmlarr.push("              </div>");gridhtmlarr.push("         </div>");gridhtmlarr.push("         <div class='l-panel-bar'>");gridhtmlarr.push("            <div class='l-panel-bbar-inner'>");gridhtmlarr.push("                <div class='l-bar-group  l-bar-message'><span class='l-bar-text'></span></div>");gridhtmlarr.push("            <div class='l-bar-group l-bar-selectpagesize'></div>");gridhtmlarr.push("                <div class='l-bar-separator'></div>");gridhtmlarr.push("                <div class='l-bar-group'>");gridhtmlarr.push("                    <div class='l-bar-button l-bar-btnfirst'><span></span></div>");gridhtmlarr.push("                    <div class='l-bar-button l-bar-btnprev'><span></span></div>");gridhtmlarr.push("                </div>");gridhtmlarr.push("                <div class='l-bar-separator'></div>");gridhtmlarr.push("                <div class='l-bar-group'><span class='pcontrol'> <input type='text' size='4' value='1' style='width:20px' maxlength='3' /> / <span></span></span></div>");gridhtmlarr.push("                <div class='l-bar-separator'></div>");gridhtmlarr.push("                <div class='l-bar-group'>");gridhtmlarr.push("                     <div class='l-bar-button l-bar-btnnext'><span></span></div>");gridhtmlarr.push("                    <div class='l-bar-button l-bar-btnlast'><span></span></div>");gridhtmlarr.push("                </div>");gridhtmlarr.push("                <div class='l-bar-separator'></div>");gridhtmlarr.push("                <div class='l-bar-group'>");gridhtmlarr.push("                     <div class='l-bar-button l-bar-btnload'><span></span></div>");gridhtmlarr.push("                </div>");gridhtmlarr.push("                <div class='l-bar-separator'></div>");gridhtmlarr.push("                <div class='l-bar-group'>");gridhtmlarr.push("                     <div class='l-bar-button l-icon-add-default'><span></span></div>");gridhtmlarr.push("                </div>");gridhtmlarr.push("                <div class='l-bar-separator-default'></div>");gridhtmlarr.push("                <div class='l-clear'></div>");gridhtmlarr.push("            </div>");gridhtmlarr.push("         </div>");g.grid.html(gridhtmlarr.join(""));g.header=$(".l-panel-header:first",g.grid);g.body=$(".l-panel-body:first",g.grid);g.toolbar=$(".l-panel-bar:first",g.grid);g.popup=$(".l-grid-popup:first",g.grid);g.gridloading=$(".l-grid-loading:first",g.grid);g.draggingline=$(".l-grid-dragging-line",g.grid);g.topbar=$(".l-panel-topbar:first",g.grid);g.gridview=$(".l-grid:first",g.grid);g.gridview.attr("id",g.id+"grid");g.gridview1=$(".l-grid1:first",g.gridview);g.gridview2=$(".l-grid2:first",g.gridview);g.gridheader=$(".l-grid-header:first",g.gridview2);g.gridbody=$(".l-grid-body:first",g.gridview2);g.f={};g.f.gridheader=$(".l-grid-header:first",g.gridview1);g.f.gridbody=$(".l-grid-body:first",g.gridview1);g.currentData=null;g.changedCells={};g.editors={};g.editor={editing:false};if(p.height=="auto"){g.bind("SysGridHeightChanged",function(){if(g.enabledFrozen()){g.gridview.height(Math.max(g.gridview1.height(),g.gridview2.height()))}})}var pc=$.extend({},p);this._bulid();this._setColumns(p.columns);delete pc.columns;delete pc.data;delete pc.url;g.set(pc);if(!p.delayLoad){if(p.data){g.set({data:p.data})}else{if(p.url){g.set({url:p.url})}}}},_setFrozen:function(frozen){if(frozen){this.grid.addClass("l-frozen")}else{this.grid.removeClass("l-frozen")}},_setCssClass:function(value){this.grid.addClass(value)},_setLoadingMessage:function(value){this.gridloading.html(value)},_setHeight:function(h){var g=this,p=this.options;g.unbind("SysGridHeightChanged");if(h=="auto"){g.bind("SysGridHeightChanged",function(){if(g.enabledFrozen()){g.gridview.height(Math.max(g.gridview1.height(),g.gridview2.height()))}});return}if(typeof h=="string"&&h.indexOf("%")>0){if(p.inWindow){h=$(window).height()*parseFloat(h)*0.01}else{h=g.grid.parent().height()*parseFloat(h)*0.01}}if(p.title){h-=24}if(p.usePager){h-=32}if(p.totalRender){h-=25}if(p.toolbar){h-=g.topbar.outerHeight()}var gridHeaderHeight=p.headerRowHeight*(g._columnMaxLevel-1)+p.headerRowHeight-1;h-=(gridHeaderHeight);if(h>0){g.gridbody.height(h-2);if(h>18){g.f.gridbody.height(h-18)}g.gridview.height(h+gridHeaderHeight)}},_updateFrozenWidth:function(){var g=this,p=this.options;if(g.enabledFrozen()){g.gridview1.width(g.f.gridtablewidth);var view2width=g.gridview.width()-g.f.gridtablewidth;g.gridview2.css({left:g.f.gridtablewidth});if(view2width>0){g.gridview2.css({width:view2width})}}},_setWidth:function(value){var g=this,p=this.options;if(g.enabledFrozen()){g._onResize()}},_setUrl:function(value){this.options.url=value;if(value){this.options.dataType="server";this.loadData(true)}else{this.options.dataType="local"}},_setData:function(value){this.loadData(this.options.data)},loadColumnData:function(){var g=this,p=this.options;g._loadColumnData()},_loadColumnData:function(){var g=this,p=this.options;$(g.columns).each(function(i,column){if(column.editor&&(column.editor.type=="select"||column.editor.type=="combobox")){g.editorDatas[column.name]=null;if(column.editor.url){var options={type:"post",url:column.editor.url,cache:false,dataType:"json",success:function(data){if($.juiceMethos.ComboBox.dataTransform){data=$.juiceMethos.ComboBox.dataTransform(data)}g.editorDatas[column.name]=data}};$.jui.ajaxQueue.offer(options)}else{if(column.editor.data){g.editorDatas[column.name]=column.editor.data}}}})},_renderColumn:function(data){var g=this,p=this.options;var columnStore={};$(g.columns).each(function(i,column){if(column.editor&&(column.editor.type=="select"||column.editor.type=="combobox")){columnStore[column.name]={};columnStore[column.name]["textField"]=column.editor.textField;columnStore[column.name]["valueField"]=column.editor.valueField}});var renderData={};for(var ekey in g.editorDatas){renderData[ekey]={};$(g.editorDatas[ekey]).each(function(i,item){renderData[ekey][item[columnStore[ekey]["valueField"]]+""]=item[columnStore[ekey]["textField"]]})}var rows=data[p.root];if(rows){for(var i=0;i<rows.length;i++){for(var key in rows[i]){if(renderData[key]){var text=renderData[key][rows[i][key]];rows[i][columnStore[key]["textField"]+""]=text}}}}},loadData:function(loadDataParm){var g=this,p=this.options;g.loading=true;var clause=null;var loadServer=true;g._loadColumnData();if(typeof(loadDataParm)=="function"){clause=loadDataParm;loadServer=false}else{if(typeof(loadDataParm)=="boolean"){loadServer=loadDataParm}else{if(typeof(loadDataParm)=="object"&&loadDataParm){loadServer=false;p.dataType="local";p.data=loadDataParm}}}if(!p.newPage){p.newPage=1}if(p.dataAction=="server"){if(!p.sortOrder){p.sortOrder="asc"}}if(g.initParams){g.initParams(p)}var param=[];if(p.parms){if(p.parms.length){$(p.parms).each(function(){param.push({name:this.name,value:this.value})})}else{if(typeof p.parms=="object"){for(var name in p.parms){param.push({name:name,value:p.parms[name]})}}}}if(p.dataAction=="server"){if(p.usePager){param.push({name:p.pageParmName,value:p.newPage});param.push({name:p.pagesizeParmName,value:p.pageSize})}if(p.sortName){param.push({name:p.sortnameParmName,value:p.sortName});param.push({name:p.sortorderParmName,value:p.sortOrder})}}$(".l-bar-btnload span",g.toolbar).addClass("l-disabled");if(p.dataType=="local"){g.filteredData=g.data=p.data;if(clause){g.filteredData[p.root]=g._searchData(g.filteredData[p.root],clause)}if(p.usePager){g.currentData=g._getCurrentPageData(g.filteredData)}else{g.currentData=g.filteredData}g._showData()}else{if(p.dataAction=="local"&&!loadServer){if(g.data&&g.data[p.root]){g.filteredData=g.data;if(clause){g.filteredData[p.root]=g._searchData(g.filteredData[p.root],clause)}g.currentData=g._getCurrentPageData(g.filteredData);g._showData()}}else{g.loadServerData(param,clause)}}g.loading=false},loadServerData:function(param,clause){var g=this,p=this.options;var ajaxOptions={type:p.method,url:p.url,data:param,async:p.async,dataType:"json",beforeSend:function(){if(g.hasBind("loading")){g.trigger("loading")}else{g.toggleLoading(true)}},success:function(data){g.trigger("success",[data,g]);if(g.dataTransform){data=g.dataTransform.call(g,data,g)}if(!data||!data[p.root]||!data[p.root].length){g.currentData=g.data={};g.currentData[p.root]=g.data[p.root]=[];g.currentData[p.record]=g.data[p.record]=0;g._showData();return}g.data=data;if(p.dataAction=="server"){g.currentData=g.data}else{g.filteredData=g.data;if(clause){g.filteredData[p.root]=g._searchData(g.filteredData[p.root],clause)}if(p.usePager){g.currentData=g._getCurrentPageData(g.filteredData)}else{g.currentData=g.filteredData}}g._showData.juiceDefer(g,10,[g.currentData])},complete:function(){g.trigger("complete",[g]);if(g.hasBind("loaded")){g.trigger("loaded",[g])}else{g.toggleLoading.juiceDefer(g,10,[false])}},error:function(XMLHttpRequest,textStatus,errorThrown){g.currentData=g.data={};g.currentData[p.root]=g.data[p.root]=[];g.currentData[p.record]=g.data[p.record]=0;g.toggleLoading.juiceDefer(g,10,[false]);$(".l-bar-btnload span",g.toolbar).removeClass("l-disabled");g.trigger("error",[XMLHttpRequest,textStatus,errorThrown])}};if(p.contentType){ajaxOptions.contentType=p.contentType}$.jui.ajaxQueue.offer(ajaxOptions)},load:function(data){var g=this;g.currentData=g.data=data;g._showData.juiceDefer(g,10,[g.currentData])},toggleLoading:function(show){this.gridloading[show?"show":"hide"]()},_createEditor:function(editor,container,editParm,width,height){var g=this;var editorInput=editor.create(container,editParm);if(editor.setValue){editor.setValue(editorInput,editParm.value,editParm)}if(editor.resize){editor.resize(editorInput,width,height,editParm)}if(navigator.userAgent.indexOf("MSIE")>0){var esrc=editorInput[0];if(esrc==null){esrc=event.srcElement||event.target}var rtextRange=esrc.createTextRange();rtextRange.moveStart("character",esrc.value.length);rtextRange.collapse(true);rtextRange.select()}return editorInput},beginEdit:function(rowParm,containerBulider){var g=this,p=this.options;if(!p.enabledEdit||p.clickToEdit){return}var rowdata=g.getRow(rowParm);if(rowdata._editing){return}if(g.trigger("beginEdit",{record:rowdata,rowindex:rowdata.__index})==false){return}g.editors[rowdata.__id]={};rowdata._editing=true;g.reRender({rowdata:rowdata});containerBulider=containerBulider||function(rowdata,column){var cellobj=g.getCellObj(rowdata,column);var container=$(cellobj).html("");g.setCellEditing(rowdata,column,true);return container};for(var i=0,l=g.columns.length;i<l;i++){var column=g.columns[i];if(!column.name||!column.editor||!column.editor.type||!p.editors[column.editor.type]){continue}var editor=p.editors[column.editor.type];var editParm={record:rowdata,value:rowdata[column.name],column:column,rowindex:rowdata.__index,grid:g};var container=containerBulider(rowdata,column);var width=container.width(),height=container.height();var editorInput=g._createEditor(editor,container,editParm,width,height);g.editors[rowdata.__id][column.__id]={editor:editor,input:editorInput,editParm:editParm,container:container}}g.trigger("afterBeginEdit",{record:rowdata,rowindex:rowdata.__index})},cancelEdit:function(rowParm){var g=this;if(rowParm==undefined){for(var rowid in g.editors){g.cancelEdit(rowid)}}else{var rowdata=g.getRow(rowParm);if(!g.editors[rowdata.__id]){return}if(g.trigger("cancelEdit",{record:rowdata,rowindex:rowdata.__index})==false){return}for(var columnid in g.editors[rowdata.__id]){var o=g.editors[rowdata.__id][columnid];if(o.editor.destroy){o.editor.destroy(o.input,o.editParm)}}delete g.editors[rowdata.__id];delete rowdata._editing;g.reRender({rowdata:rowdata})}},addEditRow:function(rowdata){this.submitEdit();rowdata=this.add(rowdata);this.beginEdit(rowdata)},submitEdit:function(rowParm){var g=this,p=this.options;if(rowParm==undefined){for(var rowid in g.editors){g.submitEdit(rowid)}}else{var rowdata=g.getRow(rowParm);var newdata={};if(!g.editors[rowdata.__id]){return}for(var columnid in g.editors[rowdata.__id]){var o=g.editors[rowdata.__id][columnid];var column=o.editParm.column;if(column.name){newdata[column.name]=o.editor.getValue(o.input,o.editParm)}}if(g.trigger("beforeSubmitEdit",{record:rowdata,rowindex:rowdata.__index,newdata:newdata})==false){return false}g.updateRow(rowdata,newdata);g.trigger("afterSubmitEdit",{record:rowdata,rowindex:rowdata.__index,newdata:newdata})}},endEdit:function(rowParm){var g=this,p=this.options;if(g.editor.editing){var o=g.editor;g.trigger("sysEndEdit",[g.editor.editParm]);g.trigger("endEdit",[g.editor.editParm]);if(o.editor.destroy){o.editor.destroy(o.input,o.editParm)}g.editor.container.remove();g.reRender({rowdata:g.editor.editParm.record,column:g.editor.editParm.column});g.trigger("afterEdit",[g.editor.editParm]);g.editor={editing:false}}else{if(rowParm!=undefined){var rowdata=g.getRow(rowParm);if(!g.editors[rowdata.__id]){return}if(g.submitEdit(rowParm)==false){return false}for(var columnid in g.editors[rowdata.__id]){var o=g.editors[rowdata.__id][columnid];if(o.editor.destroy){o.editor.destroy(o.input,o.editParm)}}delete g.editors[rowdata.__id];delete rowdata._editing;g.trigger("afterEdit",{record:rowdata,rowindex:rowdata.__index})}else{for(var rowid in g.editors){g.endEdit(rowid)}}}},setWidth:function(w){return this._setWidth(w)},setHeight:function(h){return this._setHeight(h)},setUpCollapse:function(isCollapse){var g=this,p=this.options;if(!g.grid){return false}g.upCollapse=isCollapse;if(g.upCollapse){g.body.hide();g.toolbar.hide()}else{g.body.show();g.toolbar.show()}},enabledCheckbox:function(){return this.options.checkbox?true:false},enabledFrozen:function(){var g=this,p=this.options;if(!p.frozen){return false}var cols=g.columns||[];if(g.enabledDetail()&&p.frozenDetail||g.enabledCheckbox()&&p.frozenCheckbox||p.frozenRownumbers&&p.rownumbers){return true}for(var i=0,l=cols.length;i<l;i++){if(cols[i].frozen){return true}}this._setFrozen(false);return false},enabledDetailEdit:function(){if(!this.enabledDetail()){return false}return this.options.detailToEdit?true:false},enabledDetail:function(){if(this.options.detail&&this.options.detail.onShowDetail){return true}return false},enabledGroup:function(){return this.options.groupColumnName?true:false},enabledColumnsGroup:function(){return(this.options.groupColumnName&&this.options.groupColumnName.indexOf(",")>0)?true:false},deleteSelectedRow:function(){if(!this.selected){return}for(var i in this.selected){var o=this.selected[i];if(o.__id in this.records){this._deleteData.juiceDefer(this,10,[o])}}this.reRender.juiceDefer(this,20)},removeRange:function(rowArr){var g=this,p=this.options;$.each(rowArr,function(){g._removeData(this)});g.reRender()},remove:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);g._removeData(rowParm);g.reRender()},deleteRange:function(rowArr){var g=this,p=this.options;$.each(rowArr,function(){g._deleteData(this)});g.reRender()},deleteRow:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);if(!rowdata){return}g._deleteData(rowdata);g.reRender();g.isDataChanged=true},_deleteData:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);rowdata[p.statusName]="delete";if(p.tree){var children=g.getChildren(rowdata,true);if(children){for(var i=0,l=children.length;i<l;i++){children[i][p.statusName]="delete"}}}g.deletedRows=g.deletedRows||[];g.deletedRows.push(rowdata);g._removeSelected(rowdata)},updateCell:function(arg,value,rowParm){var g=this,p=this.options;var column,cellObj,rowdata;if(typeof(arg)=="string"){for(var i=0,l=g.columns.length;i<l;i++){if(g.columns[i].name==arg){g.updateCell(i,value,rowParm)}}return}if(typeof(arg)=="number"){column=g.columns[arg];rowdata=g.getRow(rowParm);cellObj=g.getCellObj(rowdata,column)}else{if(typeof(arg)=="object"&&arg.__id){column=arg;rowdata=g.getRow(rowParm);cellObj=g.getCellObj(rowdata,column)}else{cellObj=arg;var ids=cellObj.id.split("|");var columnid=ids[ids.length-1];column=g._columns[columnid];var row=$(cellObj).parent();rowdata=rowdata||g.getRow(row[0])}}if(value!=null&&column.name){rowdata[column.name]=value;if(rowdata[p.statusName]!="add"){rowdata[p.statusName]="update"}g.isDataChanged=true}},addRows:function(rowdataArr,neardata,isBefore,parentRowData){var g=this,p=this.options;$(rowdataArr).each(function(){g.addRow(this,neardata,isBefore,parentRowData)})},_createRowid:function(){return"r"+(1000+this.recordNumber)},_isRowId:function(str){return(str in this.records)},_addNewRecord:function(o,previd,pid){var g=this,p=this.options;g.recordNumber++;o.__id=g._createRowid();o.__previd=previd;if(previd&&previd!=-1){var prev=g.records[previd];if(prev.__nextid&&prev.__nextid!=-1){var prevOldNext=g.records[prev.__nextid];if(prevOldNext){prevOldNext.__previd=o.__id}}prev.__nextid=o.__id;o.__index=prev.__index+1}else{o.__index=0}if(p.tree){if(pid&&pid!=-1){var parent=g.records[pid];o.__pid=pid;o.__level=parent.__level+1}else{o.__pid=-1;o.__level=1}o.__hasChildren=o[p.tree.childrenName]?true:false}if(o[p.statusName]!="add"){o[p.statusName]="nochanged"}g.rows[o.__index]=o;g.records[o.__id]=o;return o},_getRows:function(data){var g=this,p=this.options;var targetData=[];function load(data){if(!data||!data.length){return}for(var i=0,l=data.length;i<l;i++){var o=data[i];targetData.push(o);if(o[p.tree.childrenName]){load(o[p.tree.childrenName])}}}load(data);return targetData},_updateGridData:function(){var g=this,p=this.options;g.recordNumber=0;g.rows=[];g.records={};var previd=-1;function load(data,pid){if(!data||!data.length){return}for(var i=0,l=data.length;i<l;i++){var o=data[i];g.formatRecord(o);if(o[p.statusName]=="delete"){continue}g._addNewRecord(o,previd,pid);previd=o.__id;if(o.__hasChildren){load(o[p.tree.childrenName],o.__id)}}}load(g.currentData[p.root],-1);return g.rows},_moveData:function(from,to,isAfter){var g=this,p=this.options;var fromRow=g.getRow(from);var toRow=g.getRow(to);var fromIndex,toIndex;var listdata=g._getParentChildren(fromRow);fromIndex=$.inArray(fromRow,listdata);listdata.splice(fromIndex,1);listdata=g._getParentChildren(toRow);toIndex=$.inArray(toRow,listdata);listdata.splice(toIndex+(isAfter?1:0),0,fromRow)},move:function(from,to,isAfter){this._moveData(from,to,isAfter);this.reRender()},moveRange:function(rows,to,isAfter){for(var i in rows){this._moveData(rows[i],to,isAfter)}this.reRender()},up:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);var listdata=g._getParentChildren(rowdata);var index=$.inArray(rowdata,listdata);if(index==-1||index==0){return}var selected=g.getSelected();g.move(rowdata,listdata[index-1],false);g.select(selected)},down:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);var listdata=g._getParentChildren(rowdata);var index=$.inArray(rowdata,listdata);if(index==-1||index==listdata.length-1){return}var selected=g.getSelected();g.move(rowdata,listdata[index+1],true);g.select(selected)},addDataRows:function(rowdatas,neardata,isBefore,parentRowData){var g=this,p=this.options;$(rowdatas).each(function(index,rowdata){g.addRowInit(rowdata,neardata,isBefore,parentRowData)});g.addRowRender(rowdatas)},addRow:function(rowdata,neardata,isBefore,parentRowData){var g=this,p=this.options;g.addRowInit(rowdata,neardata,isBefore,parentRowData);g.addRowRender([rowdata])},addRowInit:function(rowdata,neardata,isBefore,parentRowData){var g=this,p=this.options;g._addData(rowdata,parentRowData,neardata,isBefore);rowdata[p.statusName]="add";if(p.tree){var children=g.getChildren(rowdata,true);if(children){for(var i=0,l=children.length;i<l;i++){children[i][p.statusName]="add"}}}g.isDataChanged=true;p.total=p.total?parseInt(p.total)+1:1;p.pageCount=Math.ceil(p.total/p.pageSize);g._buildPager();g.trigger("SysGridHeightChanged");g.trigger("afterAddRow",[rowdata])},addRowRender:function(rowdatas){var g=this,p=this.options;g._updateGridData();var frozen=g.enabledFrozen();if(frozen){$("tbody",g.f.gridbody).append(g._generateRowsHtml(rowdatas,true))}$("tbody",g.gridbody).append(g._generateRowsHtml(rowdatas,false));var scrollTop=g.gridbody.scrollTop();g.gridbody.scrollTop(g.gridbody.height()+g.gridbody[0].scrollHeight);if(scrollTop!=null){g.f.gridbody[0].scrollTop=scrollTop}if(!p.isScroll){g._onResize()}},updateRow:function(rowDom,newRowData){var g=this,p=this.options;var rowdata=g.getRow(rowDom);g.isDataChanged=true;for(var key in newRowData){if(rowdata[key]!=newRowData[key]){var rowcell=g.getCellObj(rowDom,g._getColumnByName(key));$(rowcell).addClass("l-grid-row-cell-edited")}}$.extend(rowdata,newRowData||{});if(rowdata[p.statusName]!="add"){rowdata[p.statusName]="update"}g.reRender.juiceDefer(g,10,[{rowdata:rowdata}]);return rowdata},getColumnByName:function(name){var g=this,p=this.options;return g._getColumnByName(name)},_getColumnByName:function(name){var g=this,p=this.options;for(var key in g._columns){if(g._columns[key]["name"]==name){return g._columns[key]}}return null},setCellEditing:function(rowdata,column,editing){var g=this,p=this.options;var cell=g.getCellObj(rowdata,column);var methodName=editing?"addClass":"removeClass";$(cell)[methodName]("l-grid-row-cell-editing");if(column.__previd!=-1&&column.__previd!=null){var cellprev=$(g.getCellObj(rowdata,column)).prev();if(!cellprev.length){var prevRow=$(g.getRowObj(rowdata.__id,true));cellprev=prevRow.children()[prevRow.children().length-1]}$(cellprev)[methodName]("l-grid-row-cell-editing-leftcell")}if(rowdata.__id!=0){var prevrowobj=$(g.getRowObj(rowdata.__id)).prev();var cellprev;if(!prevrowobj.length){cellprev=document.getElementById(column.__domid)}else{var prevrow=g.getRow(prevrowobj[0]);var cellprev=g.getCellObj(prevrow,column);if(!cellprev){return}}$(cellprev)[methodName]("l-grid-row-cell-editing-topcell")}},setCellNotBlank:function(rowdata,column,editing){var g=this,p=this.options;var cell=g.getCellObj(rowdata,column);var methodName=editing?"addClass":"removeClass";$(cell)[methodName]("l-grid-row-cell-blank");if(column.__previd!=-1&&column.__previd!=null){var cellprev=$(g.getCellObj(rowdata,column)).prev();if(!cellprev.length){var prevRow=$(g.getRowObj(rowdata.__id,true));cellprev=prevRow.children()[prevRow.children().length-1]}$(cellprev)[methodName]("l-grid-row-cell-blank-leftcell")}if(rowdata.__id!=0){var prevrowobj=$(g.getRowObj(rowdata.__id)).prev();var cellprev;if(!prevrowobj.length){cellprev=document.getElementById(column.__domid)}else{var prevrow=g.getRow(prevrowobj[0]);var cellprev=g.getCellObj(prevrow,column);if(!cellprev){return}}$(cellprev)[methodName]("l-grid-row-cell-blank-topcell")}},reRender:function(e){var g=this,p=this.options;e=e||{};var rowdata=e.rowdata,column=e.column;if(column&&(column.isdetail||column.ischeckbox)){return}if(rowdata&&rowdata[p.statusName]=="delete"){return}if(rowdata&&column){var cell=g.getCellObj(rowdata,column);$(cell).html(g._getCellHtml(rowdata,column));if(!column.issystem){g.setCellEditing(rowdata,column,false)}}else{if(rowdata){$(g.columns).each(function(){g.reRender({rowdata:rowdata,column:this})})}else{if(column){for(var rowid in g.records){g.reRender({rowdata:g.records[rowid],column:column})}for(var i=0;i<g.totalNumber;i++){var tobj=document.getElementById(g.id+"|total"+i+"|"+column.__id);$("div:first",tobj).html(g._getTotalCellContent(column,g.groups&&g.groups[i]?g.groups[i]:g.currentData[p.root]))}}else{g._showData()}}}},getData:function(status,removeStatus){var g=this,p=this.options;var data=[];for(var rowid in g.records){var o=$.extend(true,{},g.records[rowid]);if(o[p.statusName]==status||status==undefined){data.push(g.formatRecord(o,removeStatus))}}return data},formatRecord:function(o,removeStatus){delete o.__id;delete o.__previd;delete o.__nextid;delete o.__index;if(this.options.tree){delete o.__pid;delete o.__level;delete o.__hasChildren}if(removeStatus){delete o[this.options.statusName]}return o},getUpdated:function(){return this.getData("update",true)},getDeleted:function(){var g=this,p=this.options;var data=[];for(var i=0;i<g.selected.length;i++){var o=$.extend(true,{},g.selected[i]);data.push(g.formatRecord(o,true))}return data},getAdded:function(){return this.getData("add",true)},checkData:function(){var isFilled=true;var g=this,p=this.options;for(var rowid in g.records){var o=$.extend(true,{},g.records[rowid]);if(o[p.statusName]=="add"||o[p.statusName]=="update"||status==undefined){$(g.columns).each(function(index,column){if(column.editor&&!column.allowBlank&&!o[column.name]){g.setCellNotBlank(o,column,true);isFilled=false}})}}return isFilled},getColumn:function(columnParm){var g=this,p=this.options;if(typeof columnParm=="string"){if(g._isColumnId(columnParm)){return g._columns[columnParm]}else{return g.columns[parseInt(columnParm)]}}else{if(typeof(columnParm)=="number"){return g.columns[columnParm]}else{if(typeof columnParm=="object"&&columnParm.nodeType==1){var ids=columnParm.id.split("|");var columnid=ids[ids.length-1];return g._columns[columnid]}}}return columnParm},getColumnType:function(columnname){var g=this,p=this.options;for(i=0;i<g.columns.length;i++){if(g.columns[i].name==columnname){if(g.columns[i].type){return g.columns[i].type}return"string"}}return null},isTotalSummary:function(){var g=this,p=this.options;for(var i=0;i<g.columns.length;i++){if(g.columns[i].totalSummary){return true}}return false},getColumns:function(columnLevel){var g=this,p=this.options;var columns=[];for(var id in g._columns){var col=g._columns[id];if(columnLevel!=undefined){if(col.__level==columnLevel){columns.push(col)}}else{if(col.__leaf){columns.push(col)}}}return columns},changeSort:function(columnName,sortOrder){var g=this,p=this.options;if(g.loading){return true}if(p.dataAction=="local"){var columnType=g.getColumnType(columnName);if(!g.sortedData){g.sortedData=g.filteredData}if(p.sortName==columnName){if(g.reverse&&sortOrder=="asc"){g.sortedData[p.root].reverse();g.reverse=false}else{if(sortOrder=="desc"&&!g.reverse){g.sortedData[p.root].reverse();g.reverse=true}}}else{g.sortedData[p.root].sort(function(data1,data2){var ret=g._compareData(data1,data2,columnName,columnType);if(sortOrder=="asc"){return ret}else{return -ret}});g.reverse=sortOrder!="asc"}if(p.usePager){g.currentData=g._getCurrentPageData(g.sortedData)}else{g.currentData=g.sortedData}g._showData()}p.sortName=columnName;p.sortOrder=sortOrder;if(p.dataAction=="server"){g.loadData(p.where)}},changePage:function(ctype){var g=this,p=this.options;if(g.loading){return true}if(p.dataAction!="local"&&g.isDataChanged&&!confirm(p.isContinueByDataChanged)){return false}p.pageCount=parseInt($(".pcontrol span",g.toolbar).html());switch(ctype){case"first":if(p.page==1){return}p.newPage=1;break;case"prev":if(p.page==1){return}if(p.page>1){p.newPage=parseInt(p.page)-1}break;case"next":if(p.page>=p.pageCount){return}p.newPage=parseInt(p.page)+1;break;case"last":if(p.page>=p.pageCount){return}p.newPage=p.pageCount;break;case"input":var nv=parseInt($(".pcontrol input",g.toolbar).val());if(isNaN(nv)){nv=1}if(nv<1){nv=1}else{if(nv>p.pageCount){nv=p.pageCount}}$(".pcontrol input",g.toolbar).val(nv);p.newPage=nv;break}if(p.newPage==p.page){return false}if(p.newPage==1){$(".l-bar-btnfirst span",g.toolbar).addClass("l-disabled");$(".l-bar-btnprev span",g.toolbar).addClass("l-disabled")}else{$(".l-bar-btnfirst span",g.toolbar).removeClass("l-disabled");$(".l-bar-btnprev span",g.toolbar).removeClass("l-disabled")}if(p.newPage==p.pageCount){$(".l-bar-btnlast span",g.toolbar).addClass("l-disabled");$(".l-bar-btnnext span",g.toolbar).addClass("l-disabled")}else{$(".l-bar-btnlast span",g.toolbar).removeClass("l-disabled");$(".l-bar-btnnext span",g.toolbar).removeClass("l-disabled")}g.trigger("changePage",[p.newPage]);if(p.dataAction=="server"){g.loadData(p.where)}else{g.currentData=g._getCurrentPageData(g.filteredData);g._showData()}},getSelectedRow:function(){for(var i in this.selected){var o=this.selected[i];if(o.__id in this.records){return o}}return null},getSelectedRows:function(){var arr=[];for(var i in this.selected){var o=this.selected[i];if(o.__id in this.records){arr.push(o)}}return arr},getSelectedRowObj:function(){for(var i in this.selected){var o=this.selected[i];if(o.__id in this.records){return this.getRowObj(o)}}return null},getSelectedRowObjs:function(){var arr=[];for(var i in this.selected){var o=this.selected[i];if(o.__id in this.records){arr.push(this.getRowObj(o))}}return arr},getCellObj:function(rowParm,column){var rowdata=this.getRow(rowParm);column=this.getColumn(column);return document.getElementById(this._getCellDomId(rowdata,column))},getRowObj:function(rowParm,frozen){var g=this,p=this.options;if(rowParm==null){return null}if(typeof(rowParm)=="string"){if(g._isRowId(rowParm)){return document.getElementById(g.id+(frozen?"|1|":"|2|")+rowParm)}else{return document.getElementById(g.id+(frozen?"|1|":"|2|")+g.rows[parseInt(rowParm)]["__id"])}}else{if(typeof(rowParm)=="number"){return document.getElementById(g.id+(frozen?"|1|":"|2|")+g.rows[rowParm]["__id"])}else{if(typeof(rowParm)=="object"&&rowParm.__id){return g.getRowObj(rowParm.__id,frozen)}}}return rowParm},getRow:function(rowParm){var g=this,p=this.options;if(rowParm==null){return null}if(typeof(rowParm)=="string"){if(g._isRowId(rowParm)){return g.records[rowParm]}else{return g.rows[parseInt(rowParm)]}}else{if(typeof(rowParm)=="number"){return g.rows[parseInt(rowParm)]}else{if(typeof(rowParm)=="object"&&rowParm.nodeType==1&&!rowParm.__id){return g._getRowByDomId(rowParm.id)}}}return rowParm},_setColumnVisible:function(column,hide){var g=this,p=this.options;if(!hide){column._hide=false;document.getElementById(column.__domid).style.display="";g._updateRowCols();if(column.__pid!=-1){var pcol=g._columns[column.__pid];var unHiddenCount=0;for(var i=0;pcol&&i<pcol.columns.length;i++){if(!pcol.columns[i]._hide){unHiddenCount++}}if(unHiddenCount>=1){pcol.__colSpan=parseInt(pcol.__colSpan||"0")+(column.__colSpan||1);var headercell=document.getElementById(pcol.__domid);headercell.colSpan=pcol.__colSpan}if(pcol._hide){document.getElementById(pcol.__domid).style.display="";this._setColumnVisible(pcol,hide)}}}else{column._hide=true;document.getElementById(column.__domid).style.display="none";if(column.__pid!=-1){var hideall=true;var pcol=this._columns[column.__pid];pcol.__colSpan=pcol.__colSpan||1;if(pcol.__colSpan>=1){pcol.__colSpan=(pcol.__colSpan||1)-(column.__colSpan||1);var headercell=document.getElementById(pcol.__domid);if(pcol.__colSpan>=1){headercell.colSpan=pcol.__colSpan}}for(var i=0;pcol&&i<pcol.columns.length;i++){if(!pcol.columns[i]._hide){hideall=false;break}}if(hideall){pcol._hide=true;document.getElementById(pcol.__domid).style.display="none";this._setColumnVisible(pcol,hide)}}g._updateRowCols()}},toggleCol:function(columnparm,visible,toggleByPopup){var g=this,p=this.options;var column;if(typeof(columnparm)=="number"){column=g.columns[columnparm]}else{if(typeof(columnparm)=="object"&&columnparm.__id){column=columnparm}else{if(typeof(columnparm)=="string"){if(g._isColumnId(columnparm)){column=g._columns[columnparm]}else{for(var level=1;level<=g._columnMaxLevel;level++){var columns=g.getColumns(level);$(columns).each(function(){if(this.name==columnparm){g.setColumnVisable(this,visible,toggleByPopup)}})}return}}}}if(!column){return}var columnindex=column.__leafindex;var headercell=document.getElementById(column.__domid);if(!headercell){return}headercell=$(headercell);var cells=[];for(var i in g.rows){var obj=g.getCellObj(g.rows[i],column);if(obj){cells.push(obj)}}for(var i=0;i<g.totalNumber;i++){var tobj=document.getElementById(g.id+"|total"+i+"|"+column.__id);if(tobj){cells.push(tobj)}}var colwidth=column._width;if(visible&&column._hide){if(column.frozen){g.f.gridtablewidth+=(parseInt(colwidth)+1)}else{g.gridtablewidth+=(parseInt(colwidth)+1)}g._setColumnVisible(column,false);$(cells).show()}else{if(!visible&&!column._hide){if(column.frozen){g.f.gridtablewidth-=(parseInt(colwidth)+1)}else{g.gridtablewidth-=(parseInt(colwidth)+1)}g._setColumnVisible(column,true);$(cells).hide()}}if(column.frozen){$("div:first",g.f.gridheader).width(g.f.gridtablewidth);$("div:first",g.f.gridbody).width(g.f.gridtablewidth)}else{$("div:first",g.gridheader).width(g.gridtablewidth+40);$("div:first",g.gridbody).width(g.gridtablewidth)}g._updateFrozenWidth();if(!toggleByPopup){$(":checkbox[columnindex="+columnindex+"]",g.popup).each(function(){this.checked=visible;if($.fn.juiceCheckBox){var checkboxmanager=$(this).juiceGetCheckBoxManager();if(checkboxmanager){checkboxmanager.updateStyle()}}})}},setColumnVisable:function(column,visible,toggleByPopup){var g=this,p=this.options;g.toggleCol(column,visible,toggleByPopup);if(column.columns&&column.columns.length>0){$(column.columns).each(function(i,childColumn){g.setColumnVisable(childColumn,visible,toggleByPopup)})}},setColumnWidth:function(columnparm,newwidth){var g=this,p=this.options;if(!newwidth){return}newwidth=parseInt(newwidth,10);var column;if(typeof(columnparm)=="number"){column=g.columns[columnparm]}else{if(typeof(columnparm)=="object"&&columnparm.__id){column=columnparm}else{if(typeof(columnparm)=="string"){if(g._isColumnId(columnparm)){column=g._columns[columnparm]}else{$(g.columns).each(function(){if(this.name==columnparm){g.setColumnWidth(this,newwidth)}});return}}}}if(!column){return}var mincolumnwidth=p.minColumnWidth;if(column.minWidth){mincolumnwidth=column.minWidth}newwidth=newwidth<mincolumnwidth?mincolumnwidth:newwidth;var diff=newwidth-column._width;if(g.trigger("beforeChangeColumnWidth",[column,newwidth])==false){return}column._width=newwidth;if(column.frozen){g.f.gridtablewidth+=diff;$("div:first",g.f.gridheader).width(g.f.gridtablewidth);$("div:first",g.f.gridbody).width(g.f.gridtablewidth)}else{g.gridtablewidth+=diff;$("div:first",g.gridheader).width(g.gridtablewidth+40);$("div:first",g.gridbody).width(g.gridtablewidth)}$(document.getElementById(column.__domid)).css("width",newwidth);var cells=[];for(var rowid in g.records){var obj=g.getCellObj(g.records[rowid],column);if(obj){cells.push(obj)}if(!g.enabledDetailEdit()&&g.editors[rowid]&&g.editors[rowid][column.__id]){var o=g.editors[rowid][column.__id];if(o.editor.resize){o.editor.resize(o.input,newwidth,o.container.height(),o.editParm)}}}for(var i=0;i<g.totalNumber;i++){var tobj=document.getElementById(g.id+"|total"+i+"|"+column.__id);if(tobj){cells.push(tobj)}}$(cells).css("width",newwidth).find("> div.l-grid-row-cell-inner:first").css("width",newwidth-8);g._updateFrozenWidth();g.trigger("afterChangeColumnWidth",[column,newwidth])},changeHeaderText:function(columnparm,headerText){var g=this,p=this.options;var column;if(typeof(columnparm)=="number"){column=g.columns[columnparm]}else{if(typeof(columnparm)=="object"&&columnparm.__id){column=columnparm}else{if(typeof(columnparm)=="string"){if(g._isColumnId(columnparm)){column=g._columns[columnparm]}else{$(g.columns).each(function(){if(this.name==columnparm){g.changeHeaderText(this,headerText)}});return}}}}if(!column){return}var columnindex=column.__leafindex;var headercell=document.getElementById(column.__domid);$(".l-grid-hd-cell-text",headercell).html(headerText);if(p.allowHideColumn){$(":checkbox[columnindex="+columnindex+"]",g.popup).parent().next().html(headerText)}},changeCol:function(from,to,isAfter){var g=this,p=this.options;if(!from||!to){return}var fromCol=g.getColumn(from);var toCol=g.getColumn(to);fromCol.frozen=toCol.frozen;var fromColIndex,toColIndex;var fromColumns=fromCol.__pid==-1?p.columns:g._columns[fromCol.__pid].columns;var toColumns=toCol.__pid==-1?p.columns:g._columns[toCol.__pid].columns;fromColIndex=$.inArray(fromCol,fromColumns);toColIndex=$.inArray(toCol,toColumns);var sameParent=fromColumns==toColumns;var sameLevel=fromCol.__level==toCol.__level;toColumns.splice(toColIndex+(isAfter?1:0),0,fromCol);if(!sameParent){fromColumns.splice(fromColIndex,1)}else{if(isAfter){fromColumns.splice(fromColIndex,1)}else{fromColumns.splice(fromColIndex+1,1)}}g._setColumns(p.columns);g.reRender()},collapseDetail:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);if(!rowdata){return}for(var i=0,l=g.columns.length;i<l;i++){if(g.columns[i].isdetail){var row=g.getRowObj(rowdata);var cell=g.getCellObj(rowdata,g.columns[i]);$(row).next("tr.l-grid-detailpanel").hide();$(".l-grid-row-cell-detailbtn:first",cell).removeClass("l-open");g.trigger("SysGridHeightChanged");return}}},extendDetail:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);if(!rowdata){return}for(var i=0,l=g.columns;i<l;i++){if(g.columns[i].isdetail){var row=g.getRowObj(rowdata);var cell=g.getCellObj(rowdata,g.columns[i]);$(row).next("tr.l-grid-detailpanel").show();$(".l-grid-row-cell-detailbtn:first",cell).addClass("l-open");g.trigger("SysGridHeightChanged");return}}},getParent:function(rowParm){var g=this,p=this.options;if(!p.tree){return null}var rowdata=g.getRow(rowParm);if(!rowdata){return null}if(rowdata.__pid in g.records){return g.records[rowdata.__pid]}else{return null}},getChildren:function(rowParm,deep){var g=this,p=this.options;if(!p.tree){return null}var rowData=g.getRow(rowParm);if(!rowData){return null}var arr=[];function loadChildren(data){if(data[p.tree.childrenName]){for(var i=0,l=data[p.tree.childrenName].length;i<l;i++){var o=data[p.tree.childrenName][i];if(o.__status=="delete"){continue}arr.push(o);if(deep){loadChildren(o)}}}}loadChildren(rowData);return arr},isLeaf:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);if(!rowdata){return}return rowdata.__hasChildren?false:true},hasChildren:function(rowParm){var g=this,p=this.options;var rowdata=this.getRow(rowParm);if(!rowdata){return}return(rowdata[p.tree.childrenName]&&rowdata[p.tree.childrenName].length)?true:false},existRecord:function(record){for(var rowid in this.records){if(this.records[rowid]==record){return true}}return false},_removeSelected:function(rowdata){var g=this,p=this.options;if(p.tree){var children=g.getChildren(rowdata,true);if(children){for(var i=0,l=children.length;i<l;i++){var index2=$.inArray(children[i],g.selected);if(index2!=-1){g.selected.splice(index2,1)}}}}var index=$.inArray(rowdata,g.selected);if(index!=-1){g.selected.splice(index,1)}},_getParentChildren:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);var listdata;if(p.tree&&g.existRecord(rowdata)&&rowdata.__pid in g.records){listdata=g.records[rowdata.__pid][p.tree.childrenName]}else{listdata=g.currentData[p.root]}return listdata},_removeData:function(rowdata){var g=this,p=this.options;var listdata=g._getParentChildren(rowdata);var index=$.inArray(rowdata,listdata);if(index!=-1){listdata.splice(index,1)}g._removeSelected(rowdata)},_addData:function(rowdata,parentdata,neardata,isBefore){var g=this,p=this.options;var listdata=g.currentData[p.root];if(neardata){if(p.tree){if(parentdata){listdata=parentdata[p.tree.childrenName]}else{if(neardata.__pid in g.records){listdata=g.records[neardata.__pid][p.tree.childrenName]}}}var index=$.inArray(neardata,listdata);listdata.splice(index==-1?-1:index+(isBefore?0:1),0,rowdata)}else{if(p.tree&&parentdata){listdata=parentdata[p.tree.childrenName]}listdata.push(rowdata)}},_appendData:function(rowdata,parentdata,neardata,isBefore){var g=this,p=this.options;rowdata[p.statusName]="update";g._removeData(rowdata);g._addData(rowdata,parentdata,neardata,isBefore)},appendRange:function(rows,parentdata,neardata,isBefore){var g=this,p=this.options;var toRender=false;$.each(rows,function(i,item){if(item.__id&&g.existRecord(item)){if(g.isLeaf(parentdata)){g.upgrade(parentdata)}g._appendData(item,parentdata,neardata,isBefore);toRender=true}else{g.appendRow(item,parentdata,neardata,isBefore)}});if(toRender){g.reRender()}},appendRow:function(rowdata,parentdata,neardata,isBefore){var g=this,p=this.options;if($.isArray(rowdata)){g.appendRange(rowdata,parentdata,neardata,isBefore);return}if(rowdata.__id&&g.existRecord(rowdata)){g._appendData(rowdata,parentdata,neardata,isBefore);g.reRender();return}if(parentdata&&g.isLeaf(parentdata)){g.upgrade(parentdata)}g.addRow(rowdata,neardata,isBefore?true:false,parentdata)},upgrade:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);if(!rowdata||!p.tree){return}rowdata[p.tree.childrenName]=rowdata[p.tree.childrenName]||[];rowdata.__hasChildren=true;var rowobjs=[g.getRowObj(rowdata)];if(g.enabledFrozen()){rowobjs.push(g.getRowObj(rowdata,true))}$("> td > div > .l-grid-tree-space:last",rowobjs).addClass("l-grid-tree-link l-grid-tree-link-open")},demotion:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);if(!rowdata||!p.tree){return}var rowobjs=[g.getRowObj(rowdata)];if(g.enabledFrozen()){rowobjs.push(g.getRowObj(rowdata,true))}$("> td > div > .l-grid-tree-space:last",rowobjs).removeClass("l-grid-tree-link l-grid-tree-link-open l-grid-tree-link-close");if(g.hasChildren(rowdata)){var children=g.getChildren(rowdata);for(var i=0,l=children.length;i<l;i++){g.deleteRow(children[i])}}rowdata.__hasChildren=false},collapse:function(rowParm){var g=this,p=this.options;var targetRowObj=g.getRowObj(rowParm);var linkbtn=$(".l-grid-tree-link",targetRowObj);if(linkbtn.hasClass("l-grid-tree-link-close")){return}g.toggle(rowParm)},expand:function(rowParm){var g=this,p=this.options;var targetRowObj=g.getRowObj(rowParm);var linkbtn=$(".l-grid-tree-link",targetRowObj);if(linkbtn.hasClass("l-grid-tree-link-open")){return}g.toggle(rowParm)},toggle:function(rowParm){if(!rowParm){return}var g=this,p=this.options;var rowdata=g.getRow(rowParm);var targetRowObj=[g.getRowObj(rowdata)];if(g.enabledFrozen()){targetRowObj.push(g.getRowObj(rowdata,true))}var level=rowdata.__level,indexInCollapsedRows;var linkbtn=$(".l-grid-tree-link:first",targetRowObj);var opening=true;g.collapsedRows=g.collapsedRows||[];if(linkbtn.hasClass("l-grid-tree-link-close")){linkbtn.removeClass("l-grid-tree-link-close").addClass("l-grid-tree-link-open");indexInCollapsedRows=$.inArray(rowdata,g.collapsedRows);if(indexInCollapsedRows!=-1){g.collapsedRows.splice(indexInCollapsedRows,1)}}else{opening=false;linkbtn.addClass("l-grid-tree-link-close").removeClass("l-grid-tree-link-open");indexInCollapsedRows=$.inArray(rowdata,g.collapsedRows);if(indexInCollapsedRows==-1){g.collapsedRows.push(rowdata)}}var children=g.getChildren(rowdata,true);for(var i=0,l=children.length;i<l;i++){var o=children[i];var currentRow=$([g.getRowObj(o.__id)]);if(g.enabledFrozen()){currentRow=currentRow.add(g.getRowObj(o.__id,true))}if(opening){$(".l-grid-tree-link",currentRow).removeClass("l-grid-tree-link-close").addClass("l-grid-tree-link-open");currentRow.show()}else{$(".l-grid-tree-link",currentRow).removeClass("l-grid-tree-link-open").addClass("l-grid-tree-link-close");currentRow.hide()}}},_bulid:function(){var g=this;g._clearGrid();g._initBuildHeader();g._initHeight();g._initFootbar();g._buildPager();g._setEvent()},_setColumns:function(columns){var g=this;g._initColumns();g._initBuildGridHeader();g._initBuildPopup();g._initHeaderMenu()},_initBuildHeader:function(){var g=this,p=this.options;if(p.title){$(".l-panel-header-text",g.header).html(p.title);if(p.headerImg){g.header.append("<img src='"+p.headerImg+"' />").addClass("l-panel-header-hasicon")}if(p.toggleAble){$(".grid-up-toggle",g.header).hover(function(){$(this).addClass("grid-up-toggle-over")},function(){$(this).removeClass("grid-up-toggle-over")}).click(function(){g.setUpCollapse(true);$(".grid-down-toggle",g.header).show();$(this).hide()});$(".grid-down-toggle",g.header).hover(function(){$(this).addClass("grid-down-toggle-over")},function(){$(this).removeClass("grid-down-toggle-over")}).click(function(){g.setUpCollapse(false);$(".grid-up-toggle",g.header).show();$(this).hide()})}}else{g.header.hide()}if(p.toolbar){if($.fn.juiceToolBar){g.toolbarManager=g.topbar.juiceToolBar(p.toolbar)}}else{g.topbar.remove()}},_createColumnId:function(column){if(column.id!=null){return column.id.toString()}return"c"+(100+this._columnCount)},_isColumnId:function(str){return(str in this._columns)},_initColumns:function(){var g=this,p=this.options;g._columns={};g._columnCount=0;g._columnLeafCount=0;g._columnMaxLevel=1;g._changeLevel=1;if(!p.columns){return}function removeProp(column,props){for(var i in props){if(props[i] in column){delete column[props[i]]}}}function setColumn(column,level,pid,previd){removeProp(column,["__id","__pid","__previd","__nextid","__domid","__leaf","__leafindex","__level","__colSpan","__rowSpan"]);if(level>g._columnMaxLevel){g._columnMaxLevel=level}g._columnCount++;column.__id=g._createColumnId(column);column.__domid=g.id+"|hcell|"+column.__id;g._columns[column.__id]=column;if(!column.columns||!column.columns.length){column.__leafindex=g._columnLeafCount++}column.__level=level;column.__pid=pid;column.__previd=previd;if(!column.columns||!column.columns.length){column.__leaf=true;return 1}var leafcount=0;var newid=-1;for(var i=0,l=column.columns.length;i<l;i++){var col=column.columns[i];leafcount+=setColumn(col,level+1,column.__id,newid);newid=col.__id}column.__leafcount=leafcount;return leafcount}var lastid=-1;if(p.rownumbers){var frozenRownumbers=g.enabledGroup()?false:p.frozen&&p.frozenRownumbers;var col={isrownumber:true,issystem:true,width:p.rownumbersColWidth,frozen:frozenRownumbers};setColumn(col,1,-1,lastid);lastid=col.__id}if(g.enabledDetail()){var frozenDetail=g.enabledGroup()?false:p.frozen&&p.frozenDetail;var col={isdetail:true,issystem:true,width:p.detailColWidth,frozen:frozenDetail};setColumn(col,1,-1,lastid);lastid=col.__id}if(g.enabledCheckbox()){var frozenCheckbox=g.enabledGroup()?false:p.frozen&&p.frozenCheckbox;var col={ischeckbox:true,issystem:true,width:p.detailColWidth,frozen:frozenCheckbox};setColumn(col,1,-1,lastid);lastid=col.__id}for(var i=0,l=p.columns.length;i<l;i++){var col=p.columns[i];setColumn(col,1,-1,lastid);lastid=col.__id}for(var id in g._columns){var col=g._columns[id];if(col.__leafcount>1){col.__colSpan=col.__leafcount}if(col.__leaf&&col.__level!=g._columnMaxLevel){col.__rowSpan=g._columnMaxLevel-col.__level+1}}g._changeLevel=g._columnMaxLevel;g.columns=g.getColumns();$(g.columns).each(function(i,column){column.columnname=column.name;column.columnindex=i;column.type=column.type||"string";column.islast=i==g.columns.length-1;column.isSort=column.isSort==false?false:true;column.frozen=column.frozen?true:false;column._width=g._getColumnWidth(column);column._hide=column.hide?true:false})},_getColumnWidth:function(column){var g=this,p=this.options;if(column._width){return column._width}var colwidth;if(column.width){colwidth=column.width}else{if(p.columnWidth){colwidth=p.columnWidth}}if(!colwidth){var lwidth=4;if(g.enabledCheckbox()){lwidth+=p.checkboxColWidth}if(g.enabledDetail()){lwidth+=p.detailColWidth}colwidth=parseInt((g.grid.width()-lwidth)/g.columns.length)}if(typeof(colwidth)=="string"&&colwidth.indexOf("%")>0){column._width=colwidth=parseInt(parseInt(colwidth)*0.01*(g.grid.width()-g.columns.length))}if(column.minWidth&&colwidth<column.minWidth){colwidth=column.minWidth}if(column.maxWidth&&colwidth>column.maxWidth){colwidth=column.maxWidth}column._width=colwidth;if(!column.frozen&&!column._hide&&g.gridview2.width()){column._percentWidth=(colwidth/(g.gridview2.width()))}return colwidth},_createHeaderCell:function(column){var g=this,p=this.options;var tdHeight=p.headerRowHeight*(column.__rowSpan?column.__rowSpan:1);var jcell=$("<td class='l-grid-hd-cell'><div class='l-grid-hd-ct' style='height:"+(tdHeight-1)+"px;line-height: "+(tdHeight-1)+"px'><div class='l-grid-hd-cell-inner'> <span class='l-grid-hd-cell-text'></span></div><div class='l-grid-hd-trigger'/></div></td>");jcell.hover(function(){$(".l-grid-hd-trigger",this).show();$(this).addClass("l-grid-hd-over")},function(){$(".l-grid-hd-trigger",this).hide();$(this).removeClass("l-grid-hd-over")});if(p.showHeadMenu){$(".l-grid-hd-trigger",jcell).click(function(e){g.currentHeader=column;g._initMenu();g.menu.show({top:e.pageY,left:e.pageX});return false})}jcell.attr("id",column.__domid);if(!column.__leaf){jcell.addClass("l-grid-hd-cell-mul")}if(column.columnindex==g.columns.length-1){jcell.addClass("l-grid-hd-cell-last")}if(column.isrownumber){jcell.addClass("l-grid-hd-cell-rownumbers");jcell.html("<div class='l-grid-hd-cell-inner'></div>")}if(column.ischeckbox){jcell.addClass("l-grid-hd-cell-checkbox");jcell.html("<div class='l-grid-hd-cell-inner'><div class='l-grid-hd-cell-text l-grid-hd-cell-btn-checkbox'></div></div>")}if(column.isdetail){jcell.addClass("l-grid-hd-cell-detail");jcell.html("<div class='l-grid-hd-cell-inner'><div class='l-grid-hd-cell-text l-grid-hd-cell-btn-detail'></div></div>")}if(column.heightAlign){$(".l-grid-hd-cell-inner:first",jcell).css("textAlign",column.heightAlign)}if(column.__colSpan){jcell.attr("colSpan",column.__colSpan)}if(column.__rowSpan){jcell.attr("rowSpan",column.__rowSpan);jcell.height(p.headerRowHeight*column.__rowSpan)}else{jcell.height(p.headerRowHeight)}if(column.__leaf){jcell.width(column._width);jcell.attr("columnindex",column.__leafindex)}if(column._hide){jcell.hide()}if(column.name){jcell.attr({columnname:column.name})}var headerText="";if(column.display&&column.display!=""){headerText=column.display}else{if(column.headerRender){headerText=column.headerRender(column)}else{headerText="&nbsp;"}}$(".l-grid-hd-cell-text:first",jcell).html(headerText);if(!column.issystem&&column.__leaf&&column.resizable!==false&&$.fn.juiceResizable){g.colResizable[column.__id]=jcell.juiceResizable({handles:"e",onStartResize:function(e,ev){this.proxy.hide();g.draggingline.css({height:g.body.height(),top:0,left:ev.pageX-g.grid.offset().left+parseInt(g.body[0].scrollLeft)}).show()},onResize:function(e,ev){g.colresizing=true;g.draggingline.css({left:ev.pageX-g.grid.offset().left+parseInt(g.body[0].scrollLeft)});$("body").add(jcell).css("cursor","e-resize")},onStopResize:function(e){g.colresizing=false;$("body").add(jcell).css("cursor","default");g.draggingline.hide();g.setColumnWidth(column,column._width+e.diffX);if(!column.frozen&&!column._hide){column._percentWidth=((column._width)/(g.gridview2.width()))}return false}})}return jcell},_initBuildGridHeader:function(){var g=this,p=this.options;g.gridtablewidth=0;g.f.gridtablewidth=0;if(g.colResizable){for(var i in g.colResizable){g.colResizable[i].destroy()}g.colResizable=null}g.colResizable={};$("tbody:first",g.gridheader).html("");$("tbody:first",g.f.gridheader).html("");for(var level=1;level<=g._columnMaxLevel;level++){var columns=g.getColumns(level);var islast=level==g._columnMaxLevel;var tr=$("<tr class='l-grid-hd-row'></tr>");var trf=$("<tr class='l-grid-hd-row'></tr>");if(!islast){tr.add(trf).addClass("l-grid-hd-mul")}$("tbody:first",g.gridheader).append(tr);$("tbody:first",g.f.gridheader).append(trf);$(columns).each(function(i,column){(column.frozen?trf:tr).append(g._createHeaderCell(column));if(column.__leaf){var colwidth=column._width;if(!column.frozen){g.gridtablewidth+=(parseInt(colwidth)?parseInt(colwidth):0)+1}else{g.f.gridtablewidth+=(parseInt(colwidth)?parseInt(colwidth):0)+1}}})}if(g._columnMaxLevel>0){var h=p.headerRowHeight*g._columnMaxLevel;g.gridheader.add(g.f.gridheader).height(h);if(p.rownumbers&&p.frozenRownumbers){g.f.gridheader.find("td:first").height(h)}}g._updateFrozenWidth();$("div:first",g.gridheader).width(g.gridtablewidth+40)},_updateRowCols:function(){var g=this,p=this.options;var maxLevel=g._getMaxLevel(p.columns);for(var id in g._columns){var col=g._columns[id];if(col.__leaf&&col.__level!=g._columnMaxLevel){col.__rowSpan=maxLevel-col.__level+1}var headercell=document.getElementById(col.__domid);if(col.__rowSpan!=undefined&&col.__rowSpan>1){headercell.rowSpan=col.__rowSpan}}},_getMaxLevel:function(columns,level){var g=this,p=this.options;var maxLevel=level||0;$(columns).each(function(){if(this["_hide"]!=undefined&&!this["_hide"]){maxLevel++;return false}});$(columns).each(function(){if(this.columns){maxLevel=g._getMaxLevel(this.columns,maxLevel)}});return maxLevel},_initHeaderMenu:function(){var g=this,p=this.options;var items=g._createMenuItem(p.columns);g.menu=$.juiceMenu({selfClose:true,width:140,items:[{text:"升序排序",icon:"asc",id:"order_asc",click:function(){var columnName=g.currentHeader.name;g.changeSort(columnName,"asc")}},{text:"降序排序",icon:"desc",id:"order_desc",click:function(){var columnName=g.currentHeader.name;g.changeSort(columnName,"desc")}},{line:true},{text:"锁定此列",icon:"lock",id:"lock",click:function(){g._lockColumn()}},{text:"撤销锁定",icon:"unlock-gray",id:"unlock",click:function(){g._unlockColumn()}},{line:true},{text:"按此列进行分组",icon:"group",id:"group",click:function(){g._groupByColumn()}},{line:true},{text:"追加此列分组",icon:"groupColumns",id:"groupColumns",click:function(){g._groupByColumns()}},{text:"取消记录分组",id:"ungroup",click:function(){g._unGroupByColumn()}},{line:true},{text:"表格列",icon:"columns",children:items}]})},_unlockColumn:function(){var g=this;g.currentHeader.frozen=false;g._setColumns();g.reRender()},_lockColumn:function(){var g=this;g.currentHeader.frozen=true;g._setColumns();g._setFrozen(true);g.reRender()},_groupByColumn:function(){var g=this,p=this.options;g.frozenIds=g.frozenIds||[];p.groupColumnName=g.currentHeader.name;g._groupCommon()},_groupByColumns:function(){var g=this,p=this.options;g.frozenIds=g.frozenIds||[];if(!g._isContainCurrentHeader()){p.groupColumnName+=","+g.currentHeader.name}g._groupCommon()},_unGroupByColumn:function(){var g=this,p=this.options;p.groupColumnName="";$(g.frozenIds).each(function(){g._columns[this].frozen=true});p.enabledEdit=g.enabledEdit;g._setColumns();g.reRender()},_groupCommon:function(){var g=this,p=this.options;$(g.columns).each(function(){if(this.frozen){g.frozenIds.push(this["__id"]);this.frozen=false;this["_hide"]=false}});g.enabledEdit=p.enabledEdit;p.enabledEdit=false;g._setColumns();g.reRender()},_isContainCurrentHeader:function(){var g=this,p=this.options;return p.groupColumnName&&(","+p.groupColumnName+",").indexOf(","+g.currentHeader.name+",")>=0},_initMenu:function(){var g=this,p=this.options;var lockditems=$(".l-menu-item[menuitemid='lock']",g.menu.items);var unlockditems=$(".l-menu-item[menuitemid='unlock']",g.menu.items);var lockditem=$(".l-menu-item-icon",lockditems);var unlockditem=$(".l-menu-item-icon",unlockditems);g.menu.setEnable("group");g.menu.setEnable("lock");g.menu.setEnable("unlock");if(g._isContainCurrentHeader()){g.menu.setDisable("group");g.menu.setDisable("groupColumns")}else{if(p.groupColumnName){g.menu.setEnable("groupColumns")}else{g.menu.setDisable("groupColumns");g.menu.setDisable("ungroup")}}if(g.currentHeader.frozen){lockditem.removeClass("l-icon-lock");lockditem.addClass("l-icon-lock-gray");g.menu.setDisable("lock");unlockditem.removeClass("l-icon-unlock-gray");unlockditem.addClass("l-icon-unlock")}else{lockditem.removeClass("l-icon-lock-gray");lockditem.addClass("l-icon-lock");g.menu.setDisable("unlock");unlockditem.removeClass("l-icon-unlock");unlockditem.addClass("l-icon-unlock-gray")}if(g._getMaxLevel(p.columns)>1){g.menu.setDisable("lock");g.menu.setDisable("unlock")}if(p.groupColumnName){g.menu.setDisable("lock");g.menu.setDisable("unlock")}},_createMenuItem:function(columns){var g=this;var items=new Array();$(columns).each(function(i,column){if(column.issystem){return}if(column.isAllowHide==false){return}if(column.hide==true){return}var item={text:column.display,id:column.name,checkbox:true,checked:true,click:function(){if(item.checked){item.checked=false}else{item.checked=true}g.toggleCol(column.columnindex,!item.checked,true)}};items.push(item);if(column.columns&&column.columns.length>0){item.children=g._createMenuItem(column.columns)}});return items},_initBuildPopup:function(){var g=this,p=this.options;$(":checkbox",g.popup).unbind();$("tbody tr",g.popup).remove();$(g.columns).each(function(i,column){if(column.issystem){return}if(column.isAllowHide==false){return}var chk='checked="checked"';if(column._hide){chk=""}var header=column.display;$("tbody",g.popup).append('<tr><td class="l-column-left"><input type="checkbox" '+chk+' class="l-checkbox" columnindex="'+i+'"/></td><td class="l-column-right">'+header+"</td></tr>")});if($.fn.juiceCheckBox){$("input:checkbox",g.popup).juiceCheckBox({onBeforeClick:function(obj){if(!obj.checked){return true}if($("input:checked",g.popup).length<=p.minColToggle){return false}return true}})}if(p.allowHideColumn){$("tr",g.popup).hover(function(){$(this).addClass("l-popup-row-over")},function(){$(this).removeClass("l-popup-row-over")});var onPopupCheckboxChange=function(){if($("input:checked",g.popup).length+1<=p.minColToggle){return false}g.toggleCol(parseInt($(this).attr("columnindex")),this.checked,true)};if($.fn.juiceCheckBox){$(":checkbox",g.popup).bind("change",onPopupCheckboxChange)}else{$(":checkbox",g.popup).bind("click",onPopupCheckboxChange)}}},_initHeight:function(){var g=this,p=this.options;if(p.height=="auto"){g.gridbody.height("auto");g.f.gridbody.height("auto")}if(p.width){g.grid.width(p.width)}g._onResize.call(g)},_initFootbar:function(){var g=this,p=this.options;if(p.usePager){var optStr="";var selectedIndex=-1;$(p.pageSizeOptions).each(function(i,item){var selectedStr="";if(p.pageSize==item){selectedIndex=i}optStr+="<option value='"+item+"' "+selectedStr+" >"+item+"</option>"});$(".l-bar-selectpagesize",g.toolbar).append("<select name='rp'>"+optStr+"</select>");if(selectedIndex!=-1){$(".l-bar-selectpagesize select",g.toolbar)[0].selectedIndex=selectedIndex}if(p.switchPageSizeApplyComboBox&&$.fn.juiceComboBox){$(".l-bar-selectpagesize select",g.toolbar).juiceComboBox({onBeforeSelect:function(){if(p.url&&g.isDataChanged&&!confirm(p.isContinueByDataChanged)){return false}return true},width:45})}if(p.showAddButton){$(".l-icon-add-default",g.toolbar).addClass("l-icon-add");$(".l-bar-separator-default",g.toolbar).addClass("l-bar-separator")}}else{g.toolbar.hide()}},showAddButton:function(flag){var g=this,p=this.options;if(flag){$(".l-icon-add-default",g.toolbar).addClass("l-icon-add");$(".l-bar-separator-default",g.toolbar).addClass("l-bar-separator")}else{$(".l-icon-add-default",g.toolbar).removeClass("l-icon-add");$(".l-bar-separator-default",g.toolbar).removeClass("l-bar-separator")}p.showAddButton=flag},_searchData:function(data,clause){var g=this,p=this.options;var newData=new Array();for(var i=0;i<data.length;i++){if(clause(data[i],i)){newData[newData.length]=data[i]}}return newData},_clearGrid:function(){var g=this,p=this.options;for(var i in g.rows){var rowobj=$(g.getRowObj(g.rows[i]));if(g.enabledFrozen()){rowobj=rowobj.add(g.getRowObj(g.rows[i],true))}rowobj.unbind()}g.gridbody.html("");g.f.gridbody.html("");g.recordNumber=0;g.records={};g.rows=[];g.selected=[];g.totalNumber=0;g.editorcounter=0},_fillGridBody:function(data,frozen){var g=this,p=this.options;var gridhtmlarr=['<div class="l-grid-body-inner"><table class="l-grid-body-table" cellpadding=0 cellspacing=0><tbody>'];gridhtmlarr.push(g._generateRowsHtml(data,frozen));gridhtmlarr.push("</tbody></table></div>");(frozen?g.f.gridbody:g.gridbody).html(gridhtmlarr.join(""));if(!g.enabledGroup()){g._bulidTotalSummary(frozen)}$("> div:first",g.gridbody).width(g.gridtablewidth);g._onResize()},_generateRowsHtml:function(data,frozen){var g=this,p=this.options;var gridhtmlarr=[];if(g.enabledGroup()&&!g.enabledColumnsGroup()){var groups=[];var groupsdata=[];g.groups=groupsdata;for(var rowparm in data){var item=data[rowparm];var groupColumnValue=item[p.groupColumnName];var valueIndex=$.inArray(groupColumnValue,groups);if(valueIndex==-1){groups.push(groupColumnValue);valueIndex=groups.length-1;groupsdata.push([])}groupsdata[valueIndex].push(item)}$(groupsdata).each(function(i,item){if(groupsdata.length==1){gridhtmlarr.push('<tr class="l-grid-grouprow l-grid-grouprow-last l-grid-grouprow-first"')}if(i==groupsdata.length-1){gridhtmlarr.push('<tr class="l-grid-grouprow l-grid-grouprow-last"')}else{if(i==0){gridhtmlarr.push('<tr class="l-grid-grouprow l-grid-grouprow-first"')}else{gridhtmlarr.push('<tr class="l-grid-grouprow"')}}gridhtmlarr.push(' groupindex"='+i+'" >');gridhtmlarr.push('<td colSpan="'+g.columns.length+'" class="l-grid-grouprow-cell">');gridhtmlarr.push('<span class="l-grid-group-togglebtn">&nbsp;&nbsp;&nbsp;&nbsp;</span>');if(p.groupRender){gridhtmlarr.push(p.groupRender(groups[i],item,p.groupColumnDisplay))}else{gridhtmlarr.push(p.groupColumnDisplay+":"+g._getCellContent(item[0],g._getColumnByName(p.groupColumnName))||groups[i]||"__blank")}gridhtmlarr.push("</td>");gridhtmlarr.push("</tr>");gridhtmlarr.push(g._getHtmlFromData(item,frozen));if(g.isTotalSummary()){gridhtmlarr.push(g._getTotalSummaryHtml(item,"l-grid-totalsummary-group",frozen))}})}else{if(g.enabledColumnsGroup()){var columnStr=p.groupColumnName;var columns=columnStr.split(",");if(typeof columns!="object"){columns=[columns]}var datas=g._groupData(data,columns);g._extraGroupData(datas,gridhtmlarr,frozen,columns,0)}else{gridhtmlarr.push(g._getHtmlFromData(data,frozen))}}return gridhtmlarr.join("")},_showData:function(){var g=this,p=this.options;var data=g.currentData[p.root];g._renderColumn(g.data);if(p.usePager){if(p.dataAction=="server"&&g.data&&g.data[p.record]){p.total=g.data[p.record]}else{if(g.filteredData&&g.filteredData[p.root]){p.total=g.filteredData[p.root].length}else{if(g.data&&g.data[p.root]){p.total=g.data[p.root].length}else{if(data){p.total=data.length}}}}p.page=p.newPage;if(!p.total){p.total=0}if(!p.page){p.page=1}p.pageCount=Math.ceil(p.total/p.pageSize);if(!p.pageCount){p.pageCount=1}g._buildPager()}$(".l-bar-btnloading:first",g.toolbar).removeClass("l-bar-btnloading");if(g.trigger("beforeShowData",[g.currentData])==false){return}g._clearGrid();g.isDataChanged=false;if(!data){return}$(".l-bar-btnload:first span",g.toolbar).removeClass("l-disabled");g._updateGridData();if(g.enabledFrozen()){g._fillGridBody(g.rows,true)}g._fillGridBody(g.rows,false);g.trigger("SysGridHeightChanged");if(p.totalRender){$(".l-panel-bar-total",g.element).remove();$(".l-panel-bar",g.element).before('<div class="l-panel-bar-total">'+p.totalRender(g.data,g.filteredData)+"</div>")}if(p.mouseoverRowCssClass){for(var i in g.rows){var rowobj=$(g.getRowObj(g.rows[i]));if(g.enabledFrozen()){rowobj=rowobj.add(g.getRowObj(g.rows[i],true))}rowobj.bind("mouseover.gridrow",function(){g._onRowOver(this,true)}).bind("mouseout.gridrow",function(){g._onRowOver(this,false)})}}g.gridbody.trigger("scroll.grid");g.trigger("afterShowData",[g.currentData])},_groupData:function(datas,columns){var g=this;var ret={};for(var i=0;i<datas.length;i++){var data=datas[i];var column;var p;for(var j=0;j<columns.length;j++){column=columns[j];var value=g._getCellContent(data,g._getColumnByName(column))||data[column]||"__blank";if(j==0){if(!ret[value]){ret[value]={}}p=ret}else{if(j>0&&j<columns.length-1){var preKey=g._getCellContent(data,g._getColumnByName(columns[j-1]));p=p[preKey||"__blank"];if(!p[value]){p[value]={}}}else{if(j==columns.length-1){var preKey=g._getCellContent(data,g._getColumnByName(columns[j-1]));p=p[preKey||"__blank"];if(!p[value]){p[value]=[]}p[value].push(data)}}}}}return ret},_extraGroupData:function(datas,gridhtmlarr,frozen,columns,depth,parentKey,currentKey){var g=this,p=this.options;depth++;if(parentKey&&currentKey){parentKey+="||"+currentKey}else{if(currentKey){parentKey=currentKey}else{parentKey=""}}for(var key in datas){if(typeof datas[key]=="object"&&!datas[key].length){g._createGroupHtml(parentKey,key,gridhtmlarr,columns[depth-1],depth,false);g._extraGroupData(datas[key],gridhtmlarr,frozen,columns,depth,parentKey,key)}else{var item=datas[key];g._createGroupHtml(parentKey,key,gridhtmlarr,columns[depth-1],depth,true);gridhtmlarr.push(g._getHtmlFromData(item,frozen))}}},_createGroupHtml:function(parentKey,key,gridhtmlarr,column,depth,hasData){var g=this,p=this.options;if(parentKey){parentKey+="||"+key}else{parentKey=key}if(column.showAsXml){key=g._xmlToHtml(key);parentKey=g._xmlToHtml(parentKey)}gridhtmlarr.push('<tr class="l-grid-grouprow l-grid-grouprow-last l-grid-grouprow-first l-grid-group-header"');gridhtmlarr.push(' groupKey="'+parentKey+'" >');gridhtmlarr.push('<td colSpan="'+g.columns.length+'" class="l-grid-grouprow-cell">');for(var i=1;i<depth;i++){gridhtmlarr.push("<div class='l-grid-tree-space'></div><div class='l-grid-tree-space'></div>")}var btnCss="l-grid-group-togglebtn";if(!hasData){btnCss="l-grid-groups-togglebtn"}gridhtmlarr.push('<span class="'+btnCss+'">&nbsp;&nbsp;&nbsp;&nbsp;</span>');gridhtmlarr.push(g.getColumnByName(column).display+":"+key);gridhtmlarr.push("</td>");gridhtmlarr.push("</tr>")},_getRowDomId:function(rowdata,frozen){var p=this.options;return this.id+"|"+((frozen)?"1":"2")+"|"+rowdata.__id},_getCellDomId:function(rowdata,column){return this._getRowDomId(rowdata,column.frozen)+"|"+column.__id},_getHtmlFromData:function(data,frozen){if(!data){return""}var g=this,p=this.options;var gridhtmlarr=[];for(var rowparm in data){var item=data[rowparm];var rowid=item.__id;if(!item){continue}gridhtmlarr.push("<tr");gridhtmlarr.push(' id="'+g._getRowDomId(item,frozen)+'"');gridhtmlarr.push(' class="l-grid-row');if(!frozen&&g.enabledCheckbox()&&p.isChecked&&p.isChecked(item)){g.select(item);gridhtmlarr.push(" l-selected")}else{if(g.isSelected(item)){gridhtmlarr.push(" l-selected")}}if(item.__index%2==1&&p.alternatingRow){gridhtmlarr.push(" l-grid-row-alt")}gridhtmlarr.push('" ');if(p.rowAttrRender){gridhtmlarr.push(p.rowAttrRender(item,rowid))}if(p.tree&&g.collapsedRows&&g.collapsedRows.length){var isHide=function(){var pitem=g.getParent(item);while(pitem){if($.inArray(pitem,g.collapsedRows)!=-1){return true}pitem=g.getParent(pitem)}return false};if(isHide()){gridhtmlarr.push(' style="display:none;" ')}}gridhtmlarr.push(">");$(g.columns).each(function(columnindex,column){if(frozen!=column.frozen){return}gridhtmlarr.push("<td");gridhtmlarr.push(' id="'+g._getCellDomId(item,this)+'"');if(this.isrownumber){gridhtmlarr.push(' class="l-grid-row-cell l-grid-row-cell-rownumbers" style="width:'+this.width+'px"><div class="l-grid-row-cell-inner"');if(p.fixedCellHeight){gridhtmlarr.push(' style = "height:'+p.rowHeight+'px;" ')}gridhtmlarr.push(">"+(parseInt(item.__index)+((p.newPage-1)*p.pageSize)+1)+"</div></td>");return}if(this.ischeckbox){gridhtmlarr.push(' class="l-grid-row-cell l-grid-row-cell-checkbox" style="width:'+this.width+'px"><div class="l-grid-row-cell-inner"');if(p.fixedCellHeight){gridhtmlarr.push(' style = "height:'+p.rowHeight+'px;" ')}gridhtmlarr.push('><span class="l-grid-row-cell-btn-checkbox"></span></div></td>');return}else{if(this.isdetail){gridhtmlarr.push(' class="l-grid-row-cell l-grid-row-cell-detail" style="width:'+this.width+'px"><div class="l-grid-row-cell-inner"');if(p.fixedCellHeight){gridhtmlarr.push(' style = "height:'+p.rowHeight+'px;" ')}gridhtmlarr.push('><span class="l-grid-row-cell-detailbtn"></span></div></td>');return}}var colwidth=this._width;gridhtmlarr.push(' class="l-grid-row-cell ');if(this.islast){gridhtmlarr.push("l-grid-row-cell-last ")}gridhtmlarr.push('"');gridhtmlarr.push(' style = "');gridhtmlarr.push("width:"+colwidth+"px; ");if(column._hide){gridhtmlarr.push("display:none;")}gridhtmlarr.push(' ">');gridhtmlarr.push(g._getCellHtml(item,column));gridhtmlarr.push("</td>")});gridhtmlarr.push("</tr>")}return gridhtmlarr.join("")},_getCellHtml:function(rowdata,column){var g=this,p=this.options;if(column.isrownumber){return'<div class="l-grid-row-cell-inner">'+(parseInt(rowdata.__index)+1)+"</div>"}var htmlarr=[];htmlarr.push('<div class="l-grid-row-cell-inner"');htmlarr.push(' style = "width:'+parseInt(column._width-8)+"px;");if(p.fixedCellHeight){htmlarr.push("height:"+p.rowHeight+"px;min-height:"+p.rowHeight+"px; ")}if(column.align){htmlarr.push("text-align:"+column.align+";")}var content=g._getCellContent(rowdata,column);htmlarr.push('">'+content+"</div>");return htmlarr.join("")},_getCellContent:function(rowdata,column){if(!rowdata||!column){return""}if(column.isrownumber){return parseInt(rowdata.__index)+1}var rowid=rowdata.__id;var rowindex=rowdata.__index;var value=column.name?rowdata[column.name]:null;if(column.name&&column.name.indexOf(".")){var names=column.name.split(".");for(var i=0;i<names.length;i++){if(i==0){value=rowdata[names[i]]}else{if(value){value=value[names[i]]}else{break}}}}var g=this,p=this.options;if(column.showAsXml){value=g._xmlToHtml(value)}var content="";if(column.editor&&column.editor.type=="select"&&!column.render){column.render=function(item){return item[column.editor.textField||column.editor.displayColumnName||"text"]}}if(column.render){content=column.render.call(g,rowdata,rowindex,value,column)}else{if(p.formatters[column.type]){content=p.formatters[column.type].call(g,value,column)}else{if(value!=null){content=value.toString()}}}if(p.tree&&(p.tree.columnName!=null&&p.tree.columnName==column.name||p.tree.columnId!=null&&p.tree.columnId==column.id)){content=g._getTreeCellHtml(content,rowdata)}return content||""},_getTreeCellHtml:function(oldContent,rowdata){var level=rowdata.__level;var g=this,p=this.options;var isExtend=$.inArray(rowdata,g.collapsedRows||[])==-1;var isParent=p.tree.isParent(rowdata);var content="";level=parseInt(level)||1;for(var i=1;i<level;i++){content+="<div class='l-grid-tree-space'></div>"}if(isExtend&&isParent){content+="<div class='l-grid-tree-space l-grid-tree-link l-grid-tree-link-open'></div>"}else{if(isParent){content+="<div class='l-grid-tree-space l-grid-tree-link l-grid-tree-link-close'></div>"}else{content+="<div class='l-grid-tree-space'></div>"}}content+="<span class='l-grid-tree-content'>"+oldContent+"</span>";return content},_applyEditor:function(obj){var g=this,p=this.options;var rowcell=obj;var ids=rowcell.id.split("|");var columnid=ids[ids.length-1];var column=g._columns[columnid];var row=$(rowcell).parent();var rowdata=g.getRow(row[0]);var rowid=rowdata.__id;var rowindex=rowdata.__index;if(!column||!column.editor){return}var columnname=column.name;var columnindex=column.columnindex;if(column.editor.type&&p.editors[column.editor.type]){if(column.frozen&&rowdata[p.statusName]!="add"){return}var currentdata=rowdata[columnname];var editParm={record:rowdata,value:currentdata,column:column,rowindex:rowindex};if(g.trigger("beforeEdit",[editParm])==false){return false}var editor=p.editors[column.editor.type];var jcell=$(rowcell),offset=$(rowcell).offset();jcell.html("");g.setCellNotBlank(rowdata,column,false);g.setCellEditing(rowdata,column,true);var width=$(rowcell).width(),height=$(rowcell).height();var container=$("<div class='l-grid-editor'></div>").appendTo("body");var ua=navigator.userAgent.toLowerCase();var s,ieVersion;(s=ua.match(/msie ([\d.]+)/))?ieVersion=s[1]:0;if($.browser.mozilla){container.css({left:offset.left,top:offset.top}).show()}else{if(6<ieVersion&&ieVersion<9){container.css({left:offset.left,top:offset.top}).show()}else{if(ieVersion>=9){container.css({left:offset.left,top:offset.top+1}).show()}else{container.css({left:offset.left+1,top:offset.top+1}).show()}}}if(g.editorDatas[column.name]){if(column.editor.type=="grid"){column.editor.grid=column.editor.grid||{};column.editor.grid.data=g.editorDatas[column.name]}else{column.editor.data=g.editorDatas[column.name]}}var editorInput=g._createEditor(editor,container,editParm,width,height);g.editor={editing:true,editor:editor,input:editorInput,editParm:editParm,container:container};g.unbind("sysEndEdit");g.bind("sysEndEdit",function(){var newValue=editor.getValue(editorInput,editParm);if(column.editor.type=="select"||column.editor.type=="grid"&&!g.editorDatas[column.name]){g.editorDatas[column.name]=editor.getData()}if(newValue!=currentdata){$(rowcell).addClass("l-grid-row-cell-edited");g.changedCells[rowid+"_"+column.__id]=true;if(column.editor.onChange){column.editor.onChange(rowcell,newValue)}editParm.value=newValue;if(g._checkEditAndUpdateCell(editParm)){if(column.editor.onChanged){column.editor.onChanged(rowcell,newValue)}}}});editorInput[0].focus()}},_checkEditAndUpdateCell:function(editParm){var g=this,p=this.options;if(g.trigger("beforeSubmitEdit",[editParm])==false){return false}g.updateCell(editParm.column,editParm.value,editParm.record);return true},_getCurrentPageData:function(source){var g=this,p=this.options;var data={};data[p.root]=[];if(!source||!source[p.root]||!source[p.root].length){data[p.record]=0;return data}data[p.record]=source[p.root].length;if(!p.newPage){p.newPage=1}for(i=(p.newPage-1)*p.pageSize;i<source[p.root].length&&i<p.newPage*p.pageSize;i++){data[p.root].push(source[p.root][i])}return data},_compareData:function(data1,data2,columnName,columnType){var g=this,p=this.options;var val1=data1[columnName],val2=data2[columnName];if(val1==null&&val2!=null){return 1}else{if(val1==null&&val2==null){return 0}else{if(val1!=null&&val2==null){return -1}}}if(p.sorters[columnType]){return p.sorters[columnType].call(g,val1,val2)}else{return val1<val2?-1:val1>val2?1:0}},_getTotalCellContent:function(column,data){var g=this,p=this.options;var totalsummaryArr=[];if(column.totalSummary){var isExist=function(type){for(var i=0;i<types.length;i++){if(types[i].toLowerCase()==type.toLowerCase()){return true}}return false};var sum=0,count=0,avg=0;var max=parseFloat(data[0][column.name]);var min=parseFloat(data[0][column.name]);for(var i=0;i<data.length;i++){count+=1;var value=parseFloat(data[i][column.name]);if(!value){continue}sum+=value;if(value>max){max=value}if(value<min){min=value}}avg=sum*1/data.length;if(column.totalSummary.render){var renderhtml=column.totalSummary.render({sum:sum,count:count,avg:avg,min:min,max:max},column,g.data);totalsummaryArr.push(renderhtml)}else{if(column.totalSummary.type){var types=column.totalSummary.type.split(",");if(isExist("sum")){totalsummaryArr.push("<div>Sum="+sum.toFixed(2)+"</div>")}if(isExist("count")){totalsummaryArr.push("<div>Count="+count+"</div>")}if(isExist("max")){totalsummaryArr.push("<div>Max="+max.toFixed(2)+"</div>")}if(isExist("min")){totalsummaryArr.push("<div>Min="+min.toFixed(2)+"</div>")}if(isExist("avg")){totalsummaryArr.push("<div>Avg="+avg.toFixed(2)+"</div>")}}}}return totalsummaryArr.join("")},_getTotalSummaryHtml:function(data,classCssName,frozen){var g=this,p=this.options;var totalsummaryArr=[];if(classCssName){totalsummaryArr.push('<tr class="l-grid-totalsummary '+classCssName+'">')}else{totalsummaryArr.push('<tr class="l-grid-totalsummary">')}$(g.columns).each(function(columnindex,column){if(this.frozen!=frozen){return}if(this.isrownumber){totalsummaryArr.push('<td class="l-grid-totalsummary-cell l-grid-totalsummary-cell-rownumbers" style="width:'+this.width+'px"><div>&nbsp;</div></td>');return}if(this.ischeckbox){totalsummaryArr.push('<td class="l-grid-totalsummary-cell l-grid-totalsummary-cell-checkbox" style="width:'+this.width+'px"><div>&nbsp;</div></td>');return}else{if(this.isdetail){totalsummaryArr.push('<td class="l-grid-totalsummary-cell l-grid-totalsummary-cell-detail" style="width:'+this.width+'px"><div>&nbsp;</div></td>');return}}totalsummaryArr.push('<td class="l-grid-totalsummary-cell');if(this.islast){totalsummaryArr.push(" l-grid-totalsummary-cell-last")}totalsummaryArr.push('" ');totalsummaryArr.push('id="'+g.id+"|total"+g.totalNumber+"|"+column.__id+'" ');totalsummaryArr.push('width="'+this._width+'" ');columnname=this.columnname;if(columnname){totalsummaryArr.push('columnname="'+columnname+'" ')}totalsummaryArr.push('columnindex="'+columnindex+'" ');totalsummaryArr.push('><div class="l-grid-totalsummary-cell-inner"');if(column.align){totalsummaryArr.push(' style="text-Align:'+column.align+';"')}totalsummaryArr.push(">");totalsummaryArr.push(g._getTotalCellContent(column,data));totalsummaryArr.push("</div></td>")});totalsummaryArr.push("</tr>");if(!frozen){g.totalNumber++}return totalsummaryArr.join("")},_bulidTotalSummary:function(frozen){var g=this,p=this.options;if(!g.isTotalSummary()){return false}if(!g.currentData||g.currentData[p.root].length==0){return false}var totalRow=$(g._getTotalSummaryHtml(g.currentData[p.root],null,frozen));$("tbody:first",frozen?g.f.gridbody:g.gridbody).append(totalRow)},_buildPager:function(){var g=this,p=this.options;$(".pcontrol input",g.toolbar).val(p.page);if(!p.pageCount){p.pageCount=1}$(".pcontrol span",g.toolbar).html(p.pageCount);var r1=parseInt((p.page-1)*p.pageSize)+1;var r2=parseInt(r1)+parseInt(p.pageSize)-1;if(!p.total){p.total=0}if(p.total<r2){r2=p.total}if(!p.total){r1=r2=0}if(r1<0){r1=0}if(r2<0){r2=0}var stat=p.pageStatMessage;stat=stat.replace(/{from}/,r1);stat=stat.replace(/{to}/,r2);stat=stat.replace(/{total}/,p.total);stat=stat.replace(/{pagesize}/,p.pageSize);$(".l-bar-text",g.toolbar).html(stat);if(!p.total){$(".l-bar-btnfirst span,.l-bar-btnprev span,.l-bar-btnnext span,.l-bar-btnlast span",g.toolbar).addClass("l-disabled")}if(p.page==1){$(".l-bar-btnfirst span",g.toolbar).addClass("l-disabled");$(".l-bar-btnprev span",g.toolbar).addClass("l-disabled")}else{if(p.page>p.pageCount&&p.pageCount>0){$(".l-bar-btnfirst span",g.toolbar).removeClass("l-disabled");$(".l-bar-btnprev span",g.toolbar).removeClass("l-disabled")}}if(p.page==p.pageCount){$(".l-bar-btnlast span",g.toolbar).addClass("l-disabled");$(".l-bar-btnnext span",g.toolbar).addClass("l-disabled")}else{if(p.page<p.pageCount&&p.pageCount>0){$(".l-bar-btnlast span",g.toolbar).removeClass("l-disabled");$(".l-bar-btnnext span",g.toolbar).removeClass("l-disabled")}}},_getRowIdByDomId:function(domid){var ids=domid.split("|");var rowid=ids[2];return rowid},_getRowByDomId:function(domid){return this.records[this._getRowIdByDomId(domid)]},_getSrcElementByEvent:function(e){var g=this;var obj=(e.target||e.srcElement);var jobjs=$(obj).parents().add(obj);var fn=function(parm){for(var i=0,l=jobjs.length;i<l;i++){if(typeof parm=="string"){if($(jobjs[i]).hasClass(parm)){return jobjs[i]}}else{if(typeof parm=="object"){if(jobjs[i]==parm){return jobjs[i]}}}}return null};if(fn("l-grid-editor")){return{editing:true,editor:fn("l-grid-editor")}}if(jobjs.index(this.element)==-1){return{out:true}}var indetail=false;if(jobjs.hasClass("l-grid-detailpanel")&&g.detailrows){for(var i=0,l=g.detailrows.length;i<l;i++){if(jobjs.index(g.detailrows[i])!=-1){indetail=true;break}}}var r={grid:fn("l-panel"),indetail:indetail,frozen:fn(g.gridview1[0])?true:false,header:fn("l-panel-header"),gridheader:fn("l-grid-header"),gridbody:fn("l-grid-body"),total:fn("l-panel-bar-total"),popup:fn("l-grid-popup"),toolbar:fn("l-panel-bar")};if(r.gridheader){r.hrow=fn("l-grid-hd-row");r.hcell=fn("l-grid-hd-cell");r.hcelltext=fn("l-grid-hd-cell-text");r.checkboxall=fn("l-grid-hd-cell-checkbox");if(r.hcell){var columnid=r.hcell.id.split("|")[2];r.column=g._columns[columnid]}}if(r.gridbody){r.row=fn("l-grid-row");r.cell=fn("l-grid-row-cell");r.checkbox=fn("l-grid-row-cell-btn-checkbox");r.groupbtn=fn("l-grid-group-togglebtn");r.groupsbtn=fn("l-grid-groups-togglebtn");r.grouprow=fn("l-grid-grouprow");r.detailbtn=fn("l-grid-row-cell-detailbtn");r.detailrow=fn("l-grid-detailpanel");r.totalrow=fn("l-grid-totalsummary");r.totalcell=fn("l-grid-totalsummary-cell");r.rownumberscell=$(r.cell).hasClass("l-grid-row-cell-rownumbers")?r.cell:null;r.detailcell=$(r.cell).hasClass("l-grid-row-cell-detail")?r.cell:null;r.checkboxcell=$(r.cell).hasClass("l-grid-row-cell-checkbox")?r.cell:null;r.treelink=fn("l-grid-tree-link");r.editor=fn("l-grid-editor");if(r.row){r.data=this._getRowByDomId(r.row.id)}if(r.cell){r.editing=$(r.cell).hasClass("l-grid-row-cell-editing")}if(r.editor){r.editing=true}if(r.editing){r.out=false}}if(r.toolbar){r.first=fn("l-bar-btnfirst");r.last=fn("l-bar-btnlast");r.next=fn("l-bar-btnnext");r.prev=fn("l-bar-btnprev");r.load=fn("l-bar-btnload");r.add=fn("l-icon-add");r.button=fn("l-bar-button")}return r},_setEvent:function(){var g=this,p=this.options;g.grid.bind("mousedown.grid",function(e){g._onMouseDown.call(g,e)});g.grid.bind("dblclick.grid",function(e){g._onDblClick.call(g,e)});g.grid.bind("contextmenu.grid",function(e){return g._onContextmenu.call(g,e)});$(document).bind("mouseup.grid",function(e){g._onMouseUp.call(g,e)});$(document).bind("click.grid",function(e){g._onClick.call(g,e)});$(window).bind("resize.grid",function(e){g._onResize.call(g)});$(document).bind("keydown.grid",function(e){if(e.ctrlKey){g.ctrlKey=true}});$(document).bind("keyup.grid",function(e){delete g.ctrlKey});g.gridbody.bind("scroll.grid",function(){var scrollLeft=g.gridbody.scrollLeft();var scrollTop=g.gridbody.scrollTop();if(scrollLeft!=null){g.gridheader[0].scrollLeft=scrollLeft}if(scrollTop!=null){g.f.gridbody[0].scrollTop=scrollTop}g.endEdit();g.trigger("SysGridHeightChanged")});$("select",g.toolbar).change(function(){if(g.isDataChanged&&!confirm(p.isContinueByDataChanged)){return false}p.newPage=1;p.pageSize=this.value;g.loadData(p.where)});$("span.pcontrol :text",g.toolbar).blur(function(e){g.changePage("input")});$("div.l-bar-button",g.toolbar).hover(function(){$(this).addClass("l-bar-button-over")},function(){$(this).removeClass("l-bar-button-over")});if($.fn.juiceDrag&&p.colDraggable){g.colDroptip=$("<div class='l-drag-coldroptip' style='display:none'><div class='l-drop-move-up'></div><div class='l-drop-move-down'></div></div>").appendTo("body");g.gridheader.add(g.f.gridheader).juiceDrag({revert:true,animate:false,proxyX:0,proxyY:0,proxy:function(draggable,e){var src=g._getSrcElementByEvent(e);if(src.hcell&&src.column){var content=$(".l-grid-hd-cell-text:first",src.hcell).html();var proxy=$("<div class='l-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div></div>").appendTo("body");proxy.append(content);return proxy}},onRevert:function(){return false},onRendered:function(){this.set("cursor","default");g.children[this.id]=this},onStartDrag:function(current,e){if(e.button==2){return false}if(g.colresizing){return false}this.set("cursor","default");var src=g._getSrcElementByEvent(e);var pageX=e.pageX;var pageY=e.pageY;var trig=$(".l-grid-hd-trigger",src.hcell);var triggerOffset=trig.offset();if(triggerOffset){if(pageX>triggerOffset.left&&pageX<(triggerOffset.left+trig.width())&&pageY<(triggerOffset.top+trig.height())&&pageY>triggerOffset.top){return false}}if(!src.hcell||!src.column||src.column.issystem||src.hcelltext){return false}if($(src.hcell).css("cursor").indexOf("resize")!=-1){return false}this.draggingColumn=src.column;g.coldragging=true;var gridOffset=g.grid.offset();var top=gridOffset.top+(p.title?g.header.height():0);this.validRange={top:top,bottom:top+g.gridheader.height(),left:gridOffset.left-10,right:gridOffset.left+g.grid.width()+10}},onDrag:function(current,e){this.set("cursor","default");var column=this.draggingColumn;if(!column){return false}if(g.colresizing){return false}if(g.colDropIn==null){g.colDropIn=-1}var pageX=e.pageX;var pageY=e.pageY;var visit=false;var gridOffset=g.grid.offset();var validRange=this.validRange;if(pageX<validRange.left||pageX>validRange.right||pageY>validRange.bottom||pageY<validRange.top){g.colDropIn=-1;g.colDroptip.hide();this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes").addClass("l-drop-no");return}for(var colid in g._columns){var col=g._columns[colid];if(column==col){visit=true;continue}if(col.issystem){continue}var sameLevel=col.__level==column.__level;var isAfter=!sameLevel?false:visit?true:false;if(column.frozen!=col.frozen){isAfter=col.frozen?false:true}if(g.colDropIn!=-1&&g.colDropIn!=colid){continue}var cell=document.getElementById(col.__domid);var offset=$(cell).offset();var range={top:offset.top,bottom:offset.top+$(cell).height(),left:offset.left-60,right:offset.left+60};if(isAfter){var cellwidth=$(cell).width();range.left+=cellwidth;range.right+=cellwidth}if(pageX>range.left&&pageX<range.right&&pageY>range.top&&pageY<range.bottom){var height=p.headerRowHeight;if(col.__rowSpan){height*=col.__rowSpan}g.colDroptip.css({left:range.left+54,top:range.top-9,height:height+9*2}).show();g.colDropIn=colid;g.colDropDir=isAfter?"right":"left";this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no").addClass("l-drop-yes");break}else{if(g.colDropIn!=-1){g.colDropIn=-1;g.colDroptip.hide();this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes").addClass("l-drop-no")}}}},onStopDrag:function(current,e){var column=this.draggingColumn;g.coldragging=false;if(g.colDropIn!=-1){g.changeCol.juiceDefer(g,0,[column,g.colDropIn,g.colDropDir=="right"]);g.colDropIn=-1}g.colDroptip.hide();this.set("cursor","default")}})}if($.fn.juiceDrag&&p.rowDraggable){g.rowDroptip=$("<div class='l-drag-rowdroptip' style='display:none'></div>").appendTo("body");g.gridbody.add(g.f.gridbody).juiceDrag({revert:true,animate:false,proxyX:0,proxyY:0,proxy:function(draggable,e){var src=g._getSrcElementByEvent(e);if(src.row){var content=p.draggingMessage.replace(/{count}/,draggable.draggingRows?draggable.draggingRows.length:1);if(p.rowDraggingRender){content=p.rowDraggingRender(draggable.draggingRows,draggable,g)}var proxy=$("<div class='l-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div>"+content+"</div>").appendTo("body");return proxy}},onRevert:function(){return false},onRendered:function(){this.set("cursor","default");g.children[this.id]=this},onStartDrag:function(current,e){if(e.button==2){return false}if(g.colresizing){return false}if(!g.columns.length){return false}this.set("cursor","default");var src=g._getSrcElementByEvent(e);if(!src.cell||!src.data||src.checkbox){return false}var ids=src.cell.id.split("|");var column=g._columns[ids[ids.length-1]];if(src.rownumberscell||src.detailcell||src.checkboxcell||column==g.columns[0]){if(g.enabledCheckbox()){this.draggingRows=g.getSelecteds();if(!this.draggingRows||!this.draggingRows.length){return false}}else{this.draggingRows=[src.data]}this.draggingRow=src.data;this.set("cursor","move");g.rowdragging=true;this.validRange={top:g.gridbody.offset().top,bottom:g.gridbody.offset().top+g.gridbody.height(),left:g.grid.offset().left-10,right:g.grid.offset().left+g.grid.width()+10}}else{return false}},onDrag:function(current,e){var rowdata=this.draggingRow;if(!rowdata){return false}var rows=this.draggingRows?this.draggingRows:[rowdata];if(g.colresizing){return false}if(g.rowDropIn==null){g.rowDropIn=-1}var pageX=e.pageX;var pageY=e.pageY;var visit=false;var validRange=this.validRange;if(pageX<validRange.left||pageX>validRange.right||pageY>validRange.bottom||pageY<validRange.top){g.rowDropIn=-1;g.rowDroptip.hide();this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes l-drop-add").addClass("l-drop-no");return}for(var i in g.rows){var rd=g.rows[i];var rowid=rd.__id;if(rowdata==rd){visit=true}if($.inArray(rd,rows)!=-1){continue}var isAfter=visit?true:false;if(g.rowDropIn!=-1&&g.rowDropIn!=rowid){continue}var rowobj=g.getRowObj(rowid);var offset=$(rowobj).offset();var range={top:offset.top-4,bottom:offset.top+$(rowobj).height()+4,left:g.grid.offset().left,right:g.grid.offset().left+g.grid.width()};if(pageX>range.left&&pageX<range.right&&pageY>range.top&&pageY<range.bottom){var lineTop=offset.top;if(isAfter){lineTop+=$(rowobj).height()}g.rowDroptip.css({left:range.left,top:lineTop,width:range.right-range.left}).show();g.rowDropIn=rowid;g.rowDropDir=isAfter?"bottom":"top";if(p.tree&&pageY>range.top+5&&pageY<range.bottom-5){this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-yes").addClass("l-drop-add");g.rowDroptip.hide();g.rowDropInParent=true}else{this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-add").addClass("l-drop-yes");g.rowDroptip.show();g.rowDropInParent=false}break}else{if(g.rowDropIn!=-1){g.rowDropIn=-1;g.rowDropInParent=false;g.rowDroptip.hide();this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes  l-drop-add").addClass("l-drop-no")}}}},onStopDrag:function(current,e){var rows=this.draggingRows;g.rowdragging=false;for(var i=0;i<rows.length;i++){var children=rows[i].children;if(children){rows=$.grep(rows,function(node,i){var isIn=$.inArray(node,children)==-1;return isIn})}}if(g.rowDropIn!=-1){if(p.tree){var neardata,prow;if(g.rowDropInParent){prow=g.getRow(g.rowDropIn)}else{neardata=g.getRow(g.rowDropIn);prow=g.getParent(neardata)}g.appendRange(rows,prow,neardata,g.rowDropDir!="bottom");g.trigger("rowDragDrop",{rows:rows,parent:prow,near:neardata,after:g.rowDropDir=="bottom"})}else{g.moveRange(rows,g.rowDropIn,g.rowDropDir=="bottom");g.trigger("rowDragDrop",{rows:rows,parent:prow,near:g.getRow(g.rowDropIn),after:g.rowDropDir=="bottom"})}g.rowDropIn=-1}g.rowDroptip.hide();this.set("cursor","default")}})}},_onRowOver:function(rowParm,over){if(l.draggable.dragging){return}var g=this,p=this.options;var rowdata=g.getRow(rowParm);var methodName=over?"addClass":"removeClass";if(g.enabledFrozen()){$(g.getRowObj(rowdata,true))[methodName](p.mouseoverRowCssClass)}$(g.getRowObj(rowdata,false))[methodName](p.mouseoverRowCssClass)},_onMouseUp:function(e){var g=this,p=this.options;if(l.draggable.dragging){var src=g._getSrcElementByEvent(e);if(src.hcell&&src.column){g.trigger("dragdrop",[{type:"header",column:src.column,cell:src.hcell},e])}else{if(src.row){g.trigger("dragdrop",[{type:"row",record:src.data,row:src.row},e])}}}},_onMouseDown:function(e){var g=this,p=this.options},_onContextmenu:function(e){var g=this,p=this.options;var src=g._getSrcElementByEvent(e);if(src.row){if(p.onRClickToSelect){g.select(src.data)}if(g.hasBind("contextmenu")){return g.trigger("contextmenu",[{data:src.data,rowindex:src.data.__index,row:src.row},e])}}},_onDblClick:function(e){var g=this,p=this.options;var src=g._getSrcElementByEvent(e);if(src.row){g.trigger("dblClickRow",[src.data,src.data.__id,src.row])}},_onClick:function(e){var obj=(e.target||e.srcElement);var g=this,p=this.options;var src=g._getSrcElementByEvent(e);if(src.out){if(g.editor.editing&&!$.jui.win.masking&&!g.isComplexEditor(g.editor)){g.endEdit()}else{if(g.endComPlexEditor(g.editor)){g.endEdit()}}return}if(src.indetail||src.editing){return}if(g.editor.editing){g.endEdit()}if(p.allowHideColumn){if(!src.popup){g.popup.hide()}}if(src.checkboxall){var row=$(src.hrow);var uncheck=row.hasClass("l-checked");if(g.trigger("beforeCheckAllRow",[!uncheck,g.element])==false){return false}if(uncheck){row.removeClass("l-checked")}else{row.addClass("l-checked")}g.selected=[];for(var rowid in g.records){if(uncheck){g.unselect(g.records[rowid])}else{g.selectWithoutTrigger(g.records[rowid])}}g.trigger("checkAllRow",[!uncheck,g.element])}else{if(src.hcelltext){var hcell=$(src.hcelltext).parent().parent();if(!p.enabledSort||!src.column){return}if(src.column.isSort==false){return}if(p.url&&g.isDataChanged&&!confirm(p.isContinueByDataChanged)){return}var sort=$(".l-grid-hd-cell-sort:first",hcell);var columnName=src.column.name;if(!columnName){return}if(sort.length>0){if(sort.hasClass("l-grid-hd-cell-sort-asc")){sort.removeClass("l-grid-hd-cell-sort-asc").addClass("l-grid-hd-cell-sort-desc");hcell.removeClass("l-grid-hd-cell-asc").addClass("l-grid-hd-cell-desc");g.changeSort(columnName,"desc")}else{if(sort.hasClass("l-grid-hd-cell-sort-desc")){sort.removeClass("l-grid-hd-cell-sort-desc").addClass("l-grid-hd-cell-sort-asc");hcell.removeClass("l-grid-hd-cell-desc").addClass("l-grid-hd-cell-asc");g.changeSort(columnName,"asc")}}}else{hcell.removeClass("l-grid-hd-cell-desc").addClass("l-grid-hd-cell-asc");$(src.hcelltext).after("<span class='l-grid-hd-cell-sort l-grid-hd-cell-sort-asc'>&nbsp;&nbsp;</span>");g.changeSort(columnName,"asc")}$(".l-grid-hd-cell-sort",g.gridheader).add($(".l-grid-hd-cell-sort",g.f.gridheader)).not($(".l-grid-hd-cell-sort:first",hcell)).remove()}else{if(src.detailbtn&&p.detail){var item=src.data;var row=$([g.getRowObj(item,false)]);if(g.enabledFrozen()){row=row.add(g.getRowObj(item,true))}var rowid=item.__id;if($(src.detailbtn).hasClass("l-open")){if(p.detail.onCollapse){p.detail.onCollapse(item,$(".l-grid-detailpanel-inner:first",nextrow)[0])}row.next("tr.l-grid-detailpanel").hide();$(src.detailbtn).removeClass("l-open")}else{var nextrow=row.next("tr.l-grid-detailpanel");if(nextrow.length>0){nextrow.show();if(p.detail.onExtend){p.detail.onExtend(item,$(".l-grid-detailpanel-inner:first",nextrow)[0])}$(src.detailbtn).addClass("l-open");g.trigger("SysGridHeightChanged");return}$(src.detailbtn).addClass("l-open");var frozenColNum=0;for(var i=0;i<g.columns.length;i++){if(g.columns[i].frozen){frozenColNum++}}var detailRow=$("<tr class='l-grid-detailpanel'><td><div class='l-grid-detailpanel-inner' style='display:none'></div></td></tr>");var detailFrozenRow=$("<tr class='l-grid-detailpanel'><td><div class='l-grid-detailpanel-inner' style='display:none'></div></td></tr>");detailRow.attr("id",g.id+"|detail|"+rowid);g.detailrows=g.detailrows||[];g.detailrows.push(detailRow[0]);g.detailrows.push(detailFrozenRow[0]);var detailRowInner=$("div:first",detailRow);detailRowInner.parent().attr("colSpan",g.columns.length-frozenColNum);row.eq(0).after(detailRow);if(frozenColNum>0){detailFrozenRow.find("td:first").attr("colSpan",frozenColNum);row.eq(1).after(detailFrozenRow)}if(p.detail.onShowDetail){p.detail.onShowDetail(item,detailRowInner[0],function(){g.trigger("SysGridHeightChanged")});$("div:first",detailFrozenRow).add(detailRowInner).show().height(p.detail.height||p.detailHeight)}else{if(p.detail.render){detailRowInner.append(p.detail.render());detailRowInner.show()}}g.trigger("SysGridHeightChanged")}}else{if(src.groupbtn){var grouprow=$(src.grouprow);var opening=true;if($(src.groupbtn).hasClass("l-grid-group-togglebtn-close")){$(src.groupbtn).removeClass("l-grid-group-togglebtn-close");if(grouprow.hasClass("l-grid-grouprow-last")){$("td:first",grouprow).width("auto")}}else{opening=false;$(src.groupbtn).addClass("l-grid-group-togglebtn-close");if(grouprow.hasClass("l-grid-grouprow-last")){$("td:first",grouprow).width(g.gridtablewidth)}}var currentRow=grouprow.next(".l-grid-row,.l-grid-totalsummary-group,.l-grid-detailpanel");while(true){if(currentRow.length==0){break}if(opening){currentRow.show();if(currentRow.hasClass("l-grid-detailpanel")&&!currentRow.prev().find("td.l-grid-row-cell-detail:first span.l-grid-row-cell-detailbtn:first").hasClass("l-open")){currentRow.hide()}}else{currentRow.hide()}currentRow=currentRow.next(".l-grid-row,.l-grid-totalsummary-group,.l-grid-detailpanel")}g.trigger("SysGridHeightChanged")}else{if(src.groupsbtn){var grouprow=$(src.grouprow);var opening=true;if($(src.groupsbtn).hasClass("l-grid-groups-togglebtn-close")){$(src.groupsbtn).removeClass("l-grid-groups-togglebtn-close");if(grouprow.hasClass("l-grid-grouprow-last")){$("td:first",grouprow).width("auto")}}else{opening=false;$(src.groupsbtn).addClass("l-grid-groups-togglebtn-close");if(grouprow.hasClass("l-grid-grouprow-last")){$("td:first",grouprow).width(g.gridtablewidth)}}var parentKey=grouprow.attr("groupKey");var currentRow=grouprow.next();while(currentRow.length>0){if(currentRow.attr("groupKey")&&currentRow.attr("groupKey").indexOf(parentKey)!=0&&(!currentRow.hasClass("l-grid-row"))){break}if(opening){currentRow.show();if(currentRow.hasClass("l-grid-detailpanel")&&!currentRow.prev().find("td.l-grid-row-cell-detail:first span.l-grid-row-cell-detailbtn:first").hasClass("l-open")){currentRow.hide()}if(currentRow.attr("groupKey")&&currentRow.attr("groupKey").indexOf(parentKey)==0){$(".l-grid-groups-togglebtn",currentRow).removeClass("l-grid-groups-togglebtn-close");$(".l-grid-group-togglebtn",currentRow).removeClass("l-grid-group-togglebtn-close")}}else{currentRow.hide();if(currentRow.attr("groupKey")&&currentRow.attr("groupKey").indexOf(parentKey)==0){currentRow.find(".l-grid-groups-togglebtn").addClass("l-grid-groups-togglebtn-close");currentRow.find(".l-grid-group-togglebtn").addClass("l-grid-group-togglebtn-close")}}currentRow=currentRow.next()}g.trigger("SysGridHeightChanged")}else{if(src.treelink){g.toggle(src.data)}else{if(src.row&&g.enabledCheckbox()){var selectRowButtonOnly=p.selectRowButtonOnly?true:false;if(p.enabledEdit){selectRowButtonOnly=true}if(src.checkbox||!selectRowButtonOnly){var row=$(src.row);var uncheck=row.hasClass("l-selected");if(g.trigger("beforeCheckRow",[!uncheck,src.data,src.data.__id,src.row])==false){return false}var met=uncheck?"unselect":"select";g[met](src.data);if(p.tree&&p.autoCheckChildren){var children=g.getChildren(src.data,true);for(var i=0,l=children.length;i<l;i++){g[met](children[i])}}g.trigger("checkRow",[!uncheck,src.data,src.data.__id,src.row])}if(!src.checkbox&&src.cell&&p.enabledEdit&&p.clickToEdit){g._applyEditor(src.cell)}}else{if(src.row&&!g.enabledCheckbox()){if(src.cell&&p.enabledEdit&&p.clickToEdit){g._applyEditor(src.cell)}if($(src.row).hasClass("l-selected")){if(!p.allowUnSelectRow){$(src.row).addClass("l-selected-again");return}g.unselect(src.data)}else{g.select(src.data)}}else{if(src.toolbar){if(src.first){if(g.trigger("toFirst",[g.element])==false){return false}g.changePage("first")}else{if(src.prev){if(g.trigger("toPrev",[g.element])==false){return false}g.changePage("prev")}else{if(src.next){if(g.trigger("toNext",[g.element])==false){return false}g.changePage("next")}else{if(src.last){if(g.trigger("toLast",[g.element])==false){return false}g.changePage("last")}else{if(src.load){if($("span",src.load).hasClass("l-disabled")){return false}if(g.trigger("reload",[g.element])==false){return false}if(p.url&&g.isDataChanged&&!confirm(p.isContinueByDataChanged)){return false}g.loadData(p.where)}else{if(src.add){var rows=g.getSelectedRows();var columns=",";$(g.columns).each(function(){if(!this.editor){columns+=this.name+","}});var newRows=[];if(rows.length>0){$(rows).each(function(index,row){$(g.formatRecord(row));var newRow={};for(var key in row){if(columns.indexOf(","+key+",")<0){newRow[key]=row[key]}}newRows.push(newRow)})}else{newRows.push({})}g.addDataRows(newRows)}}}}}}}}}}}}}}}},isComplexEditor:function(editor){return editor&&(editor.editParm.column.editor.type=="grid"||editor.editParm.column.editor.type=="date")},endComPlexEditor:function(editor){if(editor&&editor.editor&&editor.editor.box){if(editor.editor.box.selectBox){return !editor.editor.box.selectBox.is(":visible")}else{if(g.editor.editor.box.dateeditor){return !g.editor.editor.box.dateeditor.is(":visible")}}}return false},select:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);var rowid=rowdata.__id;var rowobj=g.getRowObj(rowid);g.selectWithoutTrigger(rowParm);g.trigger("selectRow",[rowdata,rowid,rowobj])},selectWithoutTrigger:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);var rowid=rowdata.__id;var rowobj=g.getRowObj(rowid);var rowobj1=g.getRowObj(rowid,true);if(!g.enabledCheckbox()&&!g.ctrlKey){for(var i in g.selected){var o=g.selected[i];if(o.__id in g.records){$(g.getRowObj(o)).removeClass("l-selected l-selected-again");if(g.enabledFrozen()){$(g.getRowObj(o,true)).removeClass("l-selected l-selected-again")}}}g.selected=[]}if(rowobj){$(rowobj).addClass("l-selected")}if(rowobj1){$(rowobj1).addClass("l-selected")}g.selected[g.selected.length]=rowdata},unselect:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);var rowid=rowdata.__id;var rowobj=g.getRowObj(rowid);var rowobj1=g.getRowObj(rowid,true);$(rowobj).removeClass("l-selected l-selected-again");if(g.enabledFrozen()){$(rowobj1).removeClass("l-selected l-selected-again")}g._removeSelected(rowdata);g.trigger("unSelectRow",[rowdata,rowid,rowobj])},_xmlToHtml:function(str){if(str&&typeof str=="string"){str=str.replace(/</g,"&lt;");str=str.replace(/>/g,"&gt;")}return str},isSelected:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);for(var i in g.selected){if(g.selected[i]==rowdata){return true}}return false},_onResize:function(){var g=this,p=this.options;if(p.height&&p.height!="auto"){var windowHeight=$(window).height();var h=0;var parentHeight=null;if(typeof(p.height)=="string"&&p.height.indexOf("%")>0){var gridparent=g.grid.parent();if(p.InWindow){parentHeight=windowHeight;parentHeight-=parseInt($("body").css("paddingTop"));parentHeight-=parseInt($("body").css("paddingBottom"))}else{parentHeight=gridparent.height()}h=parentHeight*parseFloat(p.height)*0.01;if(p.InWindow||gridparent[0].tagName.toLowerCase()=="body"){h-=(g.grid.offset().top-parseInt($("body").css("paddingTop")))}}else{h=parseInt(p.height)}h+=p.heightDiff;g.windowHeight=windowHeight;g._setHeight(h)}if(g.enabledFrozen()){var gridView1Width=g.gridview1.width();var gridViewWidth=g.gridview.width();g.gridview2.css({width:gridViewWidth-gridView1Width})}$(g.columns).each(function(i,column){if(column._percentWidth&&(!column.isrownumber&&!column.ischeckbox)){}});g.trigger("SysGridHeightChanged")}});$.jui.controls.Grid.columns={display:"",name:"",width:"",frozen:"",align:"",showAsXml:"",render:function(){},type:"",id:"",hide:false,allowBlank:true,editor:{},dateFormat:"",decimalFormat:"",format:function(){}};$.jui.controls.Grid.editor={data:[],valueColumnName:"",displayColumnName:"",onBeforeOpen:null,valueField:"",textField:"",textWidth:"",selectBoxHeight:"",selectBoxWidth:"",onBeforeEditor:null,onAfterEditor:null,forceLoad:false,onchange:null,url:"",refType:"",refId:"",type:"",width:"",height:""};$.jui.controls.Grid.createParams=function(p,element){$.jui.copyProperty(p,p,element);var colmunKey=$.jui.controls.Grid.columns;var editorKey=$.jui.controls.Grid.editor;var columnWrap=$(">div[elementType=columns]",element);var columns=$(">div",columnWrap);if(columns.length>0){p.columns=[];columns.each(function(index){var column={};var columnElement=$(columns[index]);$.jui.copyProperty(column,colmunKey,columnElement);p.columns.push(column);var editorElement=$(">input",columnElement);if(editorElement[0]){var editor={};$.jui.copyProperty(editor,editorKey,editorElement);editor.type=editorElement.attr("class").replace("jui-","");column.editor=editor}if(columnElement.children().length>0){column.columns=[];$.jui.controls.Grid.createParams(column,columnElement)}})}};$.jui.controls.Grid.prototype.enabledTotal=$.jui.controls.Grid.prototype.isTotalSummary;$.jui.controls.Grid.prototype.add=$.jui.controls.Grid.prototype.addRow;$.jui.controls.Grid.prototype.update=$.jui.controls.Grid.prototype.updateRow;$.jui.controls.Grid.prototype.append=$.jui.controls.Grid.prototype.appendRow;$.jui.controls.Grid.prototype.getSelected=$.jui.controls.Grid.prototype.getSelectedRow;$.jui.controls.Grid.prototype.getSelecteds=$.jui.controls.Grid.prototype.getSelectedRows;$.jui.controls.Grid.prototype.getCheckedRows=$.jui.controls.Grid.prototype.getSelectedRows;$.jui.controls.Grid.prototype.getCheckedRowObjs=$.jui.controls.Grid.prototype.getSelectedRowObjs;$.jui.controls.Grid.prototype.setOptions=$.jui.controls.Grid.prototype.set})(jQuery);(function(a){a.fn.juiceForm=function(){return a.jui.run.call(this,"juiceForm",arguments)};a.juiceDefaults=a.juiceDefaults||{};a.juiceDefaults.Form={inputWidth:180,labelWidth:90,space:40,rightToken:"：",url:"",labelAlign:"left",align:"left",fields:[],appendID:true,prefixID:"",beforeLoad:null,afterLoad:null,dataTransfer:null,toJSON:a.jui.toJSON};a.juiceDefaults.Form.editorBulider=function(j,k){var e=this,h=this.options;var f={};f=a.extend({},k);if(h.inputWidth){f.width=h.inputWidth}var b;if(j.is("select")){j.juiceComboBox()}else{if(j.is(":text")||j.is(":password")){var d=j.attr("class");var c="";if(d&&d.indexOf("jui")>=0){c=d.replace("jui-","")}switch(c){case"select":case"combobox":b=j.juiceComboBox(f);break;case"spinner":b=j.juiceSpinner(f);break;case"date":b=j.juiceDateEditor(f);break;case"float":case"number":f.number=true;b=j.juiceTextBox(f);break;case"money":b=j.juiceNumberBox(f);break;case"int":case"digits":f.digits=true;default:b=j.juiceTextBox(f);break}}else{if(j.is(":radio")){b=j.juiceRadio(f)}else{if(j.is(":checkbox")){b=j.juiceCheckBox(f)}else{if(j.is("textarea")){b=j.addClass("l-textarea")}}}}}return b};a.jui.controls.Form=function(c,b){a.jui.controls.Form.base.constructor.call(this,c,b)};a.juiceMethos.Form=a.juiceMethos.Form||{};a.jui.controls.Form.juiceExtend(a.jui.core.UIComponent,{__getType:function(){return"Form"},__idPrev:function(){return"Form"},_extendMethods:function(){return a.juiceMethos.Form},_init:function(){var b=this,c=this.options;a.jui.controls.Form.base._init.call(this);b._copyProperty(c,a(this.element));this.editors={}},_render:function(){var b=this,c=this.options;b.form=a(this.element);var d="<div class='l-panel-header '><div class='up-toggle'/><span class='l-panel-header-text'></span></div>";b.header=a(d);b.headerTool=a(".up-toggle",b.header);b.load();b.build();b.addValidate(true)},build:function(){var b=this;b._initHeader();b._setEvent()},_initHeader:function(){var b=this,c=this.options;if(c.title){b.header.insertBefore(b.form);a(".l-panel-header-text",b.header).html(c.title)}},onLoad:function(f,d){var c=this,e=this.options;a("input[type!='checkbox'][type!='radio'][type!='button'][type!='submit'],select,textarea",c.form).each(function(){if(c.editors[a(this).attr("name")]){c.editors[a(this).attr("name")].setValue(d[a(this).attr("valueFieldID")]||d[a(this).attr("name")])}else{if(c.dataTransform){d=c.dataTransform(d)}var h=d[a(this).attr("name")]||d[a(this).attr("valueFieldID")];a(this).val(h);c.editors[a(this).attr("name")]=e.editorBulider.call(c,a(this),{initValue:h})}});var b={};a("input:checkbox",c.form).each(function(){var h=a(this).attr("name");if((","+d[h]+",").indexOf(","+a(this).val()+",")>=0){a(this).attr("checked","checked")}else{a(this).removeAttr("checked")}});a("input:radio",c.form).each(function(){var h=a(this).attr("name");var j=d[h];if((a(this).val()==j)){a(this).attr("checked","checked")}else{a(this).removeAttr("checked")}})},load:function(c,e){var b=this,d=this.options;if(c){b.onLoad(e,c)}else{if(d.url){a.jui.loadData(b,e)}else{b.onLoad(e,{})}}},_setEvent:function(){var b=this;b.headerTool.hover(function(){if(b.headerTool.hasClass("down-toggle")){b.headerTool.addClass("down-toggle-over");b.headerTool.removeClass("down-toggle")}else{b.headerTool.addClass("up-toggle-over")}},function(){if(b.headerTool.hasClass("down-toggle-over")){b.headerTool.addClass("down-toggle");b.headerTool.removeClass("down-toggle-over")}else{b.headerTool.removeClass("up-toggle-over")}}).click(function(){if(b.headerTool.hasClass("down-toggle-over")){b.headerTool.addClass("up-toggle-over");b.headerTool.removeClass("down-toggle-over");b.form.show()}else{b.headerTool.addClass("down-toggle-over");b.headerTool.removeClass("up-toggle-over");b.form.hide()}})},addValidate:function(b){var c=this;if(b){c.validator=c.form.validate({errorPlacement:function(d,e){if(e.hasClass("l-textarea")){e.addClass("l-textarea-invalid")}else{if(e.hasClass("l-text-field")){e.parent().addClass("l-text-invalid")}}a(e).removeAttr("title").juiceHideTip();a(e).attr("title",d.html()).juiceTip()},success:function(d){var e=a("#"+d.attr("for"));if(e.hasClass("l-textarea")){e.removeClass("l-textarea-invalid")}else{if(e.hasClass("l-text-field")){e.parent().removeClass("l-text-invalid")}}a(e).removeAttr("title").juiceHideTip()}})}},submit:function(e,d){var c=this;e=e||{};var b=c.form.serializeArray();var f=null;if(e.callback){f=e.callback;delete e.callback}if(c.initParams){c.initParams(e,b)}c.datas=b;if(c.validator.form()){if(!d){this.form.submit()}else{a.ajax({type:"post",url:c.form.attr("action")||e.url,dataType:"json",data:e,success:function(h){if(f){f.call(c,h)}c.trigger("afterSubmit",h)},fail:function(h){c.trigger("error",h)}})}}}})})(jQuery);